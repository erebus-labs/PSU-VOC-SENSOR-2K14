C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE RTC_INT
OBJECT MODULE PLACED IN .\DP8051\DP8051_Keil_951\Debug\RTC_INT.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\3.0\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -.\Generated_Source\PSoC3\RTC_INT.c NOIV LARGE MODDP2 OMF2 VB(1) PR(.\DP8051\DP8051_Keil_951\Debug\RTC_INT.lst) CD DB NOI
                    -P OT(0,SIZE) DF(DEBUG) INCDIR(.,.\Generated_Source\PSoC3) OJ(.\DP8051\DP8051_Keil_951\Debug\RTC_INT.obj)

line level    source

   1          /*******************************************************************************
   2          * File Name: RTC_INT.c
   3          * Version 2.0
   4          *
   5          * Description:
   6          *  This file contains the Interrupt Service Routine (ISR) for the RTC component.
   7          *  This interrupt routine has entry pointes to overflow on time or date.
   8          *
   9          ********************************************************************************
  10          * Copyright 2008-2013, Cypress Semiconductor Corporation.  All rights reserved.
  11          * You may use this file only in accordance with the license, terms, conditions,
  12          * disclaimers, and limitations in the end user license agreement accompanying
  13          * the software package with which this file was provided.
  14          *******************************************************************************/
  15          
  16          #include "RTC.h"
  17          #include "CyLib.h"
  18          
  19          /* Function Prototypes */
  20          static void RTC_EverySecondHandler(void);
  21          static void RTC_EveryMinuteHandler(void);
  22          static void RTC_EveryHourHandler(void);
  23          static void RTC_EveryDayHandler(void);
  24          static void RTC_EveryWeekHandler(void);
  25          static void RTC_EveryMonthHandler(void);
  26          static void RTC_EveryYearHandler(void);
  27          
  28          
  29          /*******************************************************************************
  30          *  Place your includes, defines and code here
  31          *******************************************************************************/
  32          /* `#START RTC_ISR_DEFINITION` */
  33          #include "globals.h"
  34          #include "sample_handler.h"
  35          #include "utility.h"
  36          /* `#END` */
  37          
  38          
  39          /*******************************************************************************
  40          * Function Name:   RTC_EverySecondHandler
  41          ********************************************************************************
  42          *
  43          * Summary:
  44          *  This function is called every second.
  45          *
  46          * Parameters:
  47          *  None.
  48          *
  49          * Return:
  50          *  None.
  51          *
  52          *******************************************************************************/
  53          static void RTC_EverySecondHandler(void)
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 2   

  54          {
  55   1          /*  Place your every second handler code here. */
  56   1          /* `#START EVERY_SECOND_HANDLER_CODE` */
  57   1          
  58   1          ++battery_check_count;
  59   1          if (battery_check_count == BATT_CHECK_INTERVAL){
  60   2              battery_check_count = 0;
  61   2              battery_check_waiting = 1;
  62   2          }
  63   1          
  64   1          if (mem_full_flag){
  65   2              return;
  66   2          }
  67   1          
  68   1          if (sample_unit == SAMPLE_SEC && sample_enable_flag){
  69   2              ++sample_interrupt_count;
  70   2      
  71   2              if (sample_interrupt_count == sample_interval)
  72   2              {
  73   3                  take_sample_waiting = 1;
  74   3                  sample_interrupt_count = 0;
  75   3              }
  76   2          }
  77   1              
  78   1          ++low_batt_blink_count;
  79   1          if ((low_batt_blink_count >= LOWBATT_BLINK_INTERVAL) && low_power_flag){
  80   2              low_batt_blink_count = 0;
  81   2              low_battery_blink_waiting = 1;
  82   2          }
  83   1      
  84   1          
  85   1          /* `#END` */
  86   1      }
  87          
  88          
  89          /*******************************************************************************
  90          * Function Name:   RTC_EveryMinuteHandler
  91          ********************************************************************************
  92          *
  93          * Summary:
  94          *  This function is called every minute.
  95          *
  96          * Parameters:
  97          *  None.
  98          *
  99          * Return:
 100          *  None.
 101          *
 102          *******************************************************************************/
 103          static void RTC_EveryMinuteHandler(void)
 104          {
 105   1          /*  Place your every minute handler code here. */
 106   1          /* `#START EVERY_MINUTE_HANDLER_CODE` */
 107   1          
 108   1          if (mem_full_flag){
 109   2              return;
 110   2          }
 111   1              
 112   1          if (sample_unit == SAMPLE_MIN && sample_enable_flag){
 113   2              ++sample_interrupt_count;
 114   2      
 115   2              if (sample_interrupt_count == sample_interval)
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 3   

 116   2              {
 117   3                  take_sample_waiting = 1;
 118   3                  sample_interrupt_count = 0;
 119   3              }
 120   2          }
 121   1          
 122   1          ++battery_check_count;
 123   1          if (battery_check_count == BATT_CHECK_INTERVAL){
 124   2              battery_check_count = 0;
 125   2              battery_check_waiting = 1;
 126   2          }
 127   1          
 128   1          /* `#END` */
 129   1      }
 130          
 131          
 132          /*******************************************************************************
 133          * Function Name:   RTC_EveryHourHandler
 134          ********************************************************************************
 135          *
 136          * Summary:
 137          *  This function is called every hour.
 138          *
 139          * Parameters:
 140          *  None.
 141          *
 142          * Return:
 143          *  None.
 144          *
 145          *******************************************************************************/
 146          static void RTC_EveryHourHandler(void)
 147          {
 148   1          /*  Place your every hour handler code here. */
 149   1          /* `#START EVERY_HOUR_HANDLER_CODE` */
 150   1          
 151   1          if (mem_full_flag){
 152   2              return;
 153   2          }
 154   1              
 155   1          if (sample_enable_flag){
 156   2              ++sample_interrupt_count;
 157   2      
 158   2              if (sample_interrupt_count == sample_interval)
 159   2              {
 160   3                  take_sample_waiting = 1;
 161   3                  sample_interrupt_count = 0;
 162   3              }
 163   2          }
 164   1          /* `#END` */
 165   1      }
 166          
 167          
 168          /*******************************************************************************
 169          * Function Name:   RTC_EveryDayHandler
 170          ********************************************************************************
 171          *
 172          * Summary:
 173          *  This function is called every day.
 174          *
 175          * Parameters:
 176          *  None.
 177          *
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 4   

 178          * Return:
 179          *  None.
 180          *
 181          *******************************************************************************/
 182          static void RTC_EveryDayHandler(void)
 183          {
 184   1          /*  Place your everyday handler code here. */
 185   1          /* `#START EVERY_DAY_HANDLER_CODE` */
 186   1          
 187   1          if (mem_full_flag){
 188   2              return;
 189   2          }
 190   1          
 191   1          if (sample_enable_flag){
 192   2              ++sample_interrupt_count;
 193   2      
 194   2              if (sample_interrupt_count == sample_interval)
 195   2              {
 196   3                  take_sample_waiting = 1;
 197   3                  sample_interrupt_count = 0;
 198   3              }
 199   2          }
 200   1          /* `#END` */
 201   1      }
 202          
 203          
 204          /*******************************************************************************
 205          * Function Name:   RTC_EveryWeekHandler
 206          ********************************************************************************
 207          *
 208          * Summary:
 209          *  This function is called every week.
 210          *
 211          * Parameters:
 212          *  None.
 213          *
 214          * Return:
 215          *  None.
 216          *
 217          *******************************************************************************/
 218          static void RTC_EveryWeekHandler(void)
 219          {
 220   1          /*  Place your every week handler code here. */
 221   1          /* `#START EVERY_WEEK_HANDLER_CODE` */
 222   1          /* `#END` */
 223   1      }
 224          
 225          
 226          /*******************************************************************************
 227          * Function Name:   RTC_EveryMonthHandler
 228          ********************************************************************************
 229          *
 230          * Summary:
 231          *  This function is called every month.
 232          *
 233          * Parameters:
 234          *  None.
 235          *
 236          * Return:
 237          *  None.
 238          *
 239          *******************************************************************************/
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 5   

 240          static void RTC_EveryMonthHandler(void)
 241          {
 242   1          /*  Place your every month handler code here. */
 243   1          /* `#START EVERY_MONTH_HANDLER_CODE` */
 244   1          /* `#END` */
 245   1      }
 246          
 247          
 248          /*******************************************************************************
 249          * Function Name:   RTC_EveryYearHandler
 250          ********************************************************************************
 251          *
 252          * Summary:
 253          *  This function is called every year.
 254          *
 255          * Parameters:
 256          *  None.
 257          *
 258          * Return:
 259          *  None.
 260          *
 261          *******************************************************************************/
 262          static void RTC_EveryYearHandler(void)
 263          {
 264   1          /*  Place your every year handler code here. */
 265   1          /* `#START EVERY_YEAR_HANDLER_CODE` */
 266   1          /* `#END` */
 267   1      }
 268          
 269          
 270          /*******************************************************************************
 271          * Function Name: RTC_ISR
 272          ********************************************************************************
 273          *
 274          * Summary:
 275          *  This ISR is executed on 1PPS (one pulse per second) event.
 276          *  Global interrupt must be enabled to invoke this ISR.
 277          *  This interrupt trigs every second.
 278          *
 279          * Parameters:
 280          *  None.
 281          *
 282          * Return:
 283          *  None.
 284          *
 285          * Global variables:
 286          * RTC_currentTimeDate, RTC_dstTimeDateStart,
 287          *  RTC_dstTimeDateStop, RTC_dstTimeDateStart,
 288          *  RTC_alarmCfgTimeDate, RTC_statusDateTime,
 289          *  RTC_dstStartStatus, RTC_dstStartStatus,
 290          *  RTC_dstStopStatus, RTC_alarmCurStatus: global
 291          *  variables are used for the time/date, DST and alarm update procedure.
 292          *
 293          *  RTC_dstTimeDateStart and RTC_currentTimeDate:
 294          *  are modified with the updated values.
 295          *
 296          *  RTC_statusDateTime, RTC_dstStartStatus,
 297          *  RTC_dstStartStatus, RTC_dstStopStatus,
 298          *  RTC_alarmCurStatus: global variables could be modified while
 299          *  current time/date is updated.
 300          *
 301          * Side Effects:
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 6   

 302          *  Clears all interrupt status bits (react_int, limact_int, onepps_int, ctw_int,
 303          *  and  ftw_int) in Power Manager Interrupt Status Register. If an interrupt
 304          *  gets generated at the same time as a clear, the bit will remain set (which
 305          *  causes another interrupt).
 306          *
 307          *******************************************************************************/
 308          CY_ISR(RTC_ISR)
 309          {
 310   1          uint8 RTC_tmp;
 311   1      
 312   1          /* Clear OPPS interrupt status flag */
 313   1          (void) CyPmReadStatus(CY_PM_ONEPPS_INT);
 314   1      
 315   1          /* Increment seconds counter */
 316   1          RTC_currentTimeDate.Sec++;
 317   1      
 318   1          /* Check if minute elapsed */
 319   1          if(RTC_currentTimeDate.Sec > RTC_MINUTE_ELAPSED)
 320   1          {
 321   2              /* Inc Min */
 322   2              RTC_currentTimeDate.Min++;
 323   2      
 324   2              /* Clear Sec */
 325   2              RTC_currentTimeDate.Sec = 0u;
 326   2      
 327   2              if(RTC_currentTimeDate.Min > RTC_HOUR_ELAPSED)
 328   2              {
 329   3                  /* Inc HOUR */
 330   3                  RTC_currentTimeDate.Hour++;
 331   3      
 332   3                  /* Clear Min */
 333   3                  RTC_currentTimeDate.Min = 0u;
 334   3      
 335   3                  /* Day roll over */
 336   3                  if(RTC_currentTimeDate.Hour > RTC_DAY_ELAPSED)
 337   3                  {
 338   4                      /* Inc DayOfMonth */
 339   4                      RTC_currentTimeDate.DayOfMonth++;
 340   4      
 341   4                      /* Clear Hour */
 342   4                      RTC_currentTimeDate.Hour = 0u;
 343   4      
 344   4                      /* Inc DayOfYear */
 345   4                      RTC_currentTimeDate.DayOfYear++;
 346   4      
 347   4                      /* Inc DayOfWeek */
 348   4                      RTC_currentTimeDate.DayOfWeek++;
 349   4      
 350   4                      /* Check DayOfWeek */
 351   4                      if(RTC_currentTimeDate.DayOfWeek > RTC_WEEK_ELAPSED)
 352   4                      {
 353   5                          /* start new week */
 354   5                          RTC_currentTimeDate.DayOfWeek = 1u;
 355   5                      }
 356   4      
 357   4                      /* Day of month roll over.
 358   4                      * Check if day of month greater than 29 in February of leap year or
 359   4                      * if day of month greater than 28 NOT in February of NON leap year or
 360   4                      * if day of month greater than it should be in every month in non leap year
 361   4                      */
 362   4                      if(((0u != (RTC_statusDateTime & RTC_STATUS_LY)) &&
 363   4                          (RTC_currentTimeDate.Month == RTC_FEBRUARY)  &&
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 7   

 364   4                          (RTC_currentTimeDate.DayOfMonth >
 365   4                                   (RTC_daysInMonths[RTC_currentTimeDate.Month - 1u] + 1u))) ||
 366   4                         ((0u != (RTC_statusDateTime & RTC_STATUS_LY))  &&
 367   4                          (RTC_currentTimeDate.Month != RTC_FEBRUARY) &&
 368   4                          (RTC_currentTimeDate.DayOfMonth >
 369   4                                          RTC_daysInMonths[RTC_currentTimeDate.Month - 1u])) ||
 370   4                         ((0u == (RTC_statusDateTime & RTC_STATUS_LY))  &&
 371   4                          (RTC_currentTimeDate.DayOfMonth >
 372   4                                          RTC_daysInMonths[RTC_currentTimeDate.Month - 1u])))
 373   4                      {
 374   5                          /* Inc Month */
 375   5                          RTC_currentTimeDate.Month++;
 376   5      
 377   5                          /* Set first day of month */
 378   5                          RTC_currentTimeDate.DayOfMonth = 1u;
 379   5      
 380   5                          /* Year roll over */
 381   5                          if(RTC_currentTimeDate.Month > RTC_YEAR_ELAPSED)
 382   5                          {
 383   6                              /* Inc Year */
 384   6                              RTC_currentTimeDate.Year++;
 385   6      
 386   6                              /* Set first month of year */
 387   6                              RTC_currentTimeDate.Month = 1u;
 388   6      
 389   6                              /* Set first day of year */
 390   6                              RTC_currentTimeDate.DayOfYear = 1u;
 391   6      
 392   6                              /* Is this year leap */
 393   6                              if(1u == RTC_LEAP_YEAR(RTC_currentTimeDate.Year))
 394   6                              {
 395   7                                  /* Set leap year flag */
 396   7                                  RTC_statusDateTime |= RTC_STATUS_LY;
 397   7                              }
 398   6                              else    /* not leap year */
 399   6                              {
 400   7                                  /* Clear leap year */
 401   7                                  RTC_statusDateTime &= (uint8)(~RTC_STATUS_LY);
 402   7                              }
 403   6      
 404   6                              /* Alarm YEAR */
 405   6                              if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
 406   6                                                                   RTC_ALARM_YEAR_MASK))
 407   6                              {
 408   7                                  /* Years match */
 409   7                                  if(RTC_alarmCfgTimeDate.Year == RTC_currentTimeDate.Year)
 410   7                                  {
 411   8                                      /* Rise year alarm */
 412   8                                      RTC_alarmCurStatus |= RTC_ALARM_YEAR_MASK;
 413   8                                  }
 414   7                                  else    /* Years do not match */
 415   7                                  {
 416   8                                      /* Clear year alarm */
 417   8                                      RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_YEAR_MASK);
 418   8                                  }
 419   7                              } /* do not alarm year */
 420   6      
 421   6                              /* Set Alarm flag event */
 422   6                              RTC_tmp = RTC_alarmCfgMask;
 423   6                              RTC_SET_ALARM(RTC_tmp,
 425   6                                                         RTC_alarmCurStatus,
 425   6                                                         RTC_statusDateTime);
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 8   

 426   6      
 427   6                              /* Every Year */
 428   6                              if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask,
 429   6                                                                   RTC_INTERVAL_YEAR_MASK))
 430   6                              {
 431   7                                  RTC_EveryYearHandler();
 432   7                              }
 433   6      
 434   6                          } /* Month > 12 */
 435   5      
 436   5                          /* Alarm MONTH */
 437   5                          if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
 438   5                                                               RTC_ALARM_MONTH_MASK))
 439   5                          {
 440   6                              if(RTC_alarmCfgTimeDate.Month == RTC_currentTimeDate.Month)
 441   6                              {
 442   7                                  /* Set month alarm */
 443   7                                  RTC_alarmCurStatus |= RTC_ALARM_MONTH_MASK;
 444   7                              }
 445   6                              else
 446   6                              {
 447   7                                  /* Clear month alarm */
 448   7                                  RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_MONTH_MASK);
 449   7                              }
 450   6                          }   /* Month alarm is masked */
 451   5      
 452   5                          #if (1u == RTC_DST_FUNC_ENABLE)
                                      if(RTC_dstTimeDateStop.Month == RTC_currentTimeDate.Month)
                                      {
                                          RTC_dstStopStatus |= RTC_DST_MONTH;
                                      }
                                      else
                                      {
                                          RTC_dstStopStatus &= (uint8)(~RTC_DST_MONTH);
                                      }
              
                                      if(RTC_dstTimeDateStart.Month == RTC_currentTimeDate.Month)
                                      {
                                          RTC_dstStartStatus |= RTC_DST_MONTH;
                                      }
                                      else
                                      {
                                          RTC_dstStartStatus &= (uint8)(~RTC_DST_MONTH);
                                      }
                                  #endif /* 1u == RTC_DST_FUNC_ENABLE */
 471   5      
 472   5                          /* Set Alarm flag event */
 473   5                          RTC_tmp = RTC_alarmCfgMask;
 474   5                          RTC_SET_ALARM(RTC_tmp,
 476   5                                                     RTC_alarmCurStatus,
 476   5                                                     RTC_statusDateTime);
 477   5      
 478   5                          /* Every Month */
 479   5                          if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask,
 480   5                                                               RTC_INTERVAL_MONTH_MASK))
 481   5                          {
 482   6                              RTC_EveryMonthHandler();
 483   6                          }
 484   5                      }   /* Day roll over */
 485   4      
 486   4                      /* Alarm DAYOFWEEK */
 487   4                      if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 9   

 488   4                                                           RTC_ALARM_DAYOFWEEK_MASK))
 489   4                      {
 490   5                          if(RTC_alarmCfgTimeDate.DayOfWeek == RTC_currentTimeDate.DayOfWeek)
 491   5                          {
 492   6                              /* Set day of week alarm */
 493   6                              RTC_alarmCurStatus |= RTC_ALARM_DAYOFWEEK_MASK;
 494   6                          }
 495   5                          else
 496   5                          {
 497   6                              /* Clear day of week alarm */
 498   6                              RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_DAYOFWEEK_MASK);
 499   6                          }
 500   5                      }   /* Day of week alarm is masked */
 501   4      
 502   4                      /* Alarm DAYOFYEAR */
 503   4                      if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
 504   4                                                           RTC_ALARM_DAYOFYEAR_MASK))
 505   4                      {
 506   5                          if(RTC_alarmCfgTimeDate.DayOfYear == RTC_currentTimeDate.DayOfYear)
 507   5                          {
 508   6                              /* Set day of year alarm */
 509   6                              RTC_alarmCurStatus |= RTC_ALARM_DAYOFYEAR_MASK;
 510   6                          }
 511   5                          else
 512   5                          {
 513   6                              /* Clear day of year alarm */
 514   6                              RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_DAYOFYEAR_MASK);
 515   6                          }
 516   5                      }   /* Day of year alarm is masked */
 517   4      
 518   4                      /* Alarm DAYOFMONTH */
 519   4                      if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
 520   4                               RTC_ALARM_DAYOFMONTH_MASK))
 521   4                      {
 522   5                          if(RTC_alarmCfgTimeDate.DayOfMonth == RTC_currentTimeDate.DayOfMonth)
 523   5                          {
 524   6                              /* Set day of month alarm */
 525   6                              RTC_alarmCurStatus |= RTC_ALARM_DAYOFMONTH_MASK;
 526   6                          }
 527   5                          else
 528   5                          {
 529   6                              /* Clear day of month alarm */
 530   6                              RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_DAYOFMONTH_MASK);
 531   6                          }
 532   5                      }   /* Day of month alarm is masked */
 533   4      
 534   4                      #if (1u == RTC_DST_FUNC_ENABLE)
                                  if(RTC_dstTimeDateStop.DayOfMonth == RTC_currentTimeDate.DayOfMonth)
                                  {
                                      RTC_dstStopStatus |= RTC_DST_DAYOFMONTH;
                                  }
                                  else
                                  {
                                      RTC_dstStopStatus &= (uint8)(~RTC_DST_DAYOFMONTH);
                                  }
              
                                  if(RTC_dstTimeDateStart.DayOfMonth == RTC_currentTimeDate.DayOfMonth)
                                  {
                                      RTC_dstStartStatus |= RTC_DST_DAYOFMONTH;
                                  }
                                  else
                                  {
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 10  

                                      RTC_dstStartStatus &= (uint8)(~RTC_DST_DAYOFMONTH);
                                  }
                              #endif /* 1u == RTC_DST_FUNC_ENABLE */
 553   4      
 554   4                      /* Set Alarm flag event */
 555   4                      RTC_tmp = RTC_alarmCfgMask;
 556   4                      RTC_SET_ALARM(RTC_tmp,
 558   4                                                 RTC_alarmCurStatus,
 558   4                                                 RTC_statusDateTime);
 559   4      
 560   4                      /* Every Day */
 561   4                      if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask,
 562   4                               RTC_INTERVAL_DAY_MASK))
 563   4                      {
 564   5                          RTC_EveryDayHandler();
 565   5                      }
 566   4      
 567   4                      if(1u == RTC_currentTimeDate.DayOfWeek)
 568   4                      {
 569   5                          /* Every Week */
 570   5                          if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask,
 571   5                                                               RTC_INTERVAL_WEEK_MASK))
 572   5                          {
 573   6                             RTC_EveryWeekHandler();
 574   6                          }
 575   5                      }
 576   4      
 577   4                  } /* End of day roll over */
 578   3      
 579   3                  /* Status set PM/AM flag */
 580   3                  if(RTC_currentTimeDate.Hour < RTC_HALF_OF_DAY_ELAPSED)
 581   3                  {
 582   4                      /* AM Hour 00:00-11:59, flag zero */
 583   4                      RTC_statusDateTime &= (uint8)(~RTC_STATUS_AM_PM);
 584   4                  }
 585   3                  else
 586   3                  {
 587   4                      /* PM Hour 12:00-23:59, flag set */
 588   4                      RTC_statusDateTime |= RTC_STATUS_AM_PM;
 589   4                  }
 590   3      
 591   3                  #if (1u == RTC_DST_FUNC_ENABLE)
                              if(RTC_dstTimeDateStop.Hour == RTC_currentTimeDate.Hour)
                              {
                                  RTC_dstStopStatus |= RTC_DST_HOUR;
                              }
                              else
                              {
                                  RTC_dstStopStatus &= (uint8)(~RTC_DST_HOUR);
                              }
              
                              if(RTC_dstTimeDateStart.Hour == RTC_currentTimeDate.Hour)
                              {
                                  RTC_dstStartStatus |= RTC_DST_HOUR;
                              }
                              else
                              {
                              RTC_dstStartStatus &= (uint8)(~RTC_DST_HOUR);
                              }
              
                              /* DST Enable ? */
                              if(0u != RTC_IS_BIT_SET(RTC_dstModeType, RTC_DST_ENABLE))
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 11  

                              {
                                  if(0u != RTC_IS_BIT_SET(RTC_statusDateTime, RTC_STATUS_DST))
                                  {
                                      if(0u != RTC_IS_BIT_SET(RTC_dstStopStatus, RTC_DST_HOUR |
                                                                     RTC_DST_DAYOFMONTH | RTC_DST_MONTH))
                                      {
                                          /* Substruct from current value of minutes, number of minutes
                                          * in DST offset which is out of complete hour
                                          */
                                          RTC_currentTimeDate.Min -=
                                                              RTC_dstOffsetMin % (RTC_HOUR_ELAPSED + 1u);
              
                                          /* Is minute value negative? */
                                          if(RTC_currentTimeDate.Min > RTC_HOUR_ELAPSED)
                                          {
                                              /* Convert to the positive.
                                              * HOUR_ELAPSED -     (~currentTimeDate.Min    ) ==
                                              * HOUR_ELAPSED + 1 - (~currentTimeDate.Min + 1)
                                              */
                                              RTC_currentTimeDate.Min = RTC_HOUR_ELAPSED -
                                                                           ((uint8)(~RTC_currentTimeDate.Min));
              
                                              RTC_currentTimeDate.Hour--;
                                          }
              
                                          RTC_currentTimeDate.Hour -= RTC_dstOffsetMin /
                                                                                   (RTC_HOUR_ELAPSED + 1u);
              
                                          /* Day roll over
                                          * Is hour value negative? */
                                          if(RTC_currentTimeDate.Hour > RTC_DAY_ELAPSED)
                                          {
                                              /* Convert to the positive.
                                              * DAY_ELAPSED - (~currentTimeDate.Hour) ==
                                              * DAY_ELAPSED + 1 - (~currentTimeDate.Hour + 1)
                                              */
                                              RTC_currentTimeDate.Hour = RTC_DAY_ELAPSED -
                                                                            ((uint8)(~RTC_currentTimeDate.Hour));
              
                                              /* Status set PM/AM flag */
                                              if(RTC_currentTimeDate.Hour < RTC_HALF_OF_DAY_ELAPSED)
                                              {
                                                  /* AM Hour 00:00-11:59, flag zero */
                                                  RTC_statusDateTime &= (uint8)(~RTC_STATUS_AM_PM);
                                              }
                                              else
                                              {
                                                  /* PM Hour 12:00-23:59, flag set */
                                                  RTC_statusDateTime |= RTC_STATUS_AM_PM;
                                              }
              
                                              RTC_currentTimeDate.DayOfMonth--;
                                              RTC_currentTimeDate.DayOfYear--;
                                              RTC_currentTimeDate.DayOfWeek--;
              
                                              if(0u == RTC_currentTimeDate.DayOfWeek)
                                              {
                                                  RTC_currentTimeDate.DayOfWeek = RTC_DAYS_IN_WEEK;
                                              }
              
                                              if(0u == RTC_currentTimeDate.DayOfMonth)
                                              {
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 12  

                                                  RTC_currentTimeDate.Month--;
                                                  if(0u == RTC_currentTimeDate.Month)
                                                  {
                                                      RTC_currentTimeDate.Month = RTC_DECEMBER;
              
                                                      RTC_currentTimeDate.DayOfMonth =
                                                          RTC_daysInMonths[RTC_currentTimeDate.Month - 1u];
              
                                                      RTC_currentTimeDate.Year--;
              
                                                      if(1u == RTC_LEAP_YEAR(RTC_currentTimeDate.Year))
                                                      {
                                                          /* LP - true, else - false */
                                                          RTC_statusDateTime |= RTC_STATUS_LY;
                                                          RTC_currentTimeDate.DayOfYear =
                                                                                                  RTC_DAYS_IN_LEAP_YEAR;
                                                      }
                                                      else
                                                      {
                                                          RTC_statusDateTime &= (uint8)(~RTC_STATUS_LY);
                                                          RTC_currentTimeDate.DayOfYear = RTC_DAYS_IN_YEAR;
                                                      }
                                                      RTC_EveryYearHandler();
                                                  }
                                                  else
                                                  {
                                                      /* Day of month roll over.
                                                      * Check if day of month February 29 of leap year
                                                      */
                                                      if((0u != (RTC_statusDateTime & RTC_STATUS_LY)) &&
                                                          (RTC_currentTimeDate.Month == RTC_FEBRUARY))
                                                      {
                                                          RTC_currentTimeDate.DayOfMonth =
                                                          RTC_daysInMonths[RTC_currentTimeDate.Month - 1u]
                                                          + 1u;
                                                      }
                                                      else
                                                      {
                                                          RTC_currentTimeDate.DayOfMonth =
                                                          RTC_daysInMonths[RTC_currentTimeDate.Month - 1u];
                                                      }
                                                  }
                                                  RTC_EveryMonthHandler();
                                              }
                                              RTC_EveryDayHandler();
                                          }
                                          RTC_statusDateTime &= (uint8)(~RTC_STATUS_DST);
                                          RTC_dstStopStatus = 0u;
                                      }
                                  }
                                  else
                                  {
                                      if(0u != RTC_IS_BIT_SET(RTC_dstStartStatus,
                                                                    (RTC_DST_HOUR | RTC_DST_DAYOFMONTH |
                                                                     RTC_DST_MONTH)))
                                      {
                                          /* Add Hour and Min */
                                          RTC_currentTimeDate.Min +=
                                                              RTC_dstOffsetMin % (RTC_HOUR_ELAPSED + 1u);
              
                                          if(RTC_currentTimeDate.Min > RTC_HOUR_ELAPSED)
                                          {
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 13  

                                              /* Adjust Min */
                                              RTC_currentTimeDate.Min -= (RTC_HOUR_ELAPSED + 1u);
                                              RTC_currentTimeDate.Hour++;
                                          }
              
                                          RTC_currentTimeDate.Hour += RTC_dstOffsetMin /
                                                                                   (RTC_HOUR_ELAPSED + 1u);
              
                                          if(RTC_currentTimeDate.Hour > RTC_DAY_ELAPSED)
                                          {
                                              /* Adjust hour, add day */
                                              RTC_currentTimeDate.Hour -= (RTC_DAY_ELAPSED + 1u);
              
                                              /* Status set PM/AM flag */
                                              if(RTC_currentTimeDate.Hour < RTC_HALF_OF_DAY_ELAPSED)
                                              {
                                                  /* AM Hour 00:00-11:59, flag zero */
                                                  RTC_statusDateTime &= (uint8)(~RTC_STATUS_AM_PM);
                                              }
                                              else
                                              {
                                                  /* PM Hour 12:00-23:59, flag set */
                                                  RTC_statusDateTime |= RTC_STATUS_AM_PM;
                                              }
              
                                              RTC_currentTimeDate.DayOfMonth++;
                                              RTC_currentTimeDate.DayOfYear++;
                                              RTC_currentTimeDate.DayOfWeek++;
              
                                              if(RTC_currentTimeDate.DayOfWeek > RTC_WEEK_ELAPSED)
                                              {
                                                  RTC_currentTimeDate.DayOfWeek = 1u;
                                              }
              
                                              /* Day of month roll over.
                                              * Check if day of month greater than 29 in February of leap year or
                                              * if day of month greater than 28 NOT in February of NON leap year or
                                              * if day of month greater than it should be in every month in non leap yea
             -r
                                              */
                                              if(((0u != (RTC_statusDateTime & RTC_STATUS_LY)) &&
                                                  (RTC_currentTimeDate.Month == RTC_FEBRUARY)  &&
                                                  (RTC_currentTimeDate.DayOfMonth >
                                                (RTC_daysInMonths[RTC_currentTimeDate.Month - 1u] + 1u))) ||
                                                 ((0u != (RTC_statusDateTime & RTC_STATUS_LY)) &&
                                                  (RTC_currentTimeDate.Month != RTC_FEBRUARY)  &&
                                                  (RTC_currentTimeDate.DayOfMonth >
                                                   RTC_daysInMonths[RTC_currentTimeDate.Month - 1u])) ||
                                                 ((0u == (RTC_statusDateTime & RTC_STATUS_LY)) &&
                                                  (RTC_currentTimeDate.DayOfMonth >
                                                   RTC_daysInMonths[RTC_currentTimeDate.Month - 1u])))
                                              {
                                                  RTC_currentTimeDate.Month++;
                                                  RTC_currentTimeDate.DayOfMonth = 1u;
                                                  if(RTC_currentTimeDate.Month > RTC_YEAR_ELAPSED)
                                                  {
                                                      RTC_currentTimeDate.Month = RTC_JANUARY;
                                                      RTC_currentTimeDate.Year++;
              
                                                      if(1u == RTC_LEAP_YEAR(RTC_currentTimeDate.Year))
                                                      {
                                                          /* LP - true, else - false */
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 14  

                                                          RTC_statusDateTime |= RTC_STATUS_LY;
                                                      }
                                                      else
                                                      {
                                                          RTC_statusDateTime &= (uint8)(~RTC_STATUS_LY);
                                                      }
                                                      RTC_currentTimeDate.DayOfYear = 1u;
              
                                                      RTC_EveryYearHandler();
                                                  }
                                                  RTC_EveryMonthHandler();
                                              }
                                              RTC_EveryDayHandler();
                                          }
                                          RTC_statusDateTime |= RTC_STATUS_DST;
                                          RTC_dstStartStatus = 0u;
              
                                          /* Month */
                                          if(RTC_dstTimeDateStop.Month == RTC_currentTimeDate.Month)
                                          {
                                              RTC_dstStopStatus |= RTC_DST_MONTH;
                                          }
                                          else
                                          {
                                              RTC_dstStopStatus &= (uint8)(~RTC_DST_MONTH);
                                          }
              
                                          /* DayOfMonth */
                                          if(RTC_dstTimeDateStop.DayOfMonth ==
                                                                                          RTC_currentTimeDate.DayOfMonth
             -)
                                          {
                                              RTC_dstStopStatus |= RTC_DST_DAYOFMONTH;
                                          }
                                          else
                                          {
                                              RTC_dstStopStatus &= (uint8)(~RTC_DST_DAYOFMONTH);
                                          }
                                      }
                                  }
              
                                  /* Alarm DAYOFWEEK */
                                  if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
                                                                       RTC_ALARM_DAYOFWEEK_MASK))
                                  {
                                      if(RTC_alarmCfgTimeDate.DayOfWeek == RTC_currentTimeDate.DayOfWeek)
                                      {
                                          RTC_alarmCurStatus |= RTC_ALARM_DAYOFWEEK_MASK;
                                      }
                                      else
                                      {
                                          RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_DAYOFWEEK_MASK);
                                      }
                                  }
              
                                  /* Alarm DAYOFYEAR */
                                  if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
                                                                       RTC_ALARM_DAYOFYEAR_MASK))
                                  {
                                      if(RTC_alarmCfgTimeDate.DayOfYear == RTC_currentTimeDate.DayOfYear)
                                      {
                                          RTC_alarmCurStatus |= RTC_ALARM_DAYOFYEAR_MASK;
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 15  

                                      }
                                      else
                                      {
                                          RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_DAYOFYEAR_MASK);
                                      }
                                  }
              
                                  /* Alarm DAYOFMONTH */
                                  if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
                                                                       RTC_ALARM_DAYOFMONTH_MASK))
                                  {
                                      if(RTC_alarmCfgTimeDate.DayOfMonth == RTC_currentTimeDate.DayOfMonth)
                                      {
                                          RTC_alarmCurStatus |= RTC_ALARM_DAYOFMONTH_MASK;
                                      }
                                      else
                                      {
                                          RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_DAYOFMONTH_MASK);
                                      }
                                  }
              
                                  /* Alarm MONTH */
                                  if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
                                                                       RTC_ALARM_MONTH_MASK))
                                  {
                                      if(RTC_alarmCfgTimeDate.Month == RTC_currentTimeDate.Month)
                                      {
                                          RTC_alarmCurStatus |= RTC_ALARM_MONTH_MASK;
                                      }
                                      else
                                      {
                                          RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_MONTH_MASK);
                                      }
                                  }
              
                                  /* Alarm YEAR */
                                  if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
                                                                       RTC_ALARM_YEAR_MASK))
                                  {
                                      if(RTC_alarmCfgTimeDate.Year == RTC_currentTimeDate.Year)
                                      {
                                          RTC_alarmCurStatus |= RTC_ALARM_YEAR_MASK;
                                      }
                                      else
                                      {
                                          RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_YEAR_MASK);
                                      }
                                  }
              
                                  /* Set Alarm flag event */
                                  RTC_tmp = RTC_alarmCfgMask;
                                  RTC_SET_ALARM(RTC_tmp,
                                                             RTC_alarmCurStatus,
                                                             RTC_statusDateTime);
                              }
                          #endif /* 1u == RTC_DST_FUNC_ENABLE */
 914   3      
 915   3                  /* Alarm HOUR */
 916   3                  if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask, RTC_ALARM_HOUR_MASK))
 917   3                  {
 918   4                      if(RTC_alarmCfgTimeDate.Hour == RTC_currentTimeDate.Hour)
 919   4                      {
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 16  

 920   5                          RTC_alarmCurStatus |= RTC_ALARM_HOUR_MASK;
 921   5                      }
 922   4                      else
 923   4                      {
 924   5                          RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_HOUR_MASK);
 925   5                      }
 926   4                  }
 927   3      
 928   3                  /* Set Alarm flag event */
 929   3                  RTC_tmp = RTC_alarmCfgMask;
 930   3                  RTC_SET_ALARM(RTC_tmp,
 932   3                                             RTC_alarmCurStatus,
 932   3                                             RTC_statusDateTime);
 933   3      
 934   3                  /* Every Hour */
 935   3                  if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask, RTC_INTERVAL_HOUR_MASK))
 936   3                  {
 937   4                      RTC_EveryHourHandler();
 938   4                  }
 939   3              } /* Min > 59 = Hour */
 940   2      
 941   2              /* Alarm MIN */
 942   2              if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask, RTC_ALARM_MIN_MASK))
 943   2              {
 944   3                  if(RTC_alarmCfgTimeDate.Min == RTC_currentTimeDate.Min)
 945   3                  {
 946   4                      RTC_alarmCurStatus |= RTC_ALARM_MIN_MASK;
 947   4                  }
 948   3                  else
 949   3                  {
 950   4                      RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_MIN_MASK);
 951   4                  }
 952   3              }
 953   2      
 954   2              /* Set Alarm flag event */
 955   2              RTC_tmp = RTC_alarmCfgMask;
 956   2              RTC_SET_ALARM(RTC_tmp,
 958   2                                         RTC_alarmCurStatus,
 958   2                                         RTC_statusDateTime);
 959   2      
 960   2              /* Every Min */
 961   2              if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask, RTC_INTERVAL_MIN_MASK))
 962   2              {
 963   3                  RTC_EveryMinuteHandler();
 964   3              }
 965   2          } /* Sec */
 966   1      
 967   1          /* Alarm SEC */
 968   1          if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask, RTC_ALARM_SEC_MASK))
 969   1          {
 970   2              if(RTC_alarmCfgTimeDate.Sec == RTC_currentTimeDate.Sec)
 971   2              {
 972   3                  RTC_alarmCurStatus |= RTC_ALARM_SEC_MASK;
 973   3              }
 974   2              else
 975   2              {
 976   3                  RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_SEC_MASK);
 977   3              }
 978   2          }
 979   1      
 980   1          /* Set Alarm flag event */
 981   1          RTC_tmp = RTC_alarmCfgMask;
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 17  

 982   1          RTC_SET_ALARM(RTC_tmp, RTC_alarmCurStatus, RTC_statusDateTime);
 983   1      
 984   1          /* Execute every second handler if needed */
 985   1          if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask, RTC_INTERVAL_SEC_MASK))
 986   1          {
 987   2              RTC_EverySecondHandler();
 988   2          }
 989   1      
 990   1      }
 991          
 992          
 993          /* [] END OF FILE */
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 18  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION RTC_EverySecondHandler (BEGIN)
                                           ; SOURCE LINE # 53
                                           ; SOURCE LINE # 54
                                           ; SOURCE LINE # 58
0000 900000      E     MOV     DPTR,#battery_check_count
0003 E0                MOVX    A,@DPTR
0004 04                INC     A
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 59
0006 900000      E     MOV     DPTR,#battery_check_count
0009 E0                MOVX    A,@DPTR
000A FF                MOV     R7,A
000B EF                MOV     A,R7
000C B4010B            CJNE    A,#01H,?C0001
                                           ; SOURCE LINE # 60
000F 900000      E     MOV     DPTR,#battery_check_count
0012 E4                CLR     A
0013 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 61
0014 900000      E     MOV     DPTR,#battery_check_waiting
0017 7401              MOV     A,#01H
0019 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 62
001A         ?C0001:
                                           ; SOURCE LINE # 64
001A 900000      E     MOV     DPTR,#mem_full_flag
001D E0                MOVX    A,@DPTR
001E FF                MOV     R7,A
001F EF                MOV     A,R7
0020 7053              JNZ     ?C0003
                                           ; SOURCE LINE # 66
0022         ?C0002:
                                           ; SOURCE LINE # 68
0022 900000      E     MOV     DPTR,#sample_unit
0025 E0                MOVX    A,@DPTR
0026 FF                MOV     R7,A
0027 EF                MOV     A,R7
0028 7027              JNZ     ?C0004
002A 900000      E     MOV     DPTR,#sample_enable_flag
002D E0                MOVX    A,@DPTR
002E FF                MOV     R7,A
002F EF                MOV     A,R7
0030 601F              JZ      ?C0004
                                           ; SOURCE LINE # 69
0032 900000      E     MOV     DPTR,#sample_interrupt_count
0035 E0                MOVX    A,@DPTR
0036 04                INC     A
0037 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 71
0038 900000      E     MOV     DPTR,#sample_interval
003B E0                MOVX    A,@DPTR
003C FF                MOV     R7,A
003D 900000      E     MOV     DPTR,#sample_interrupt_count
0040 E0                MOVX    A,@DPTR
0041 FE                MOV     R6,A
0042 EE                MOV     A,R6
0043 B5070B            CJNE    A,AR7,?C0004
                                           ; SOURCE LINE # 72
                                           ; SOURCE LINE # 73
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 19  

0046 900000      E     MOV     DPTR,#take_sample_waiting
0049 7401              MOV     A,#01H
004B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 74
004C 900000      E     MOV     DPTR,#sample_interrupt_count
004F E4                CLR     A
0050 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 75
0051         ?C0005:
                                           ; SOURCE LINE # 76
0051         ?C0004:
                                           ; SOURCE LINE # 78
0051 900000      E     MOV     DPTR,#low_batt_blink_count
0054 E0                MOVX    A,@DPTR
0055 04                INC     A
0056 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 79
0057 900000      E     MOV     DPTR,#low_batt_blink_count
005A E0                MOVX    A,@DPTR
005B FF                MOV     R7,A
005C EF                MOV     A,R7
005D C3                CLR     C
005E 9403              SUBB    A,#03H
0060 4013              JC      ?C0003
0062 900000      E     MOV     DPTR,#low_power_flag
0065 E0                MOVX    A,@DPTR
0066 FF                MOV     R7,A
0067 EF                MOV     A,R7
0068 600B              JZ      ?C0003
                                           ; SOURCE LINE # 80
006A 900000      E     MOV     DPTR,#low_batt_blink_count
006D E4                CLR     A
006E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 81
006F 900000      E     MOV     DPTR,#low_battery_blink_waiting
0072 7401              MOV     A,#01H
0074 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 82
0075         ?C0006:
                                           ; SOURCE LINE # 86
0075         ?C0003:
0075 22                RET     
             ; FUNCTION RTC_EverySecondHandler (END)

             ; FUNCTION RTC_EveryMinuteHandler (BEGIN)
                                           ; SOURCE LINE # 103
                                           ; SOURCE LINE # 104
                                           ; SOURCE LINE # 108
0000 900000      E     MOV     DPTR,#mem_full_flag
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 704A              JNZ     ?C0008
                                           ; SOURCE LINE # 110
0008         ?C0007:
                                           ; SOURCE LINE # 112
0008 900000      E     MOV     DPTR,#sample_unit
000B E0                MOVX    A,@DPTR
000C FF                MOV     R7,A
000D EF                MOV     A,R7
000E B40127            CJNE    A,#01H,?C0009
0011 900000      E     MOV     DPTR,#sample_enable_flag
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 20  

0014 E0                MOVX    A,@DPTR
0015 FF                MOV     R7,A
0016 EF                MOV     A,R7
0017 601F              JZ      ?C0009
                                           ; SOURCE LINE # 113
0019 900000      E     MOV     DPTR,#sample_interrupt_count
001C E0                MOVX    A,@DPTR
001D 04                INC     A
001E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 115
001F 900000      E     MOV     DPTR,#sample_interval
0022 E0                MOVX    A,@DPTR
0023 FF                MOV     R7,A
0024 900000      E     MOV     DPTR,#sample_interrupt_count
0027 E0                MOVX    A,@DPTR
0028 FE                MOV     R6,A
0029 EE                MOV     A,R6
002A B5070B            CJNE    A,AR7,?C0009
                                           ; SOURCE LINE # 116
                                           ; SOURCE LINE # 117
002D 900000      E     MOV     DPTR,#take_sample_waiting
0030 7401              MOV     A,#01H
0032 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 118
0033 900000      E     MOV     DPTR,#sample_interrupt_count
0036 E4                CLR     A
0037 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 119
0038         ?C0010:
                                           ; SOURCE LINE # 120
0038         ?C0009:
                                           ; SOURCE LINE # 122
0038 900000      E     MOV     DPTR,#battery_check_count
003B E0                MOVX    A,@DPTR
003C 04                INC     A
003D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 123
003E 900000      E     MOV     DPTR,#battery_check_count
0041 E0                MOVX    A,@DPTR
0042 FF                MOV     R7,A
0043 EF                MOV     A,R7
0044 B4010B            CJNE    A,#01H,?C0008
                                           ; SOURCE LINE # 124
0047 900000      E     MOV     DPTR,#battery_check_count
004A E4                CLR     A
004B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 125
004C 900000      E     MOV     DPTR,#battery_check_waiting
004F 7401              MOV     A,#01H
0051 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 126
0052         ?C0011:
                                           ; SOURCE LINE # 129
0052         ?C0008:
0052 22                RET     
             ; FUNCTION RTC_EveryMinuteHandler (END)

             ; FUNCTION RTC_EveryHourHandler (BEGIN)
                                           ; SOURCE LINE # 146
                                           ; SOURCE LINE # 147
                                           ; SOURCE LINE # 151
0000 900000      E     MOV     DPTR,#mem_full_flag
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 21  

0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 7027              JNZ     ?C0013
                                           ; SOURCE LINE # 153
0008         ?C0012:
                                           ; SOURCE LINE # 155
0008 900000      E     MOV     DPTR,#sample_enable_flag
000B E0                MOVX    A,@DPTR
000C FF                MOV     R7,A
000D EF                MOV     A,R7
000E 601F              JZ      ?C0013
                                           ; SOURCE LINE # 156
0010 900000      E     MOV     DPTR,#sample_interrupt_count
0013 E0                MOVX    A,@DPTR
0014 04                INC     A
0015 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 158
0016 900000      E     MOV     DPTR,#sample_interval
0019 E0                MOVX    A,@DPTR
001A FF                MOV     R7,A
001B 900000      E     MOV     DPTR,#sample_interrupt_count
001E E0                MOVX    A,@DPTR
001F FE                MOV     R6,A
0020 EE                MOV     A,R6
0021 B5070B            CJNE    A,AR7,?C0013
                                           ; SOURCE LINE # 159
                                           ; SOURCE LINE # 160
0024 900000      E     MOV     DPTR,#take_sample_waiting
0027 7401              MOV     A,#01H
0029 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 161
002A 900000      E     MOV     DPTR,#sample_interrupt_count
002D E4                CLR     A
002E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 162
002F         ?C0015:
                                           ; SOURCE LINE # 163
002F         ?C0014:
                                           ; SOURCE LINE # 165
002F         ?C0013:
002F 22                RET     
             ; FUNCTION RTC_EveryHourHandler (END)

             ; FUNCTION RTC_EveryDayHandler (BEGIN)
                                           ; SOURCE LINE # 182
                                           ; SOURCE LINE # 183
                                           ; SOURCE LINE # 187
0000 900000      E     MOV     DPTR,#mem_full_flag
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 7027              JNZ     ?C0017
                                           ; SOURCE LINE # 189
0008         ?C0016:
                                           ; SOURCE LINE # 191
0008 900000      E     MOV     DPTR,#sample_enable_flag
000B E0                MOVX    A,@DPTR
000C FF                MOV     R7,A
000D EF                MOV     A,R7
000E 601F              JZ      ?C0017
                                           ; SOURCE LINE # 192
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 22  

0010 900000      E     MOV     DPTR,#sample_interrupt_count
0013 E0                MOVX    A,@DPTR
0014 04                INC     A
0015 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 194
0016 900000      E     MOV     DPTR,#sample_interval
0019 E0                MOVX    A,@DPTR
001A FF                MOV     R7,A
001B 900000      E     MOV     DPTR,#sample_interrupt_count
001E E0                MOVX    A,@DPTR
001F FE                MOV     R6,A
0020 EE                MOV     A,R6
0021 B5070B            CJNE    A,AR7,?C0017
                                           ; SOURCE LINE # 195
                                           ; SOURCE LINE # 196
0024 900000      E     MOV     DPTR,#take_sample_waiting
0027 7401              MOV     A,#01H
0029 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 197
002A 900000      E     MOV     DPTR,#sample_interrupt_count
002D E4                CLR     A
002E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 198
002F         ?C0019:
                                           ; SOURCE LINE # 199
002F         ?C0018:
                                           ; SOURCE LINE # 201
002F         ?C0017:
002F 22                RET     
             ; FUNCTION RTC_EveryDayHandler (END)

             ; FUNCTION RTC_EveryWeekHandler (BEGIN)
                                           ; SOURCE LINE # 218
                                           ; SOURCE LINE # 219
                                           ; SOURCE LINE # 223
0000         ?C0020:
0000 22                RET     
             ; FUNCTION RTC_EveryWeekHandler (END)

             ; FUNCTION RTC_EveryMonthHandler (BEGIN)
                                           ; SOURCE LINE # 240
                                           ; SOURCE LINE # 241
                                           ; SOURCE LINE # 245
0000         ?C0021:
0000 22                RET     
             ; FUNCTION RTC_EveryMonthHandler (END)

             ; FUNCTION RTC_EveryYearHandler (BEGIN)
                                           ; SOURCE LINE # 262
                                           ; SOURCE LINE # 263
                                           ; SOURCE LINE # 267
0000         ?C0022:
0000 22                RET     
             ; FUNCTION RTC_EveryYearHandler (END)

             ; FUNCTION RTC_ISR (BEGIN)
0000 C0E0              PUSH    ACC
0002 C0F0              PUSH    B
0004 C083              PUSH    DPH
0006 C082              PUSH    DPL
0008 C085              PUSH    DPH1
000A C084              PUSH    DPL1
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 23  

000C C086              PUSH    DPS
000E 758600            MOV     DPS,#00H
0011 C000        E     PUSH    ?C?XPAGE1SFR
0013 750000      E     MOV     ?C?XPAGE1SFR,#?C?XPAGE1RST
0016 C0D0              PUSH    PSW
0018 75D000            MOV     PSW,#00H
001B C000              PUSH    AR0
001D C001              PUSH    AR1
001F C002              PUSH    AR2
0021 C003              PUSH    AR3
0023 C004              PUSH    AR4
0025 C005              PUSH    AR5
0027 C006              PUSH    AR6
0029 C007              PUSH    AR7
                                           ; SOURCE LINE # 308
                                           ; SOURCE LINE # 313
002B 7F04              MOV     R7,#04H
002D 120000      E     LCALL   _CyPmReadStatus
                                           ; SOURCE LINE # 316
0030 900000      E     MOV     DPTR,#RTC_currentTimeDate
0033 E0                MOVX    A,@DPTR
0034 04                INC     A
0035 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 319
0036 900000      E     MOV     DPTR,#RTC_currentTimeDate
0039 E0                MOVX    A,@DPTR
003A FF                MOV     R7,A
003B EF                MOV     A,R7
003C D3                SETB    C
003D 943B              SUBB    A,#03BH
003F 5003              JNC     $ + 5H
0041 020000      R     LJMP    ?C0023
                                           ; SOURCE LINE # 320
                                           ; SOURCE LINE # 322
0044 900000      E     MOV     DPTR,#RTC_currentTimeDate+01H
0047 E0                MOVX    A,@DPTR
0048 04                INC     A
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 325
004A 900000      E     MOV     DPTR,#RTC_currentTimeDate
004D E4                CLR     A
004E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 327
004F 900000      E     MOV     DPTR,#RTC_currentTimeDate+01H
0052 E0                MOVX    A,@DPTR
0053 FF                MOV     R7,A
0054 EF                MOV     A,R7
0055 D3                SETB    C
0056 943B              SUBB    A,#03BH
0058 5003              JNC     $ + 5H
005A 020000      R     LJMP    ?C0024
                                           ; SOURCE LINE # 328
                                           ; SOURCE LINE # 330
005D 900000      E     MOV     DPTR,#RTC_currentTimeDate+02H
0060 E0                MOVX    A,@DPTR
0061 04                INC     A
0062 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 333
0063 900000      E     MOV     DPTR,#RTC_currentTimeDate+01H
0066 E4                CLR     A
0067 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 336
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 24  

0068 900000      E     MOV     DPTR,#RTC_currentTimeDate+02H
006B E0                MOVX    A,@DPTR
006C FF                MOV     R7,A
006D EF                MOV     A,R7
006E D3                SETB    C
006F 9417              SUBB    A,#017H
0071 5003              JNC     $ + 5H
0073 020000      R     LJMP    ?C0025
                                           ; SOURCE LINE # 337
                                           ; SOURCE LINE # 339
0076 900000      E     MOV     DPTR,#RTC_currentTimeDate+04H
0079 E0                MOVX    A,@DPTR
007A 04                INC     A
007B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 342
007C 900000      E     MOV     DPTR,#RTC_currentTimeDate+02H
007F E4                CLR     A
0080 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 345
0081 900000      E     MOV     DPTR,#RTC_currentTimeDate+05H
0084 E4                CLR     A
0085 75F001            MOV     B,#01H
0088 120000      E     LCALL   ?C?IILDX
                                           ; SOURCE LINE # 348
008B 900000      E     MOV     DPTR,#RTC_currentTimeDate+03H
008E E0                MOVX    A,@DPTR
008F 04                INC     A
0090 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 351
0091 900000      E     MOV     DPTR,#RTC_currentTimeDate+03H
0094 E0                MOVX    A,@DPTR
0095 FF                MOV     R7,A
0096 EF                MOV     A,R7
0097 D3                SETB    C
0098 9407              SUBB    A,#07H
009A 4006              JC      ?C0026
                                           ; SOURCE LINE # 352
                                           ; SOURCE LINE # 354
009C 900000      E     MOV     DPTR,#RTC_currentTimeDate+03H
009F 7401              MOV     A,#01H
00A1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 355
00A2         ?C0026:
                                           ; SOURCE LINE # 362
00A2 900000      E     MOV     DPTR,#RTC_statusDateTime
00A5 E0                MOVX    A,@DPTR
00A6 FF                MOV     R7,A
00A7 EF                MOV     A,R7
00A8 5402              ANL     A,#02H
00AA FF                MOV     R7,A
00AB 7E00              MOV     R6,#00H
00AD EF                MOV     A,R7
00AE 4E                ORL     A,R6
00AF 602C              JZ      ?C0029
00B1 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
00B4 E0                MOVX    A,@DPTR
00B5 FF                MOV     R7,A
00B6 EF                MOV     A,R7
00B7 B40223            CJNE    A,#02H,?C0029
00BA 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
00BD E0                MOVX    A,@DPTR
00BE FF                MOV     R7,A
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 25  

00BF EF                MOV     A,R7
00C0 900000      E     MOV     DPTR,#RTC_daysInMonths-01H
00C3 93                MOVC    A,@A+DPTR
00C4 FF                MOV     R7,A
00C5 7E00              MOV     R6,#00H
00C7 EF                MOV     A,R7
00C8 2401              ADD     A,#01H
00CA FF                MOV     R7,A
00CB EE                MOV     A,R6
00CC 3400              ADDC    A,#00H
00CE FE                MOV     R6,A
00CF 900000      E     MOV     DPTR,#RTC_currentTimeDate+04H
00D2 E0                MOVX    A,@DPTR
00D3 FD                MOV     R5,A
00D4 7C00              MOV     R4,#00H
00D6 D3                SETB    C
00D7 ED                MOV     A,R5
00D8 9F                SUBB    A,R7
00D9 EC                MOV     A,R4
00DA 9E                SUBB    A,R6
00DB 5058              JNC     ?C0028
00DD         ?C0029:
00DD 900000      E     MOV     DPTR,#RTC_statusDateTime
00E0 E0                MOVX    A,@DPTR
00E1 FF                MOV     R7,A
00E2 EF                MOV     A,R7
00E3 5402              ANL     A,#02H
00E5 FF                MOV     R7,A
00E6 7E00              MOV     R6,#00H
00E8 EF                MOV     A,R7
00E9 4E                ORL     A,R6
00EA 601F              JZ      ?C0030
00EC 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
00EF E0                MOVX    A,@DPTR
00F0 FF                MOV     R7,A
00F1 EF                MOV     A,R7
00F2 6402              XRL     A,#02H
00F4 6015              JZ      ?C0030
00F6 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
00F9 E0                MOVX    A,@DPTR
00FA FF                MOV     R7,A
00FB EF                MOV     A,R7
00FC 900000      E     MOV     DPTR,#RTC_daysInMonths-01H
00FF 93                MOVC    A,@A+DPTR
0100 FF                MOV     R7,A
0101 900000      E     MOV     DPTR,#RTC_currentTimeDate+04H
0104 E0                MOVX    A,@DPTR
0105 FE                MOV     R6,A
0106 EE                MOV     A,R6
0107 D3                SETB    C
0108 9F                SUBB    A,R7
0109 502A              JNC     ?C0028
010B         ?C0030:
010B 900000      E     MOV     DPTR,#RTC_statusDateTime
010E E0                MOVX    A,@DPTR
010F FF                MOV     R7,A
0110 EF                MOV     A,R7
0111 5402              ANL     A,#02H
0113 FF                MOV     R7,A
0114 7E00              MOV     R6,#00H
0116 EF                MOV     A,R7
0117 4E                ORL     A,R6
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 26  

0118 6003              JZ      $ + 5H
011A 020000      R     LJMP    ?C0027
011D 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
0120 E0                MOVX    A,@DPTR
0121 FF                MOV     R7,A
0122 EF                MOV     A,R7
0123 900000      E     MOV     DPTR,#RTC_daysInMonths-01H
0126 93                MOVC    A,@A+DPTR
0127 FF                MOV     R7,A
0128 900000      E     MOV     DPTR,#RTC_currentTimeDate+04H
012B E0                MOVX    A,@DPTR
012C FE                MOV     R6,A
012D EE                MOV     A,R6
012E D3                SETB    C
012F 9F                SUBB    A,R7
0130 5003              JNC     $ + 5H
0132 020000      R     LJMP    ?C0027
0135         ?C0028:
                                           ; SOURCE LINE # 373
                                           ; SOURCE LINE # 375
0135 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
0138 E0                MOVX    A,@DPTR
0139 04                INC     A
013A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 378
013B 900000      E     MOV     DPTR,#RTC_currentTimeDate+04H
013E 7401              MOV     A,#01H
0140 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 381
0141 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
0144 E0                MOVX    A,@DPTR
0145 FF                MOV     R7,A
0146 EF                MOV     A,R7
0147 D3                SETB    C
0148 940C              SUBB    A,#0CH
014A 5003              JNC     $ + 5H
014C 020000      R     LJMP    ?C0031
                                           ; SOURCE LINE # 382
                                           ; SOURCE LINE # 384
014F 900000      E     MOV     DPTR,#RTC_currentTimeDate+08H
0152 E4                CLR     A
0153 75F001            MOV     B,#01H
0156 120000      E     LCALL   ?C?IILDX
                                           ; SOURCE LINE # 387
0159 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
015C 7401              MOV     A,#01H
015E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 390
015F 900000      E     MOV     DPTR,#RTC_currentTimeDate+05H
0162 E4                CLR     A
0163 F0                MOVX    @DPTR,A
0164 A3                INC     DPTR
0165 7401              MOV     A,#01H
0167 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 393
0168 900000      E     MOV     DPTR,#RTC_currentTimeDate+08H
016B E0                MOVX    A,@DPTR
016C FE                MOV     R6,A
016D A3                INC     DPTR
016E E0                MOVX    A,@DPTR
016F FF                MOV     R7,A
0170 7C01              MOV     R4,#01H
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 27  

0172 7D90              MOV     R5,#090H
0174 120000      E     LCALL   ?C?UIDIV
0177 ED                MOV     A,R5
0178 4C                ORL     A,R4
0179 6025              JZ      ?C0035
017B 900000      E     MOV     DPTR,#RTC_currentTimeDate+08H
017E E0                MOVX    A,@DPTR
017F FE                MOV     R6,A
0180 A3                INC     DPTR
0181 E0                MOVX    A,@DPTR
0182 FF                MOV     R7,A
0183 7E00              MOV     R6,#00H
0185 EF                MOV     A,R7
0186 5403              ANL     A,#03H
0188 FF                MOV     R7,A
0189 EF                MOV     A,R7
018A 4E                ORL     A,R6
018B 7017              JNZ     ?C0033
018D 900000      E     MOV     DPTR,#RTC_currentTimeDate+08H
0190 E0                MOVX    A,@DPTR
0191 FE                MOV     R6,A
0192 A3                INC     DPTR
0193 E0                MOVX    A,@DPTR
0194 FF                MOV     R7,A
0195 7C00              MOV     R4,#00H
0197 7D64              MOV     R5,#064H
0199 120000      E     LCALL   ?C?UIDIV
019C ED                MOV     A,R5
019D 4C                ORL     A,R4
019E 6004              JZ      ?C0033
01A0         ?C0035:
01A0 7F01              MOV     R7,#01H
01A2 8002              SJMP    ?C0034
01A4         ?C0033:
01A4 7F00              MOV     R7,#00H
01A6         ?C0034:
01A6 EF                MOV     A,R7
01A7 B40110            CJNE    A,#01H,?C0032
                                           ; SOURCE LINE # 394
                                           ; SOURCE LINE # 396
01AA 900000      E     MOV     DPTR,#RTC_statusDateTime
01AD E0                MOVX    A,@DPTR
01AE FF                MOV     R7,A
01AF EF                MOV     A,R7
01B0 4402              ORL     A,#02H
01B2 FF                MOV     R7,A
01B3 900000      E     MOV     DPTR,#RTC_statusDateTime
01B6 EF                MOV     A,R7
01B7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 397
01B8 800E              SJMP    ?C0036
01BA         ?C0032:
                                           ; SOURCE LINE # 399
                                           ; SOURCE LINE # 401
01BA 900000      E     MOV     DPTR,#RTC_statusDateTime
01BD E0                MOVX    A,@DPTR
01BE FF                MOV     R7,A
01BF EF                MOV     A,R7
01C0 54FD              ANL     A,#0FDH
01C2 FF                MOV     R7,A
01C3 900000      E     MOV     DPTR,#RTC_statusDateTime
01C6 EF                MOV     A,R7
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 28  

01C7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 402
01C8         ?C0036:
                                           ; SOURCE LINE # 405
01C8 900000      E     MOV     DPTR,#RTC_alarmCfgMask
01CB E0                MOVX    A,@DPTR
01CC FF                MOV     R7,A
01CD EF                MOV     A,R7
01CE 5480              ANL     A,#080H
01D0 FF                MOV     R7,A
01D1 7E00              MOV     R6,#00H
01D3 EF                MOV     A,R7
01D4 6480              XRL     A,#080H
01D6 4E                ORL     A,R6
01D7 7004              JNZ     ?C0038
01D9 7F01              MOV     R7,#01H
01DB 8002              SJMP    ?C0039
01DD         ?C0038:
01DD 7F00              MOV     R7,#00H
01DF         ?C0039:
01DF EF                MOV     A,R7
01E0 6036              JZ      ?C0037
                                           ; SOURCE LINE # 407
                                           ; SOURCE LINE # 409
01E2 900000      E     MOV     DPTR,#RTC_currentTimeDate+08H
01E5 E0                MOVX    A,@DPTR
01E6 FE                MOV     R6,A
01E7 A3                INC     DPTR
01E8 E0                MOVX    A,@DPTR
01E9 FF                MOV     R7,A
01EA 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+08H
01ED E0                MOVX    A,@DPTR
01EE FC                MOV     R4,A
01EF A3                INC     DPTR
01F0 E0                MOVX    A,@DPTR
01F1 FD                MOV     R5,A
01F2 ED                MOV     A,R5
01F3 B50714            CJNE    A,AR7,?C0040
01F6 EC                MOV     A,R4
01F7 B50610            CJNE    A,AR6,?C0040
                                           ; SOURCE LINE # 410
                                           ; SOURCE LINE # 412
01FA 900000      E     MOV     DPTR,#RTC_alarmCurStatus
01FD E0                MOVX    A,@DPTR
01FE FF                MOV     R7,A
01FF EF                MOV     A,R7
0200 4480              ORL     A,#080H
0202 FF                MOV     R7,A
0203 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0206 EF                MOV     A,R7
0207 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 413
0208 800E              SJMP    ?C0037
020A         ?C0040:
                                           ; SOURCE LINE # 415
                                           ; SOURCE LINE # 417
020A 900000      E     MOV     DPTR,#RTC_alarmCurStatus
020D E0                MOVX    A,@DPTR
020E FF                MOV     R7,A
020F EF                MOV     A,R7
0210 547F              ANL     A,#07FH
0212 FF                MOV     R7,A
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 29  

0213 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0216 EF                MOV     A,R7
0217 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 418
0218         ?C0041:
                                           ; SOURCE LINE # 419
0218         ?C0037:
                                           ; SOURCE LINE # 422
0218 900000      E     MOV     DPTR,#RTC_alarmCfgMask
021B E0                MOVX    A,@DPTR
021C FF                MOV     R7,A
021D 900000      R     MOV     DPTR,#RTC_tmp
0220 EF                MOV     A,R7
0221 F0                MOVX    @DPTR,A
0222         ?C0044:
                                           ; SOURCE LINE # 425
0222 900000      R     MOV     DPTR,#RTC_tmp
0225 E0                MOVX    A,@DPTR
0226 FF                MOV     R7,A
0227 EF                MOV     A,R7
0228 6032              JZ      ?C0043
022A 900000      R     MOV     DPTR,#RTC_tmp
022D E0                MOVX    A,@DPTR
022E FF                MOV     R7,A
022F 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0232 E0                MOVX    A,@DPTR
0233 FE                MOV     R6,A
0234 EE                MOV     A,R6
0235 5F                ANL     A,R7
0236 FF                MOV     R7,A
0237 900000      R     MOV     DPTR,#RTC_tmp
023A E0                MOVX    A,@DPTR
023B FE                MOV     R6,A
023C EF                MOV     A,R7
023D B50604            CJNE    A,AR6,?C0046
0240 7F01              MOV     R7,#01H
0242 8002              SJMP    ?C0047
0244         ?C0046:
0244 7F00              MOV     R7,#00H
0246         ?C0047:
0246 EF                MOV     A,R7
0247 6013              JZ      ?C0043
0249 900000      E     MOV     DPTR,#RTC_statusDateTime
024C E0                MOVX    A,@DPTR
024D FF                MOV     R7,A
024E EF                MOV     A,R7
024F 4408              ORL     A,#08H
0251 FF                MOV     R7,A
0252 900000      E     MOV     DPTR,#RTC_statusDateTime
0255 EF                MOV     A,R7
0256 F0                MOVX    @DPTR,A
0257 900000      E     MOV     DPTR,#RTC_alarmCurStatus
025A E4                CLR     A
025B F0                MOVX    @DPTR,A
025C         ?C0045:
025C         ?C0042:
025C         ?C0043:
                                           ; SOURCE LINE # 428
025C 900000      E     MOV     DPTR,#RTC_intervalCfgMask
025F E0                MOVX    A,@DPTR
0260 FF                MOV     R7,A
0261 EF                MOV     A,R7
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 30  

0262 5440              ANL     A,#040H
0264 FF                MOV     R7,A
0265 7E00              MOV     R6,#00H
0267 EF                MOV     A,R7
0268 6440              XRL     A,#040H
026A 4E                ORL     A,R6
026B 7004              JNZ     ?C0049
026D 7F01              MOV     R7,#01H
026F 8002              SJMP    ?C0050
0271         ?C0049:
0271 7F00              MOV     R7,#00H
0273         ?C0050:
0273 EF                MOV     A,R7
0274 6003              JZ      ?C0031
                                           ; SOURCE LINE # 430
                                           ; SOURCE LINE # 431
0276 120000      R     LCALL   RTC_EveryYearHandler
                                           ; SOURCE LINE # 432
0279         ?C0048:
                                           ; SOURCE LINE # 434
0279         ?C0031:
                                           ; SOURCE LINE # 437
0279 900000      E     MOV     DPTR,#RTC_alarmCfgMask
027C E0                MOVX    A,@DPTR
027D FF                MOV     R7,A
027E EF                MOV     A,R7
027F 5440              ANL     A,#040H
0281 FF                MOV     R7,A
0282 7E00              MOV     R6,#00H
0284 EF                MOV     A,R7
0285 6440              XRL     A,#040H
0287 4E                ORL     A,R6
0288 7004              JNZ     ?C0052
028A 7F01              MOV     R7,#01H
028C 8002              SJMP    ?C0053
028E         ?C0052:
028E 7F00              MOV     R7,#00H
0290         ?C0053:
0290 EF                MOV     A,R7
0291 602C              JZ      ?C0051
                                           ; SOURCE LINE # 439
                                           ; SOURCE LINE # 440
0293 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
0296 E0                MOVX    A,@DPTR
0297 FF                MOV     R7,A
0298 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+07H
029B E0                MOVX    A,@DPTR
029C FE                MOV     R6,A
029D EE                MOV     A,R6
029E B50710            CJNE    A,AR7,?C0054
                                           ; SOURCE LINE # 441
                                           ; SOURCE LINE # 443
02A1 900000      E     MOV     DPTR,#RTC_alarmCurStatus
02A4 E0                MOVX    A,@DPTR
02A5 FF                MOV     R7,A
02A6 EF                MOV     A,R7
02A7 4440              ORL     A,#040H
02A9 FF                MOV     R7,A
02AA 900000      E     MOV     DPTR,#RTC_alarmCurStatus
02AD EF                MOV     A,R7
02AE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 444
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 31  

02AF 800E              SJMP    ?C0051
02B1         ?C0054:
                                           ; SOURCE LINE # 446
                                           ; SOURCE LINE # 448
02B1 900000      E     MOV     DPTR,#RTC_alarmCurStatus
02B4 E0                MOVX    A,@DPTR
02B5 FF                MOV     R7,A
02B6 EF                MOV     A,R7
02B7 54BF              ANL     A,#0BFH
02B9 FF                MOV     R7,A
02BA 900000      E     MOV     DPTR,#RTC_alarmCurStatus
02BD EF                MOV     A,R7
02BE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 449
02BF         ?C0055:
                                           ; SOURCE LINE # 450
02BF         ?C0051:
                                           ; SOURCE LINE # 473
02BF 900000      E     MOV     DPTR,#RTC_alarmCfgMask
02C2 E0                MOVX    A,@DPTR
02C3 FF                MOV     R7,A
02C4 900000      R     MOV     DPTR,#RTC_tmp
02C7 EF                MOV     A,R7
02C8 F0                MOVX    @DPTR,A
02C9         ?C0058:
                                           ; SOURCE LINE # 476
02C9 900000      R     MOV     DPTR,#RTC_tmp
02CC E0                MOVX    A,@DPTR
02CD FF                MOV     R7,A
02CE EF                MOV     A,R7
02CF 6032              JZ      ?C0057
02D1 900000      R     MOV     DPTR,#RTC_tmp
02D4 E0                MOVX    A,@DPTR
02D5 FF                MOV     R7,A
02D6 900000      E     MOV     DPTR,#RTC_alarmCurStatus
02D9 E0                MOVX    A,@DPTR
02DA FE                MOV     R6,A
02DB EE                MOV     A,R6
02DC 5F                ANL     A,R7
02DD FF                MOV     R7,A
02DE 900000      R     MOV     DPTR,#RTC_tmp
02E1 E0                MOVX    A,@DPTR
02E2 FE                MOV     R6,A
02E3 EF                MOV     A,R7
02E4 B50604            CJNE    A,AR6,?C0060
02E7 7F01              MOV     R7,#01H
02E9 8002              SJMP    ?C0061
02EB         ?C0060:
02EB 7F00              MOV     R7,#00H
02ED         ?C0061:
02ED EF                MOV     A,R7
02EE 6013              JZ      ?C0057
02F0 900000      E     MOV     DPTR,#RTC_statusDateTime
02F3 E0                MOVX    A,@DPTR
02F4 FF                MOV     R7,A
02F5 EF                MOV     A,R7
02F6 4408              ORL     A,#08H
02F8 FF                MOV     R7,A
02F9 900000      E     MOV     DPTR,#RTC_statusDateTime
02FC EF                MOV     A,R7
02FD F0                MOVX    @DPTR,A
02FE 900000      E     MOV     DPTR,#RTC_alarmCurStatus
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 32  

0301 E4                CLR     A
0302 F0                MOVX    @DPTR,A
0303         ?C0059:
0303         ?C0056:
0303         ?C0057:
                                           ; SOURCE LINE # 479
0303 900000      E     MOV     DPTR,#RTC_intervalCfgMask
0306 E0                MOVX    A,@DPTR
0307 FF                MOV     R7,A
0308 EF                MOV     A,R7
0309 5420              ANL     A,#020H
030B FF                MOV     R7,A
030C 7E00              MOV     R6,#00H
030E EF                MOV     A,R7
030F 6420              XRL     A,#020H
0311 4E                ORL     A,R6
0312 7004              JNZ     ?C0063
0314 7F01              MOV     R7,#01H
0316 8002              SJMP    ?C0064
0318         ?C0063:
0318 7F00              MOV     R7,#00H
031A         ?C0064:
031A EF                MOV     A,R7
031B 6003              JZ      ?C0027
                                           ; SOURCE LINE # 481
                                           ; SOURCE LINE # 482
031D 120000      R     LCALL   RTC_EveryMonthHandler
                                           ; SOURCE LINE # 483
0320         ?C0062:
                                           ; SOURCE LINE # 484
0320         ?C0027:
                                           ; SOURCE LINE # 487
0320 900000      E     MOV     DPTR,#RTC_alarmCfgMask
0323 E0                MOVX    A,@DPTR
0324 FF                MOV     R7,A
0325 EF                MOV     A,R7
0326 5408              ANL     A,#08H
0328 FF                MOV     R7,A
0329 7E00              MOV     R6,#00H
032B EF                MOV     A,R7
032C 6408              XRL     A,#08H
032E 4E                ORL     A,R6
032F 7004              JNZ     ?C0066
0331 7F01              MOV     R7,#01H
0333 8002              SJMP    ?C0067
0335         ?C0066:
0335 7F00              MOV     R7,#00H
0337         ?C0067:
0337 EF                MOV     A,R7
0338 602C              JZ      ?C0065
                                           ; SOURCE LINE # 489
                                           ; SOURCE LINE # 490
033A 900000      E     MOV     DPTR,#RTC_currentTimeDate+03H
033D E0                MOVX    A,@DPTR
033E FF                MOV     R7,A
033F 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+03H
0342 E0                MOVX    A,@DPTR
0343 FE                MOV     R6,A
0344 EE                MOV     A,R6
0345 B50710            CJNE    A,AR7,?C0068
                                           ; SOURCE LINE # 491
                                           ; SOURCE LINE # 493
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 33  

0348 900000      E     MOV     DPTR,#RTC_alarmCurStatus
034B E0                MOVX    A,@DPTR
034C FF                MOV     R7,A
034D EF                MOV     A,R7
034E 4408              ORL     A,#08H
0350 FF                MOV     R7,A
0351 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0354 EF                MOV     A,R7
0355 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 494
0356 800E              SJMP    ?C0065
0358         ?C0068:
                                           ; SOURCE LINE # 496
                                           ; SOURCE LINE # 498
0358 900000      E     MOV     DPTR,#RTC_alarmCurStatus
035B E0                MOVX    A,@DPTR
035C FF                MOV     R7,A
035D EF                MOV     A,R7
035E 54F7              ANL     A,#0F7H
0360 FF                MOV     R7,A
0361 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0364 EF                MOV     A,R7
0365 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 499
0366         ?C0069:
                                           ; SOURCE LINE # 500
0366         ?C0065:
                                           ; SOURCE LINE # 503
0366 900000      E     MOV     DPTR,#RTC_alarmCfgMask
0369 E0                MOVX    A,@DPTR
036A FF                MOV     R7,A
036B EF                MOV     A,R7
036C 5420              ANL     A,#020H
036E FF                MOV     R7,A
036F 7E00              MOV     R6,#00H
0371 EF                MOV     A,R7
0372 6420              XRL     A,#020H
0374 4E                ORL     A,R6
0375 7004              JNZ     ?C0071
0377 7F01              MOV     R7,#01H
0379 8002              SJMP    ?C0072
037B         ?C0071:
037B 7F00              MOV     R7,#00H
037D         ?C0072:
037D EF                MOV     A,R7
037E 6036              JZ      ?C0070
                                           ; SOURCE LINE # 505
                                           ; SOURCE LINE # 506
0380 900000      E     MOV     DPTR,#RTC_currentTimeDate+05H
0383 E0                MOVX    A,@DPTR
0384 FE                MOV     R6,A
0385 A3                INC     DPTR
0386 E0                MOVX    A,@DPTR
0387 FF                MOV     R7,A
0388 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+05H
038B E0                MOVX    A,@DPTR
038C FC                MOV     R4,A
038D A3                INC     DPTR
038E E0                MOVX    A,@DPTR
038F FD                MOV     R5,A
0390 ED                MOV     A,R5
0391 B50714            CJNE    A,AR7,?C0073
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 34  

0394 EC                MOV     A,R4
0395 B50610            CJNE    A,AR6,?C0073
                                           ; SOURCE LINE # 507
                                           ; SOURCE LINE # 509
0398 900000      E     MOV     DPTR,#RTC_alarmCurStatus
039B E0                MOVX    A,@DPTR
039C FF                MOV     R7,A
039D EF                MOV     A,R7
039E 4420              ORL     A,#020H
03A0 FF                MOV     R7,A
03A1 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03A4 EF                MOV     A,R7
03A5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 510
03A6 800E              SJMP    ?C0070
03A8         ?C0073:
                                           ; SOURCE LINE # 512
                                           ; SOURCE LINE # 514
03A8 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03AB E0                MOVX    A,@DPTR
03AC FF                MOV     R7,A
03AD EF                MOV     A,R7
03AE 54DF              ANL     A,#0DFH
03B0 FF                MOV     R7,A
03B1 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03B4 EF                MOV     A,R7
03B5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 515
03B6         ?C0074:
                                           ; SOURCE LINE # 516
03B6         ?C0070:
                                           ; SOURCE LINE # 519
03B6 900000      E     MOV     DPTR,#RTC_alarmCfgMask
03B9 E0                MOVX    A,@DPTR
03BA FF                MOV     R7,A
03BB EF                MOV     A,R7
03BC 5410              ANL     A,#010H
03BE FF                MOV     R7,A
03BF 7E00              MOV     R6,#00H
03C1 EF                MOV     A,R7
03C2 6410              XRL     A,#010H
03C4 4E                ORL     A,R6
03C5 7004              JNZ     ?C0076
03C7 7F01              MOV     R7,#01H
03C9 8002              SJMP    ?C0077
03CB         ?C0076:
03CB 7F00              MOV     R7,#00H
03CD         ?C0077:
03CD EF                MOV     A,R7
03CE 602C              JZ      ?C0075
                                           ; SOURCE LINE # 521
                                           ; SOURCE LINE # 522
03D0 900000      E     MOV     DPTR,#RTC_currentTimeDate+04H
03D3 E0                MOVX    A,@DPTR
03D4 FF                MOV     R7,A
03D5 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+04H
03D8 E0                MOVX    A,@DPTR
03D9 FE                MOV     R6,A
03DA EE                MOV     A,R6
03DB B50710            CJNE    A,AR7,?C0078
                                           ; SOURCE LINE # 523
                                           ; SOURCE LINE # 525
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 35  

03DE 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03E1 E0                MOVX    A,@DPTR
03E2 FF                MOV     R7,A
03E3 EF                MOV     A,R7
03E4 4410              ORL     A,#010H
03E6 FF                MOV     R7,A
03E7 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03EA EF                MOV     A,R7
03EB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 526
03EC 800E              SJMP    ?C0075
03EE         ?C0078:
                                           ; SOURCE LINE # 528
                                           ; SOURCE LINE # 530
03EE 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03F1 E0                MOVX    A,@DPTR
03F2 FF                MOV     R7,A
03F3 EF                MOV     A,R7
03F4 54EF              ANL     A,#0EFH
03F6 FF                MOV     R7,A
03F7 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03FA EF                MOV     A,R7
03FB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 531
03FC         ?C0079:
                                           ; SOURCE LINE # 532
03FC         ?C0075:
                                           ; SOURCE LINE # 555
03FC 900000      E     MOV     DPTR,#RTC_alarmCfgMask
03FF E0                MOVX    A,@DPTR
0400 FF                MOV     R7,A
0401 900000      R     MOV     DPTR,#RTC_tmp
0404 EF                MOV     A,R7
0405 F0                MOVX    @DPTR,A
0406         ?C0082:
                                           ; SOURCE LINE # 558
0406 900000      R     MOV     DPTR,#RTC_tmp
0409 E0                MOVX    A,@DPTR
040A FF                MOV     R7,A
040B EF                MOV     A,R7
040C 6032              JZ      ?C0081
040E 900000      R     MOV     DPTR,#RTC_tmp
0411 E0                MOVX    A,@DPTR
0412 FF                MOV     R7,A
0413 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0416 E0                MOVX    A,@DPTR
0417 FE                MOV     R6,A
0418 EE                MOV     A,R6
0419 5F                ANL     A,R7
041A FF                MOV     R7,A
041B 900000      R     MOV     DPTR,#RTC_tmp
041E E0                MOVX    A,@DPTR
041F FE                MOV     R6,A
0420 EF                MOV     A,R7
0421 B50604            CJNE    A,AR6,?C0084
0424 7F01              MOV     R7,#01H
0426 8002              SJMP    ?C0085
0428         ?C0084:
0428 7F00              MOV     R7,#00H
042A         ?C0085:
042A EF                MOV     A,R7
042B 6013              JZ      ?C0081
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 36  

042D 900000      E     MOV     DPTR,#RTC_statusDateTime
0430 E0                MOVX    A,@DPTR
0431 FF                MOV     R7,A
0432 EF                MOV     A,R7
0433 4408              ORL     A,#08H
0435 FF                MOV     R7,A
0436 900000      E     MOV     DPTR,#RTC_statusDateTime
0439 EF                MOV     A,R7
043A F0                MOVX    @DPTR,A
043B 900000      E     MOV     DPTR,#RTC_alarmCurStatus
043E E4                CLR     A
043F F0                MOVX    @DPTR,A
0440         ?C0083:
0440         ?C0080:
0440         ?C0081:
                                           ; SOURCE LINE # 561
0440 900000      E     MOV     DPTR,#RTC_intervalCfgMask
0443 E0                MOVX    A,@DPTR
0444 FF                MOV     R7,A
0445 EF                MOV     A,R7
0446 5408              ANL     A,#08H
0448 FF                MOV     R7,A
0449 7E00              MOV     R6,#00H
044B EF                MOV     A,R7
044C 6408              XRL     A,#08H
044E 4E                ORL     A,R6
044F 7004              JNZ     ?C0087
0451 7F01              MOV     R7,#01H
0453 8002              SJMP    ?C0088
0455         ?C0087:
0455 7F00              MOV     R7,#00H
0457         ?C0088:
0457 EF                MOV     A,R7
0458 6003              JZ      ?C0086
                                           ; SOURCE LINE # 563
                                           ; SOURCE LINE # 564
045A 120000      R     LCALL   RTC_EveryDayHandler
                                           ; SOURCE LINE # 565
045D         ?C0086:
                                           ; SOURCE LINE # 567
045D 900000      E     MOV     DPTR,#RTC_currentTimeDate+03H
0460 E0                MOVX    A,@DPTR
0461 FF                MOV     R7,A
0462 EF                MOV     A,R7
0463 B4011D            CJNE    A,#01H,?C0025
                                           ; SOURCE LINE # 568
                                           ; SOURCE LINE # 570
0466 900000      E     MOV     DPTR,#RTC_intervalCfgMask
0469 E0                MOVX    A,@DPTR
046A FF                MOV     R7,A
046B EF                MOV     A,R7
046C 5410              ANL     A,#010H
046E FF                MOV     R7,A
046F 7E00              MOV     R6,#00H
0471 EF                MOV     A,R7
0472 6410              XRL     A,#010H
0474 4E                ORL     A,R6
0475 7004              JNZ     ?C0091
0477 7F01              MOV     R7,#01H
0479 8002              SJMP    ?C0092
047B         ?C0091:
047B 7F00              MOV     R7,#00H
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 37  

047D         ?C0092:
047D EF                MOV     A,R7
047E 6003              JZ      ?C0025
                                           ; SOURCE LINE # 572
                                           ; SOURCE LINE # 573
0480 120000      R     LCALL   RTC_EveryWeekHandler
                                           ; SOURCE LINE # 574
0483         ?C0090:
                                           ; SOURCE LINE # 575
0483         ?C0089:
                                           ; SOURCE LINE # 577
0483         ?C0025:
                                           ; SOURCE LINE # 580
0483 900000      E     MOV     DPTR,#RTC_currentTimeDate+02H
0486 E0                MOVX    A,@DPTR
0487 FF                MOV     R7,A
0488 EF                MOV     A,R7
0489 C3                CLR     C
048A 940C              SUBB    A,#0CH
048C 5010              JNC     ?C0093
                                           ; SOURCE LINE # 581
                                           ; SOURCE LINE # 583
048E 900000      E     MOV     DPTR,#RTC_statusDateTime
0491 E0                MOVX    A,@DPTR
0492 FF                MOV     R7,A
0493 EF                MOV     A,R7
0494 54FB              ANL     A,#0FBH
0496 FF                MOV     R7,A
0497 900000      E     MOV     DPTR,#RTC_statusDateTime
049A EF                MOV     A,R7
049B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 584
049C 800E              SJMP    ?C0094
049E         ?C0093:
                                           ; SOURCE LINE # 586
                                           ; SOURCE LINE # 588
049E 900000      E     MOV     DPTR,#RTC_statusDateTime
04A1 E0                MOVX    A,@DPTR
04A2 FF                MOV     R7,A
04A3 EF                MOV     A,R7
04A4 4404              ORL     A,#04H
04A6 FF                MOV     R7,A
04A7 900000      E     MOV     DPTR,#RTC_statusDateTime
04AA EF                MOV     A,R7
04AB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 589
04AC         ?C0094:
                                           ; SOURCE LINE # 916
04AC 900000      E     MOV     DPTR,#RTC_alarmCfgMask
04AF E0                MOVX    A,@DPTR
04B0 FF                MOV     R7,A
04B1 EF                MOV     A,R7
04B2 5404              ANL     A,#04H
04B4 FF                MOV     R7,A
04B5 7E00              MOV     R6,#00H
04B7 EF                MOV     A,R7
04B8 6404              XRL     A,#04H
04BA 4E                ORL     A,R6
04BB 7004              JNZ     ?C0096
04BD 7F01              MOV     R7,#01H
04BF 8002              SJMP    ?C0097
04C1         ?C0096:
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 38  

04C1 7F00              MOV     R7,#00H
04C3         ?C0097:
04C3 EF                MOV     A,R7
04C4 602C              JZ      ?C0095
                                           ; SOURCE LINE # 917
                                           ; SOURCE LINE # 918
04C6 900000      E     MOV     DPTR,#RTC_currentTimeDate+02H
04C9 E0                MOVX    A,@DPTR
04CA FF                MOV     R7,A
04CB 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+02H
04CE E0                MOVX    A,@DPTR
04CF FE                MOV     R6,A
04D0 EE                MOV     A,R6
04D1 B50710            CJNE    A,AR7,?C0098
                                           ; SOURCE LINE # 919
                                           ; SOURCE LINE # 920
04D4 900000      E     MOV     DPTR,#RTC_alarmCurStatus
04D7 E0                MOVX    A,@DPTR
04D8 FF                MOV     R7,A
04D9 EF                MOV     A,R7
04DA 4404              ORL     A,#04H
04DC FF                MOV     R7,A
04DD 900000      E     MOV     DPTR,#RTC_alarmCurStatus
04E0 EF                MOV     A,R7
04E1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 921
04E2 800E              SJMP    ?C0095
04E4         ?C0098:
                                           ; SOURCE LINE # 923
                                           ; SOURCE LINE # 924
04E4 900000      E     MOV     DPTR,#RTC_alarmCurStatus
04E7 E0                MOVX    A,@DPTR
04E8 FF                MOV     R7,A
04E9 EF                MOV     A,R7
04EA 54FB              ANL     A,#0FBH
04EC FF                MOV     R7,A
04ED 900000      E     MOV     DPTR,#RTC_alarmCurStatus
04F0 EF                MOV     A,R7
04F1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 925
04F2         ?C0099:
                                           ; SOURCE LINE # 926
04F2         ?C0095:
                                           ; SOURCE LINE # 929
04F2 900000      E     MOV     DPTR,#RTC_alarmCfgMask
04F5 E0                MOVX    A,@DPTR
04F6 FF                MOV     R7,A
04F7 900000      R     MOV     DPTR,#RTC_tmp
04FA EF                MOV     A,R7
04FB F0                MOVX    @DPTR,A
04FC         ?C0102:
                                           ; SOURCE LINE # 932
04FC 900000      R     MOV     DPTR,#RTC_tmp
04FF E0                MOVX    A,@DPTR
0500 FF                MOV     R7,A
0501 EF                MOV     A,R7
0502 6032              JZ      ?C0101
0504 900000      R     MOV     DPTR,#RTC_tmp
0507 E0                MOVX    A,@DPTR
0508 FF                MOV     R7,A
0509 900000      E     MOV     DPTR,#RTC_alarmCurStatus
050C E0                MOVX    A,@DPTR
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 39  

050D FE                MOV     R6,A
050E EE                MOV     A,R6
050F 5F                ANL     A,R7
0510 FF                MOV     R7,A
0511 900000      R     MOV     DPTR,#RTC_tmp
0514 E0                MOVX    A,@DPTR
0515 FE                MOV     R6,A
0516 EF                MOV     A,R7
0517 B50604            CJNE    A,AR6,?C0104
051A 7F01              MOV     R7,#01H
051C 8002              SJMP    ?C0105
051E         ?C0104:
051E 7F00              MOV     R7,#00H
0520         ?C0105:
0520 EF                MOV     A,R7
0521 6013              JZ      ?C0101
0523 900000      E     MOV     DPTR,#RTC_statusDateTime
0526 E0                MOVX    A,@DPTR
0527 FF                MOV     R7,A
0528 EF                MOV     A,R7
0529 4408              ORL     A,#08H
052B FF                MOV     R7,A
052C 900000      E     MOV     DPTR,#RTC_statusDateTime
052F EF                MOV     A,R7
0530 F0                MOVX    @DPTR,A
0531 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0534 E4                CLR     A
0535 F0                MOVX    @DPTR,A
0536         ?C0103:
0536         ?C0100:
0536         ?C0101:
                                           ; SOURCE LINE # 935
0536 900000      E     MOV     DPTR,#RTC_intervalCfgMask
0539 E0                MOVX    A,@DPTR
053A FF                MOV     R7,A
053B EF                MOV     A,R7
053C 5404              ANL     A,#04H
053E FF                MOV     R7,A
053F 7E00              MOV     R6,#00H
0541 EF                MOV     A,R7
0542 6404              XRL     A,#04H
0544 4E                ORL     A,R6
0545 7004              JNZ     ?C0107
0547 7F01              MOV     R7,#01H
0549 8002              SJMP    ?C0108
054B         ?C0107:
054B 7F00              MOV     R7,#00H
054D         ?C0108:
054D EF                MOV     A,R7
054E 6003              JZ      ?C0024
                                           ; SOURCE LINE # 936
                                           ; SOURCE LINE # 937
0550 120000      R     LCALL   RTC_EveryHourHandler
                                           ; SOURCE LINE # 938
0553         ?C0106:
                                           ; SOURCE LINE # 939
0553         ?C0024:
                                           ; SOURCE LINE # 942
0553 900000      E     MOV     DPTR,#RTC_alarmCfgMask
0556 E0                MOVX    A,@DPTR
0557 FF                MOV     R7,A
0558 EF                MOV     A,R7
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 40  

0559 5402              ANL     A,#02H
055B FF                MOV     R7,A
055C 7E00              MOV     R6,#00H
055E EF                MOV     A,R7
055F 6402              XRL     A,#02H
0561 4E                ORL     A,R6
0562 7004              JNZ     ?C0110
0564 7F01              MOV     R7,#01H
0566 8002              SJMP    ?C0111
0568         ?C0110:
0568 7F00              MOV     R7,#00H
056A         ?C0111:
056A EF                MOV     A,R7
056B 602C              JZ      ?C0109
                                           ; SOURCE LINE # 943
                                           ; SOURCE LINE # 944
056D 900000      E     MOV     DPTR,#RTC_currentTimeDate+01H
0570 E0                MOVX    A,@DPTR
0571 FF                MOV     R7,A
0572 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+01H
0575 E0                MOVX    A,@DPTR
0576 FE                MOV     R6,A
0577 EE                MOV     A,R6
0578 B50710            CJNE    A,AR7,?C0112
                                           ; SOURCE LINE # 945
                                           ; SOURCE LINE # 946
057B 900000      E     MOV     DPTR,#RTC_alarmCurStatus
057E E0                MOVX    A,@DPTR
057F FF                MOV     R7,A
0580 EF                MOV     A,R7
0581 4402              ORL     A,#02H
0583 FF                MOV     R7,A
0584 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0587 EF                MOV     A,R7
0588 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 947
0589 800E              SJMP    ?C0109
058B         ?C0112:
                                           ; SOURCE LINE # 949
                                           ; SOURCE LINE # 950
058B 900000      E     MOV     DPTR,#RTC_alarmCurStatus
058E E0                MOVX    A,@DPTR
058F FF                MOV     R7,A
0590 EF                MOV     A,R7
0591 54FD              ANL     A,#0FDH
0593 FF                MOV     R7,A
0594 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0597 EF                MOV     A,R7
0598 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 951
0599         ?C0113:
                                           ; SOURCE LINE # 952
0599         ?C0109:
                                           ; SOURCE LINE # 955
0599 900000      E     MOV     DPTR,#RTC_alarmCfgMask
059C E0                MOVX    A,@DPTR
059D FF                MOV     R7,A
059E 900000      R     MOV     DPTR,#RTC_tmp
05A1 EF                MOV     A,R7
05A2 F0                MOVX    @DPTR,A
05A3         ?C0116:
                                           ; SOURCE LINE # 958
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 41  

05A3 900000      R     MOV     DPTR,#RTC_tmp
05A6 E0                MOVX    A,@DPTR
05A7 FF                MOV     R7,A
05A8 EF                MOV     A,R7
05A9 6032              JZ      ?C0115
05AB 900000      R     MOV     DPTR,#RTC_tmp
05AE E0                MOVX    A,@DPTR
05AF FF                MOV     R7,A
05B0 900000      E     MOV     DPTR,#RTC_alarmCurStatus
05B3 E0                MOVX    A,@DPTR
05B4 FE                MOV     R6,A
05B5 EE                MOV     A,R6
05B6 5F                ANL     A,R7
05B7 FF                MOV     R7,A
05B8 900000      R     MOV     DPTR,#RTC_tmp
05BB E0                MOVX    A,@DPTR
05BC FE                MOV     R6,A
05BD EF                MOV     A,R7
05BE B50604            CJNE    A,AR6,?C0118
05C1 7F01              MOV     R7,#01H
05C3 8002              SJMP    ?C0119
05C5         ?C0118:
05C5 7F00              MOV     R7,#00H
05C7         ?C0119:
05C7 EF                MOV     A,R7
05C8 6013              JZ      ?C0115
05CA 900000      E     MOV     DPTR,#RTC_statusDateTime
05CD E0                MOVX    A,@DPTR
05CE FF                MOV     R7,A
05CF EF                MOV     A,R7
05D0 4408              ORL     A,#08H
05D2 FF                MOV     R7,A
05D3 900000      E     MOV     DPTR,#RTC_statusDateTime
05D6 EF                MOV     A,R7
05D7 F0                MOVX    @DPTR,A
05D8 900000      E     MOV     DPTR,#RTC_alarmCurStatus
05DB E4                CLR     A
05DC F0                MOVX    @DPTR,A
05DD         ?C0117:
05DD         ?C0114:
05DD         ?C0115:
                                           ; SOURCE LINE # 961
05DD 900000      E     MOV     DPTR,#RTC_intervalCfgMask
05E0 E0                MOVX    A,@DPTR
05E1 FF                MOV     R7,A
05E2 EF                MOV     A,R7
05E3 5402              ANL     A,#02H
05E5 FF                MOV     R7,A
05E6 7E00              MOV     R6,#00H
05E8 EF                MOV     A,R7
05E9 6402              XRL     A,#02H
05EB 4E                ORL     A,R6
05EC 7004              JNZ     ?C0121
05EE 7F01              MOV     R7,#01H
05F0 8002              SJMP    ?C0122
05F2         ?C0121:
05F2 7F00              MOV     R7,#00H
05F4         ?C0122:
05F4 EF                MOV     A,R7
05F5 6003              JZ      ?C0023
                                           ; SOURCE LINE # 962
                                           ; SOURCE LINE # 963
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 42  

05F7 120000      R     LCALL   RTC_EveryMinuteHandler
                                           ; SOURCE LINE # 964
05FA         ?C0120:
                                           ; SOURCE LINE # 965
05FA         ?C0023:
                                           ; SOURCE LINE # 968
05FA 900000      E     MOV     DPTR,#RTC_alarmCfgMask
05FD E0                MOVX    A,@DPTR
05FE FF                MOV     R7,A
05FF EF                MOV     A,R7
0600 5401              ANL     A,#01H
0602 FF                MOV     R7,A
0603 7E00              MOV     R6,#00H
0605 EF                MOV     A,R7
0606 6401              XRL     A,#01H
0608 4E                ORL     A,R6
0609 7004              JNZ     ?C0124
060B 7F01              MOV     R7,#01H
060D 8002              SJMP    ?C0125
060F         ?C0124:
060F 7F00              MOV     R7,#00H
0611         ?C0125:
0611 EF                MOV     A,R7
0612 602C              JZ      ?C0123
                                           ; SOURCE LINE # 969
                                           ; SOURCE LINE # 970
0614 900000      E     MOV     DPTR,#RTC_currentTimeDate
0617 E0                MOVX    A,@DPTR
0618 FF                MOV     R7,A
0619 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate
061C E0                MOVX    A,@DPTR
061D FE                MOV     R6,A
061E EE                MOV     A,R6
061F B50710            CJNE    A,AR7,?C0126
                                           ; SOURCE LINE # 971
                                           ; SOURCE LINE # 972
0622 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0625 E0                MOVX    A,@DPTR
0626 FF                MOV     R7,A
0627 EF                MOV     A,R7
0628 4401              ORL     A,#01H
062A FF                MOV     R7,A
062B 900000      E     MOV     DPTR,#RTC_alarmCurStatus
062E EF                MOV     A,R7
062F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 973
0630 800E              SJMP    ?C0123
0632         ?C0126:
                                           ; SOURCE LINE # 975
                                           ; SOURCE LINE # 976
0632 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0635 E0                MOVX    A,@DPTR
0636 FF                MOV     R7,A
0637 EF                MOV     A,R7
0638 54FE              ANL     A,#0FEH
063A FF                MOV     R7,A
063B 900000      E     MOV     DPTR,#RTC_alarmCurStatus
063E EF                MOV     A,R7
063F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 977
0640         ?C0127:
                                           ; SOURCE LINE # 978
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 43  

0640         ?C0123:
                                           ; SOURCE LINE # 981
0640 900000      E     MOV     DPTR,#RTC_alarmCfgMask
0643 E0                MOVX    A,@DPTR
0644 FF                MOV     R7,A
0645 900000      R     MOV     DPTR,#RTC_tmp
0648 EF                MOV     A,R7
0649 F0                MOVX    @DPTR,A
064A         ?C0130:
                                           ; SOURCE LINE # 982
064A 900000      R     MOV     DPTR,#RTC_tmp
064D E0                MOVX    A,@DPTR
064E FF                MOV     R7,A
064F EF                MOV     A,R7
0650 6032              JZ      ?C0129
0652 900000      R     MOV     DPTR,#RTC_tmp
0655 E0                MOVX    A,@DPTR
0656 FF                MOV     R7,A
0657 900000      E     MOV     DPTR,#RTC_alarmCurStatus
065A E0                MOVX    A,@DPTR
065B FE                MOV     R6,A
065C EE                MOV     A,R6
065D 5F                ANL     A,R7
065E FF                MOV     R7,A
065F 900000      R     MOV     DPTR,#RTC_tmp
0662 E0                MOVX    A,@DPTR
0663 FE                MOV     R6,A
0664 EF                MOV     A,R7
0665 B50604            CJNE    A,AR6,?C0132
0668 7F01              MOV     R7,#01H
066A 8002              SJMP    ?C0133
066C         ?C0132:
066C 7F00              MOV     R7,#00H
066E         ?C0133:
066E EF                MOV     A,R7
066F 6013              JZ      ?C0129
0671 900000      E     MOV     DPTR,#RTC_statusDateTime
0674 E0                MOVX    A,@DPTR
0675 FF                MOV     R7,A
0676 EF                MOV     A,R7
0677 4408              ORL     A,#08H
0679 FF                MOV     R7,A
067A 900000      E     MOV     DPTR,#RTC_statusDateTime
067D EF                MOV     A,R7
067E F0                MOVX    @DPTR,A
067F 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0682 E4                CLR     A
0683 F0                MOVX    @DPTR,A
0684         ?C0131:
0684         ?C0128:
0684         ?C0129:
                                           ; SOURCE LINE # 985
0684 900000      E     MOV     DPTR,#RTC_intervalCfgMask
0687 E0                MOVX    A,@DPTR
0688 FF                MOV     R7,A
0689 EF                MOV     A,R7
068A 5401              ANL     A,#01H
068C FF                MOV     R7,A
068D 7E00              MOV     R6,#00H
068F EF                MOV     A,R7
0690 6401              XRL     A,#01H
0692 4E                ORL     A,R6
C51 COMPILER V9.51   RTC_INT                                                               05/31/2014 14:22:11 PAGE 44  

0693 7004              JNZ     ?C0135
0695 7F01              MOV     R7,#01H
0697 8002              SJMP    ?C0136
0699         ?C0135:
0699 7F00              MOV     R7,#00H
069B         ?C0136:
069B EF                MOV     A,R7
069C 6003              JZ      ?C0137
                                           ; SOURCE LINE # 986
                                           ; SOURCE LINE # 987
069E 120000      R     LCALL   RTC_EverySecondHandler
                                           ; SOURCE LINE # 988
06A1         ?C0134:
                                           ; SOURCE LINE # 990
06A1         ?C0137:
06A1 D007              POP     AR7
06A3 D006              POP     AR6
06A5 D005              POP     AR5
06A7 D004              POP     AR4
06A9 D003              POP     AR3
06AB D002              POP     AR2
06AD D001              POP     AR1
06AF D000              POP     AR0
06B1 D0D0              POP     PSW
06B3 D000        E     POP     ?C?XPAGE1SFR
06B5 D086              POP     DPS
06B7 D084              POP     DPL1
06B9 D085              POP     DPH1
06BB D082              POP     DPL
06BD D083              POP     DPH
06BF D0F0              POP     B
06C1 D0E0              POP     ACC
06C3 32                RETI    
             ; FUNCTION RTC_ISR (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2032    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      1    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
