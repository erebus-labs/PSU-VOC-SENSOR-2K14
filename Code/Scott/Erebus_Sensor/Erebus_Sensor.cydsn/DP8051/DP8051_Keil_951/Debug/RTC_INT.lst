C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE RTC_INT
OBJECT MODULE PLACED IN .\DP8051\DP8051_Keil_951\Debug\RTC_INT.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\3.0\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -.\Generated_Source\PSoC3\RTC_INT.c NOIV LARGE MODDP2 OMF2 VB(1) PR(.\DP8051\DP8051_Keil_951\Debug\RTC_INT.lst) CD DB NOI
                    -P OT(0,SIZE) DF(DEBUG) INCDIR(.,.\Generated_Source\PSoC3) OJ(.\DP8051\DP8051_Keil_951\Debug\RTC_INT.obj)

line level    source

   1          /*******************************************************************************
   2          * File Name: RTC_INT.c
   3          * Version 2.0
   4          *
   5          * Description:
   6          *  This file contains the Interrupt Service Routine (ISR) for the RTC component.
   7          *  This interrupt routine has entry pointes to overflow on time or date.
   8          *
   9          ********************************************************************************
  10          * Copyright 2008-2013, Cypress Semiconductor Corporation.  All rights reserved.
  11          * You may use this file only in accordance with the license, terms, conditions,
  12          * disclaimers, and limitations in the end user license agreement accompanying
  13          * the software package with which this file was provided.
  14          *******************************************************************************/
  15          
  16          #include "RTC.h"
  17          #include "CyLib.h"
  18          
  19          /* Function Prototypes */
  20          static void RTC_EverySecondHandler(void);
  21          static void RTC_EveryMinuteHandler(void);
  22          static void RTC_EveryHourHandler(void);
  23          static void RTC_EveryDayHandler(void);
  24          static void RTC_EveryWeekHandler(void);
  25          static void RTC_EveryMonthHandler(void);
  26          static void RTC_EveryYearHandler(void);
  27          
  28          
  29          /*******************************************************************************
  30          *  Place your includes, defines and code here
  31          *******************************************************************************/
  32          /* `#START RTC_ISR_DEFINITION` */
  33          #include "Globals.h"
  34          #include "Macros.h"
  35          /* `#END` */
  36          
  37          
  38          /*******************************************************************************
  39          * Function Name:   RTC_EverySecondHandler
  40          ********************************************************************************
  41          *
  42          * Summary:
  43          *  This function is called every second.
  44          *
  45          * Parameters:
  46          *  None.
  47          *
  48          * Return:
  49          *  None.
  50          *
  51          *******************************************************************************/
  52          static void RTC_EverySecondHandler(void)
  53          {
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 2   

  54   1          /*  Place your every second handler code here. */
  55   1          /* `#START EVERY_SECOND_HANDLER_CODE` */
  56   1          
  57   1          if (sample_unit == SAMPLE_SEC && sample_enable){
  58   2              ++sample_int_count;
  59   2      
  60   2              if (sample_int_count == sample_interval)
  61   2              {
  62   3                  Sample_waiting = 1;
  63   3                  sample_int_count = 0;
  64   3              }
  65   2          }
  66   1              
  67   1          ++low_batt_blink_count;
  68   1          if ((low_batt_blink_count >= LOWBATT_BLINK_INTERVAL) && low_power_flag && !mem_full_flag){
  69   2              low_batt_blink_count = 0;
  70   2              LowPowerBlink_waiting = 1;
  71   2          }
  72   1      
  73   1          
  74   1          /* `#END` */
  75   1      }
  76          
  77          
  78          /*******************************************************************************
  79          * Function Name:   RTC_EveryMinuteHandler
  80          ********************************************************************************
  81          *
  82          * Summary:
  83          *  This function is called every minute.
  84          *
  85          * Parameters:
  86          *  None.
  87          *
  88          * Return:
  89          *  None.
  90          *
  91          *******************************************************************************/
  92          static void RTC_EveryMinuteHandler(void)
  93          {
  94   1          /*  Place your every minute handler code here. */
  95   1          /* `#START EVERY_MINUTE_HANDLER_CODE` */
  96   1          
  97   1          if (sample_unit == SAMPLE_MIN && sample_enable){
  98   2              ++sample_int_count;
  99   2      
 100   2              if (sample_int_count == sample_interval)
 101   2              {
 102   3                  Sample_waiting = 1;
 103   3                  sample_int_count = 0;
 104   3              }
 105   2          }
 106   1          
 107   1          ++battery_check_count;
 108   1          if (battery_check_count == BATT_CHECK_INTERVAL){
 109   2              battery_check_count = 0;
 110   2              BatteryCheck_waiting = 1;
 111   2          }
 112   1          
 113   1          /* `#END` */
 114   1      }
 115          
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 3   

 116          
 117          /*******************************************************************************
 118          * Function Name:   RTC_EveryHourHandler
 119          ********************************************************************************
 120          *
 121          * Summary:
 122          *  This function is called every hour.
 123          *
 124          * Parameters:
 125          *  None.
 126          *
 127          * Return:
 128          *  None.
 129          *
 130          *******************************************************************************/
 131          static void RTC_EveryHourHandler(void)
 132          {
 133   1          /*  Place your every hour handler code here. */
 134   1          /* `#START EVERY_HOUR_HANDLER_CODE` */
 135   1          if (sample_enable){
 136   2              ++sample_int_count;
 137   2      
 138   2              if (sample_int_count == sample_interval)
 139   2              {
 140   3                  Sample_waiting = 1;
 141   3                  sample_int_count = 0;
 142   3              }
 143   2          }
 144   1          /* `#END` */
 145   1      }
 146          
 147          
 148          /*******************************************************************************
 149          * Function Name:   RTC_EveryDayHandler
 150          ********************************************************************************
 151          *
 152          * Summary:
 153          *  This function is called every day.
 154          *
 155          * Parameters:
 156          *  None.
 157          *
 158          * Return:
 159          *  None.
 160          *
 161          *******************************************************************************/
 162          static void RTC_EveryDayHandler(void)
 163          {
 164   1          /*  Place your everyday handler code here. */
 165   1          /* `#START EVERY_DAY_HANDLER_CODE` */
 166   1          if (sample_enable){
 167   2              ++sample_int_count;
 168   2      
 169   2              if (sample_int_count == sample_interval)
 170   2              {
 171   3                  Sample_waiting = 1;
 172   3                  sample_int_count = 0;
 173   3              }
 174   2          }
 175   1          /* `#END` */
 176   1      }
 177          
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 4   

 178          
 179          /*******************************************************************************
 180          * Function Name:   RTC_EveryWeekHandler
 181          ********************************************************************************
 182          *
 183          * Summary:
 184          *  This function is called every week.
 185          *
 186          * Parameters:
 187          *  None.
 188          *
 189          * Return:
 190          *  None.
 191          *
 192          *******************************************************************************/
 193          static void RTC_EveryWeekHandler(void)
 194          {
 195   1          /*  Place your every week handler code here. */
 196   1          /* `#START EVERY_WEEK_HANDLER_CODE` */
 197   1          /* `#END` */
 198   1      }
 199          
 200          
 201          /*******************************************************************************
 202          * Function Name:   RTC_EveryMonthHandler
 203          ********************************************************************************
 204          *
 205          * Summary:
 206          *  This function is called every month.
 207          *
 208          * Parameters:
 209          *  None.
 210          *
 211          * Return:
 212          *  None.
 213          *
 214          *******************************************************************************/
 215          static void RTC_EveryMonthHandler(void)
 216          {
 217   1          /*  Place your every month handler code here. */
 218   1          /* `#START EVERY_MONTH_HANDLER_CODE` */
 219   1          /* `#END` */
 220   1      }
 221          
 222          
 223          /*******************************************************************************
 224          * Function Name:   RTC_EveryYearHandler
 225          ********************************************************************************
 226          *
 227          * Summary:
 228          *  This function is called every year.
 229          *
 230          * Parameters:
 231          *  None.
 232          *
 233          * Return:
 234          *  None.
 235          *
 236          *******************************************************************************/
 237          static void RTC_EveryYearHandler(void)
 238          {
 239   1          /*  Place your every year handler code here. */
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 5   

 240   1          /* `#START EVERY_YEAR_HANDLER_CODE` */
 241   1          /* `#END` */
 242   1      }
 243          
 244          
 245          /*******************************************************************************
 246          * Function Name: RTC_ISR
 247          ********************************************************************************
 248          *
 249          * Summary:
 250          *  This ISR is executed on 1PPS (one pulse per second) event.
 251          *  Global interrupt must be enabled to invoke this ISR.
 252          *  This interrupt trigs every second.
 253          *
 254          * Parameters:
 255          *  None.
 256          *
 257          * Return:
 258          *  None.
 259          *
 260          * Global variables:
 261          * RTC_currentTimeDate, RTC_dstTimeDateStart,
 262          *  RTC_dstTimeDateStop, RTC_dstTimeDateStart,
 263          *  RTC_alarmCfgTimeDate, RTC_statusDateTime,
 264          *  RTC_dstStartStatus, RTC_dstStartStatus,
 265          *  RTC_dstStopStatus, RTC_alarmCurStatus: global
 266          *  variables are used for the time/date, DST and alarm update procedure.
 267          *
 268          *  RTC_dstTimeDateStart and RTC_currentTimeDate:
 269          *  are modified with the updated values.
 270          *
 271          *  RTC_statusDateTime, RTC_dstStartStatus,
 272          *  RTC_dstStartStatus, RTC_dstStopStatus,
 273          *  RTC_alarmCurStatus: global variables could be modified while
 274          *  current time/date is updated.
 275          *
 276          * Side Effects:
 277          *  Clears all interrupt status bits (react_int, limact_int, onepps_int, ctw_int,
 278          *  and  ftw_int) in Power Manager Interrupt Status Register. If an interrupt
 279          *  gets generated at the same time as a clear, the bit will remain set (which
 280          *  causes another interrupt).
 281          *
 282          *******************************************************************************/
 283          CY_ISR(RTC_ISR)
 284          {
 285   1          uint8 RTC_tmp;
 286   1      
 287   1          /* Clear OPPS interrupt status flag */
 288   1          (void) CyPmReadStatus(CY_PM_ONEPPS_INT);
 289   1      
 290   1          /* Increment seconds counter */
 291   1          RTC_currentTimeDate.Sec++;
 292   1      
 293   1          /* Check if minute elapsed */
 294   1          if(RTC_currentTimeDate.Sec > RTC_MINUTE_ELAPSED)
 295   1          {
 296   2              /* Inc Min */
 297   2              RTC_currentTimeDate.Min++;
 298   2      
 299   2              /* Clear Sec */
 300   2              RTC_currentTimeDate.Sec = 0u;
 301   2      
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 6   

 302   2              if(RTC_currentTimeDate.Min > RTC_HOUR_ELAPSED)
 303   2              {
 304   3                  /* Inc HOUR */
 305   3                  RTC_currentTimeDate.Hour++;
 306   3      
 307   3                  /* Clear Min */
 308   3                  RTC_currentTimeDate.Min = 0u;
 309   3      
 310   3                  /* Day roll over */
 311   3                  if(RTC_currentTimeDate.Hour > RTC_DAY_ELAPSED)
 312   3                  {
 313   4                      /* Inc DayOfMonth */
 314   4                      RTC_currentTimeDate.DayOfMonth++;
 315   4      
 316   4                      /* Clear Hour */
 317   4                      RTC_currentTimeDate.Hour = 0u;
 318   4      
 319   4                      /* Inc DayOfYear */
 320   4                      RTC_currentTimeDate.DayOfYear++;
 321   4      
 322   4                      /* Inc DayOfWeek */
 323   4                      RTC_currentTimeDate.DayOfWeek++;
 324   4      
 325   4                      /* Check DayOfWeek */
 326   4                      if(RTC_currentTimeDate.DayOfWeek > RTC_WEEK_ELAPSED)
 327   4                      {
 328   5                          /* start new week */
 329   5                          RTC_currentTimeDate.DayOfWeek = 1u;
 330   5                      }
 331   4      
 332   4                      /* Day of month roll over.
 333   4                      * Check if day of month greater than 29 in February of leap year or
 334   4                      * if day of month greater than 28 NOT in February of NON leap year or
 335   4                      * if day of month greater than it should be in every month in non leap year
 336   4                      */
 337   4                      if(((0u != (RTC_statusDateTime & RTC_STATUS_LY)) &&
 338   4                          (RTC_currentTimeDate.Month == RTC_FEBRUARY)  &&
 339   4                          (RTC_currentTimeDate.DayOfMonth >
 340   4                                   (RTC_daysInMonths[RTC_currentTimeDate.Month - 1u] + 1u))) ||
 341   4                         ((0u != (RTC_statusDateTime & RTC_STATUS_LY))  &&
 342   4                          (RTC_currentTimeDate.Month != RTC_FEBRUARY) &&
 343   4                          (RTC_currentTimeDate.DayOfMonth >
 344   4                                          RTC_daysInMonths[RTC_currentTimeDate.Month - 1u])) ||
 345   4                         ((0u == (RTC_statusDateTime & RTC_STATUS_LY))  &&
 346   4                          (RTC_currentTimeDate.DayOfMonth >
 347   4                                          RTC_daysInMonths[RTC_currentTimeDate.Month - 1u])))
 348   4                      {
 349   5                          /* Inc Month */
 350   5                          RTC_currentTimeDate.Month++;
 351   5      
 352   5                          /* Set first day of month */
 353   5                          RTC_currentTimeDate.DayOfMonth = 1u;
 354   5      
 355   5                          /* Year roll over */
 356   5                          if(RTC_currentTimeDate.Month > RTC_YEAR_ELAPSED)
 357   5                          {
 358   6                              /* Inc Year */
 359   6                              RTC_currentTimeDate.Year++;
 360   6      
 361   6                              /* Set first month of year */
 362   6                              RTC_currentTimeDate.Month = 1u;
 363   6      
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 7   

 364   6                              /* Set first day of year */
 365   6                              RTC_currentTimeDate.DayOfYear = 1u;
 366   6      
 367   6                              /* Is this year leap */
 368   6                              if(1u == RTC_LEAP_YEAR(RTC_currentTimeDate.Year))
 369   6                              {
 370   7                                  /* Set leap year flag */
 371   7                                  RTC_statusDateTime |= RTC_STATUS_LY;
 372   7                              }
 373   6                              else    /* not leap year */
 374   6                              {
 375   7                                  /* Clear leap year */
 376   7                                  RTC_statusDateTime &= (uint8)(~RTC_STATUS_LY);
 377   7                              }
 378   6      
 379   6                              /* Alarm YEAR */
 380   6                              if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
 381   6                                                                   RTC_ALARM_YEAR_MASK))
 382   6                              {
 383   7                                  /* Years match */
 384   7                                  if(RTC_alarmCfgTimeDate.Year == RTC_currentTimeDate.Year)
 385   7                                  {
 386   8                                      /* Rise year alarm */
 387   8                                      RTC_alarmCurStatus |= RTC_ALARM_YEAR_MASK;
 388   8                                  }
 389   7                                  else    /* Years do not match */
 390   7                                  {
 391   8                                      /* Clear year alarm */
 392   8                                      RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_YEAR_MASK);
 393   8                                  }
 394   7                              } /* do not alarm year */
 395   6      
 396   6                              /* Set Alarm flag event */
 397   6                              RTC_tmp = RTC_alarmCfgMask;
 398   6                              RTC_SET_ALARM(RTC_tmp,
 400   6                                                         RTC_alarmCurStatus,
 400   6                                                         RTC_statusDateTime);
 401   6      
 402   6                              /* Every Year */
 403   6                              if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask,
 404   6                                                                   RTC_INTERVAL_YEAR_MASK))
 405   6                              {
 406   7                                  RTC_EveryYearHandler();
 407   7                              }
 408   6      
 409   6                          } /* Month > 12 */
 410   5      
 411   5                          /* Alarm MONTH */
 412   5                          if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
 413   5                                                               RTC_ALARM_MONTH_MASK))
 414   5                          {
 415   6                              if(RTC_alarmCfgTimeDate.Month == RTC_currentTimeDate.Month)
 416   6                              {
 417   7                                  /* Set month alarm */
 418   7                                  RTC_alarmCurStatus |= RTC_ALARM_MONTH_MASK;
 419   7                              }
 420   6                              else
 421   6                              {
 422   7                                  /* Clear month alarm */
 423   7                                  RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_MONTH_MASK);
 424   7                              }
 425   6                          }   /* Month alarm is masked */
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 8   

 426   5      
 427   5                          #if (1u == RTC_DST_FUNC_ENABLE)
                                      if(RTC_dstTimeDateStop.Month == RTC_currentTimeDate.Month)
                                      {
                                          RTC_dstStopStatus |= RTC_DST_MONTH;
                                      }
                                      else
                                      {
                                          RTC_dstStopStatus &= (uint8)(~RTC_DST_MONTH);
                                      }
              
                                      if(RTC_dstTimeDateStart.Month == RTC_currentTimeDate.Month)
                                      {
                                          RTC_dstStartStatus |= RTC_DST_MONTH;
                                      }
                                      else
                                      {
                                          RTC_dstStartStatus &= (uint8)(~RTC_DST_MONTH);
                                      }
                                  #endif /* 1u == RTC_DST_FUNC_ENABLE */
 446   5      
 447   5                          /* Set Alarm flag event */
 448   5                          RTC_tmp = RTC_alarmCfgMask;
 449   5                          RTC_SET_ALARM(RTC_tmp,
 451   5                                                     RTC_alarmCurStatus,
 451   5                                                     RTC_statusDateTime);
 452   5      
 453   5                          /* Every Month */
 454   5                          if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask,
 455   5                                                               RTC_INTERVAL_MONTH_MASK))
 456   5                          {
 457   6                              RTC_EveryMonthHandler();
 458   6                          }
 459   5                      }   /* Day roll over */
 460   4      
 461   4                      /* Alarm DAYOFWEEK */
 462   4                      if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
 463   4                                                           RTC_ALARM_DAYOFWEEK_MASK))
 464   4                      {
 465   5                          if(RTC_alarmCfgTimeDate.DayOfWeek == RTC_currentTimeDate.DayOfWeek)
 466   5                          {
 467   6                              /* Set day of week alarm */
 468   6                              RTC_alarmCurStatus |= RTC_ALARM_DAYOFWEEK_MASK;
 469   6                          }
 470   5                          else
 471   5                          {
 472   6                              /* Clear day of week alarm */
 473   6                              RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_DAYOFWEEK_MASK);
 474   6                          }
 475   5                      }   /* Day of week alarm is masked */
 476   4      
 477   4                      /* Alarm DAYOFYEAR */
 478   4                      if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
 479   4                                                           RTC_ALARM_DAYOFYEAR_MASK))
 480   4                      {
 481   5                          if(RTC_alarmCfgTimeDate.DayOfYear == RTC_currentTimeDate.DayOfYear)
 482   5                          {
 483   6                              /* Set day of year alarm */
 484   6                              RTC_alarmCurStatus |= RTC_ALARM_DAYOFYEAR_MASK;
 485   6                          }
 486   5                          else
 487   5                          {
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 9   

 488   6                              /* Clear day of year alarm */
 489   6                              RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_DAYOFYEAR_MASK);
 490   6                          }
 491   5                      }   /* Day of year alarm is masked */
 492   4      
 493   4                      /* Alarm DAYOFMONTH */
 494   4                      if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
 495   4                               RTC_ALARM_DAYOFMONTH_MASK))
 496   4                      {
 497   5                          if(RTC_alarmCfgTimeDate.DayOfMonth == RTC_currentTimeDate.DayOfMonth)
 498   5                          {
 499   6                              /* Set day of month alarm */
 500   6                              RTC_alarmCurStatus |= RTC_ALARM_DAYOFMONTH_MASK;
 501   6                          }
 502   5                          else
 503   5                          {
 504   6                              /* Clear day of month alarm */
 505   6                              RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_DAYOFMONTH_MASK);
 506   6                          }
 507   5                      }   /* Day of month alarm is masked */
 508   4      
 509   4                      #if (1u == RTC_DST_FUNC_ENABLE)
                                  if(RTC_dstTimeDateStop.DayOfMonth == RTC_currentTimeDate.DayOfMonth)
                                  {
                                      RTC_dstStopStatus |= RTC_DST_DAYOFMONTH;
                                  }
                                  else
                                  {
                                      RTC_dstStopStatus &= (uint8)(~RTC_DST_DAYOFMONTH);
                                  }
              
                                  if(RTC_dstTimeDateStart.DayOfMonth == RTC_currentTimeDate.DayOfMonth)
                                  {
                                      RTC_dstStartStatus |= RTC_DST_DAYOFMONTH;
                                  }
                                  else
                                  {
                                      RTC_dstStartStatus &= (uint8)(~RTC_DST_DAYOFMONTH);
                                  }
                              #endif /* 1u == RTC_DST_FUNC_ENABLE */
 528   4      
 529   4                      /* Set Alarm flag event */
 530   4                      RTC_tmp = RTC_alarmCfgMask;
 531   4                      RTC_SET_ALARM(RTC_tmp,
 533   4                                                 RTC_alarmCurStatus,
 533   4                                                 RTC_statusDateTime);
 534   4      
 535   4                      /* Every Day */
 536   4                      if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask,
 537   4                               RTC_INTERVAL_DAY_MASK))
 538   4                      {
 539   5                          RTC_EveryDayHandler();
 540   5                      }
 541   4      
 542   4                      if(1u == RTC_currentTimeDate.DayOfWeek)
 543   4                      {
 544   5                          /* Every Week */
 545   5                          if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask,
 546   5                                                               RTC_INTERVAL_WEEK_MASK))
 547   5                          {
 548   6                             RTC_EveryWeekHandler();
 549   6                          }
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 10  

 550   5                      }
 551   4      
 552   4                  } /* End of day roll over */
 553   3      
 554   3                  /* Status set PM/AM flag */
 555   3                  if(RTC_currentTimeDate.Hour < RTC_HALF_OF_DAY_ELAPSED)
 556   3                  {
 557   4                      /* AM Hour 00:00-11:59, flag zero */
 558   4                      RTC_statusDateTime &= (uint8)(~RTC_STATUS_AM_PM);
 559   4                  }
 560   3                  else
 561   3                  {
 562   4                      /* PM Hour 12:00-23:59, flag set */
 563   4                      RTC_statusDateTime |= RTC_STATUS_AM_PM;
 564   4                  }
 565   3      
 566   3                  #if (1u == RTC_DST_FUNC_ENABLE)
                              if(RTC_dstTimeDateStop.Hour == RTC_currentTimeDate.Hour)
                              {
                                  RTC_dstStopStatus |= RTC_DST_HOUR;
                              }
                              else
                              {
                                  RTC_dstStopStatus &= (uint8)(~RTC_DST_HOUR);
                              }
              
                              if(RTC_dstTimeDateStart.Hour == RTC_currentTimeDate.Hour)
                              {
                                  RTC_dstStartStatus |= RTC_DST_HOUR;
                              }
                              else
                              {
                              RTC_dstStartStatus &= (uint8)(~RTC_DST_HOUR);
                              }
              
                              /* DST Enable ? */
                              if(0u != RTC_IS_BIT_SET(RTC_dstModeType, RTC_DST_ENABLE))
                              {
                                  if(0u != RTC_IS_BIT_SET(RTC_statusDateTime, RTC_STATUS_DST))
                                  {
                                      if(0u != RTC_IS_BIT_SET(RTC_dstStopStatus, RTC_DST_HOUR |
                                                                     RTC_DST_DAYOFMONTH | RTC_DST_MONTH))
                                      {
                                          /* Substruct from current value of minutes, number of minutes
                                          * in DST offset which is out of complete hour
                                          */
                                          RTC_currentTimeDate.Min -=
                                                              RTC_dstOffsetMin % (RTC_HOUR_ELAPSED + 1u);
              
                                          /* Is minute value negative? */
                                          if(RTC_currentTimeDate.Min > RTC_HOUR_ELAPSED)
                                          {
                                              /* Convert to the positive.
                                              * HOUR_ELAPSED -     (~currentTimeDate.Min    ) ==
                                              * HOUR_ELAPSED + 1 - (~currentTimeDate.Min + 1)
                                              */
                                              RTC_currentTimeDate.Min = RTC_HOUR_ELAPSED -
                                                                           ((uint8)(~RTC_currentTimeDate.Min));
              
                                              RTC_currentTimeDate.Hour--;
                                          }
              
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 11  

                                          RTC_currentTimeDate.Hour -= RTC_dstOffsetMin /
                                                                                   (RTC_HOUR_ELAPSED + 1u);
              
                                          /* Day roll over
                                          * Is hour value negative? */
                                          if(RTC_currentTimeDate.Hour > RTC_DAY_ELAPSED)
                                          {
                                              /* Convert to the positive.
                                              * DAY_ELAPSED - (~currentTimeDate.Hour) ==
                                              * DAY_ELAPSED + 1 - (~currentTimeDate.Hour + 1)
                                              */
                                              RTC_currentTimeDate.Hour = RTC_DAY_ELAPSED -
                                                                            ((uint8)(~RTC_currentTimeDate.Hour));
              
                                              /* Status set PM/AM flag */
                                              if(RTC_currentTimeDate.Hour < RTC_HALF_OF_DAY_ELAPSED)
                                              {
                                                  /* AM Hour 00:00-11:59, flag zero */
                                                  RTC_statusDateTime &= (uint8)(~RTC_STATUS_AM_PM);
                                              }
                                              else
                                              {
                                                  /* PM Hour 12:00-23:59, flag set */
                                                  RTC_statusDateTime |= RTC_STATUS_AM_PM;
                                              }
              
                                              RTC_currentTimeDate.DayOfMonth--;
                                              RTC_currentTimeDate.DayOfYear--;
                                              RTC_currentTimeDate.DayOfWeek--;
              
                                              if(0u == RTC_currentTimeDate.DayOfWeek)
                                              {
                                                  RTC_currentTimeDate.DayOfWeek = RTC_DAYS_IN_WEEK;
                                              }
              
                                              if(0u == RTC_currentTimeDate.DayOfMonth)
                                              {
                                                  RTC_currentTimeDate.Month--;
                                                  if(0u == RTC_currentTimeDate.Month)
                                                  {
                                                      RTC_currentTimeDate.Month = RTC_DECEMBER;
              
                                                      RTC_currentTimeDate.DayOfMonth =
                                                          RTC_daysInMonths[RTC_currentTimeDate.Month - 1u];
              
                                                      RTC_currentTimeDate.Year--;
              
                                                      if(1u == RTC_LEAP_YEAR(RTC_currentTimeDate.Year))
                                                      {
                                                          /* LP - true, else - false */
                                                          RTC_statusDateTime |= RTC_STATUS_LY;
                                                          RTC_currentTimeDate.DayOfYear =
                                                                                                  RTC_DAYS_IN_LEAP_YEAR;
                                                      }
                                                      else
                                                      {
                                                          RTC_statusDateTime &= (uint8)(~RTC_STATUS_LY);
                                                          RTC_currentTimeDate.DayOfYear = RTC_DAYS_IN_YEAR;
                                                      }
                                                      RTC_EveryYearHandler();
                                                  }
                                                  else
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 12  

                                                  {
                                                      /* Day of month roll over.
                                                      * Check if day of month February 29 of leap year
                                                      */
                                                      if((0u != (RTC_statusDateTime & RTC_STATUS_LY)) &&
                                                          (RTC_currentTimeDate.Month == RTC_FEBRUARY))
                                                      {
                                                          RTC_currentTimeDate.DayOfMonth =
                                                          RTC_daysInMonths[RTC_currentTimeDate.Month - 1u]
                                                          + 1u;
                                                      }
                                                      else
                                                      {
                                                          RTC_currentTimeDate.DayOfMonth =
                                                          RTC_daysInMonths[RTC_currentTimeDate.Month - 1u];
                                                      }
                                                  }
                                                  RTC_EveryMonthHandler();
                                              }
                                              RTC_EveryDayHandler();
                                          }
                                          RTC_statusDateTime &= (uint8)(~RTC_STATUS_DST);
                                          RTC_dstStopStatus = 0u;
                                      }
                                  }
                                  else
                                  {
                                      if(0u != RTC_IS_BIT_SET(RTC_dstStartStatus,
                                                                    (RTC_DST_HOUR | RTC_DST_DAYOFMONTH |
                                                                     RTC_DST_MONTH)))
                                      {
                                          /* Add Hour and Min */
                                          RTC_currentTimeDate.Min +=
                                                              RTC_dstOffsetMin % (RTC_HOUR_ELAPSED + 1u);
              
                                          if(RTC_currentTimeDate.Min > RTC_HOUR_ELAPSED)
                                          {
                                              /* Adjust Min */
                                              RTC_currentTimeDate.Min -= (RTC_HOUR_ELAPSED + 1u);
                                              RTC_currentTimeDate.Hour++;
                                          }
              
                                          RTC_currentTimeDate.Hour += RTC_dstOffsetMin /
                                                                                   (RTC_HOUR_ELAPSED + 1u);
              
                                          if(RTC_currentTimeDate.Hour > RTC_DAY_ELAPSED)
                                          {
                                              /* Adjust hour, add day */
                                              RTC_currentTimeDate.Hour -= (RTC_DAY_ELAPSED + 1u);
              
                                              /* Status set PM/AM flag */
                                              if(RTC_currentTimeDate.Hour < RTC_HALF_OF_DAY_ELAPSED)
                                              {
                                                  /* AM Hour 00:00-11:59, flag zero */
                                                  RTC_statusDateTime &= (uint8)(~RTC_STATUS_AM_PM);
                                              }
                                              else
                                              {
                                                  /* PM Hour 12:00-23:59, flag set */
                                                  RTC_statusDateTime |= RTC_STATUS_AM_PM;
                                              }
              
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 13  

                                              RTC_currentTimeDate.DayOfMonth++;
                                              RTC_currentTimeDate.DayOfYear++;
                                              RTC_currentTimeDate.DayOfWeek++;
              
                                              if(RTC_currentTimeDate.DayOfWeek > RTC_WEEK_ELAPSED)
                                              {
                                                  RTC_currentTimeDate.DayOfWeek = 1u;
                                              }
              
                                              /* Day of month roll over.
                                              * Check if day of month greater than 29 in February of leap year or
                                              * if day of month greater than 28 NOT in February of NON leap year or
                                              * if day of month greater than it should be in every month in non leap yea
             -r
                                              */
                                              if(((0u != (RTC_statusDateTime & RTC_STATUS_LY)) &&
                                                  (RTC_currentTimeDate.Month == RTC_FEBRUARY)  &&
                                                  (RTC_currentTimeDate.DayOfMonth >
                                                (RTC_daysInMonths[RTC_currentTimeDate.Month - 1u] + 1u))) ||
                                                 ((0u != (RTC_statusDateTime & RTC_STATUS_LY)) &&
                                                  (RTC_currentTimeDate.Month != RTC_FEBRUARY)  &&
                                                  (RTC_currentTimeDate.DayOfMonth >
                                                   RTC_daysInMonths[RTC_currentTimeDate.Month - 1u])) ||
                                                 ((0u == (RTC_statusDateTime & RTC_STATUS_LY)) &&
                                                  (RTC_currentTimeDate.DayOfMonth >
                                                   RTC_daysInMonths[RTC_currentTimeDate.Month - 1u])))
                                              {
                                                  RTC_currentTimeDate.Month++;
                                                  RTC_currentTimeDate.DayOfMonth = 1u;
                                                  if(RTC_currentTimeDate.Month > RTC_YEAR_ELAPSED)
                                                  {
                                                      RTC_currentTimeDate.Month = RTC_JANUARY;
                                                      RTC_currentTimeDate.Year++;
              
                                                      if(1u == RTC_LEAP_YEAR(RTC_currentTimeDate.Year))
                                                      {
                                                          /* LP - true, else - false */
                                                          RTC_statusDateTime |= RTC_STATUS_LY;
                                                      }
                                                      else
                                                      {
                                                          RTC_statusDateTime &= (uint8)(~RTC_STATUS_LY);
                                                      }
                                                      RTC_currentTimeDate.DayOfYear = 1u;
              
                                                      RTC_EveryYearHandler();
                                                  }
                                                  RTC_EveryMonthHandler();
                                              }
                                              RTC_EveryDayHandler();
                                          }
                                          RTC_statusDateTime |= RTC_STATUS_DST;
                                          RTC_dstStartStatus = 0u;
              
                                          /* Month */
                                          if(RTC_dstTimeDateStop.Month == RTC_currentTimeDate.Month)
                                          {
                                              RTC_dstStopStatus |= RTC_DST_MONTH;
                                          }
                                          else
                                          {
                                              RTC_dstStopStatus &= (uint8)(~RTC_DST_MONTH);
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 14  

                                          }
              
                                          /* DayOfMonth */
                                          if(RTC_dstTimeDateStop.DayOfMonth ==
                                                                                          RTC_currentTimeDate.DayOfMonth
             -)
                                          {
                                              RTC_dstStopStatus |= RTC_DST_DAYOFMONTH;
                                          }
                                          else
                                          {
                                              RTC_dstStopStatus &= (uint8)(~RTC_DST_DAYOFMONTH);
                                          }
                                      }
                                  }
              
                                  /* Alarm DAYOFWEEK */
                                  if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
                                                                       RTC_ALARM_DAYOFWEEK_MASK))
                                  {
                                      if(RTC_alarmCfgTimeDate.DayOfWeek == RTC_currentTimeDate.DayOfWeek)
                                      {
                                          RTC_alarmCurStatus |= RTC_ALARM_DAYOFWEEK_MASK;
                                      }
                                      else
                                      {
                                          RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_DAYOFWEEK_MASK);
                                      }
                                  }
              
                                  /* Alarm DAYOFYEAR */
                                  if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
                                                                       RTC_ALARM_DAYOFYEAR_MASK))
                                  {
                                      if(RTC_alarmCfgTimeDate.DayOfYear == RTC_currentTimeDate.DayOfYear)
                                      {
                                          RTC_alarmCurStatus |= RTC_ALARM_DAYOFYEAR_MASK;
                                      }
                                      else
                                      {
                                          RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_DAYOFYEAR_MASK);
                                      }
                                  }
              
                                  /* Alarm DAYOFMONTH */
                                  if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
                                                                       RTC_ALARM_DAYOFMONTH_MASK))
                                  {
                                      if(RTC_alarmCfgTimeDate.DayOfMonth == RTC_currentTimeDate.DayOfMonth)
                                      {
                                          RTC_alarmCurStatus |= RTC_ALARM_DAYOFMONTH_MASK;
                                      }
                                      else
                                      {
                                          RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_DAYOFMONTH_MASK);
                                      }
                                  }
              
                                  /* Alarm MONTH */
                                  if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
                                                                       RTC_ALARM_MONTH_MASK))
                                  {
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 15  

                                      if(RTC_alarmCfgTimeDate.Month == RTC_currentTimeDate.Month)
                                      {
                                          RTC_alarmCurStatus |= RTC_ALARM_MONTH_MASK;
                                      }
                                      else
                                      {
                                          RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_MONTH_MASK);
                                      }
                                  }
              
                                  /* Alarm YEAR */
                                  if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask,
                                                                       RTC_ALARM_YEAR_MASK))
                                  {
                                      if(RTC_alarmCfgTimeDate.Year == RTC_currentTimeDate.Year)
                                      {
                                          RTC_alarmCurStatus |= RTC_ALARM_YEAR_MASK;
                                      }
                                      else
                                      {
                                          RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_YEAR_MASK);
                                      }
                                  }
              
                                  /* Set Alarm flag event */
                                  RTC_tmp = RTC_alarmCfgMask;
                                  RTC_SET_ALARM(RTC_tmp,
                                                             RTC_alarmCurStatus,
                                                             RTC_statusDateTime);
                              }
                          #endif /* 1u == RTC_DST_FUNC_ENABLE */
 889   3      
 890   3                  /* Alarm HOUR */
 891   3                  if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask, RTC_ALARM_HOUR_MASK))
 892   3                  {
 893   4                      if(RTC_alarmCfgTimeDate.Hour == RTC_currentTimeDate.Hour)
 894   4                      {
 895   5                          RTC_alarmCurStatus |= RTC_ALARM_HOUR_MASK;
 896   5                      }
 897   4                      else
 898   4                      {
 899   5                          RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_HOUR_MASK);
 900   5                      }
 901   4                  }
 902   3      
 903   3                  /* Set Alarm flag event */
 904   3                  RTC_tmp = RTC_alarmCfgMask;
 905   3                  RTC_SET_ALARM(RTC_tmp,
 907   3                                             RTC_alarmCurStatus,
 907   3                                             RTC_statusDateTime);
 908   3      
 909   3                  /* Every Hour */
 910   3                  if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask, RTC_INTERVAL_HOUR_MASK))
 911   3                  {
 912   4                      RTC_EveryHourHandler();
 913   4                  }
 914   3              } /* Min > 59 = Hour */
 915   2      
 916   2              /* Alarm MIN */
 917   2              if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask, RTC_ALARM_MIN_MASK))
 918   2              {
 919   3                  if(RTC_alarmCfgTimeDate.Min == RTC_currentTimeDate.Min)
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 16  

 920   3                  {
 921   4                      RTC_alarmCurStatus |= RTC_ALARM_MIN_MASK;
 922   4                  }
 923   3                  else
 924   3                  {
 925   4                      RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_MIN_MASK);
 926   4                  }
 927   3              }
 928   2      
 929   2              /* Set Alarm flag event */
 930   2              RTC_tmp = RTC_alarmCfgMask;
 931   2              RTC_SET_ALARM(RTC_tmp,
 933   2                                         RTC_alarmCurStatus,
 933   2                                         RTC_statusDateTime);
 934   2      
 935   2              /* Every Min */
 936   2              if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask, RTC_INTERVAL_MIN_MASK))
 937   2              {
 938   3                  RTC_EveryMinuteHandler();
 939   3              }
 940   2          } /* Sec */
 941   1      
 942   1          /* Alarm SEC */
 943   1          if(0u != RTC_IS_BIT_SET(RTC_alarmCfgMask, RTC_ALARM_SEC_MASK))
 944   1          {
 945   2              if(RTC_alarmCfgTimeDate.Sec == RTC_currentTimeDate.Sec)
 946   2              {
 947   3                  RTC_alarmCurStatus |= RTC_ALARM_SEC_MASK;
 948   3              }
 949   2              else
 950   2              {
 951   3                  RTC_alarmCurStatus &= (uint8)(~RTC_ALARM_SEC_MASK);
 952   3              }
 953   2          }
 954   1      
 955   1          /* Set Alarm flag event */
 956   1          RTC_tmp = RTC_alarmCfgMask;
 957   1          RTC_SET_ALARM(RTC_tmp, RTC_alarmCurStatus, RTC_statusDateTime);
 958   1      
 959   1          /* Execute every second handler if needed */
 960   1          if(0u != RTC_IS_BIT_SET(RTC_intervalCfgMask, RTC_INTERVAL_SEC_MASK))
 961   1          {
 962   2              RTC_EverySecondHandler();
 963   2          }
 964   1      
 965   1      }
 966          
 967          
 968          /* [] END OF FILE */
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 17  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION RTC_EverySecondHandler (BEGIN)
                                           ; SOURCE LINE # 52
                                           ; SOURCE LINE # 53
                                           ; SOURCE LINE # 57
0000 900000      E     MOV     DPTR,#sample_unit
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 7027              JNZ     ?C0001
0008 900000      E     MOV     DPTR,#sample_enable
000B E0                MOVX    A,@DPTR
000C FF                MOV     R7,A
000D EF                MOV     A,R7
000E 601F              JZ      ?C0001
                                           ; SOURCE LINE # 58
0010 900000      E     MOV     DPTR,#sample_int_count
0013 E0                MOVX    A,@DPTR
0014 04                INC     A
0015 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 60
0016 900000      E     MOV     DPTR,#sample_interval
0019 E0                MOVX    A,@DPTR
001A FF                MOV     R7,A
001B 900000      E     MOV     DPTR,#sample_int_count
001E E0                MOVX    A,@DPTR
001F FE                MOV     R6,A
0020 EE                MOV     A,R6
0021 B5070B            CJNE    A,AR7,?C0001
                                           ; SOURCE LINE # 61
                                           ; SOURCE LINE # 62
0024 900000      E     MOV     DPTR,#Sample_waiting
0027 7401              MOV     A,#01H
0029 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 63
002A 900000      E     MOV     DPTR,#sample_int_count
002D E4                CLR     A
002E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 64
002F         ?C0002:
                                           ; SOURCE LINE # 65
002F         ?C0001:
                                           ; SOURCE LINE # 67
002F 900000      E     MOV     DPTR,#low_batt_blink_count
0032 E0                MOVX    A,@DPTR
0033 04                INC     A
0034 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 68
0035 900000      E     MOV     DPTR,#low_batt_blink_count
0038 E0                MOVX    A,@DPTR
0039 FF                MOV     R7,A
003A EF                MOV     A,R7
003B C3                CLR     C
003C 9403              SUBB    A,#03H
003E 401B              JC      ?C0004
0040 900000      E     MOV     DPTR,#low_power_flag
0043 E0                MOVX    A,@DPTR
0044 FF                MOV     R7,A
0045 EF                MOV     A,R7
0046 6013              JZ      ?C0004
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 18  

0048 900000      E     MOV     DPTR,#mem_full_flag
004B E0                MOVX    A,@DPTR
004C FF                MOV     R7,A
004D EF                MOV     A,R7
004E 700B              JNZ     ?C0004
                                           ; SOURCE LINE # 69
0050 900000      E     MOV     DPTR,#low_batt_blink_count
0053 E4                CLR     A
0054 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 70
0055 900000      E     MOV     DPTR,#LowPowerBlink_waiting
0058 7401              MOV     A,#01H
005A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 71
005B         ?C0003:
                                           ; SOURCE LINE # 75
005B         ?C0004:
005B 22                RET     
             ; FUNCTION RTC_EverySecondHandler (END)

             ; FUNCTION RTC_EveryMinuteHandler (BEGIN)
                                           ; SOURCE LINE # 92
                                           ; SOURCE LINE # 93
                                           ; SOURCE LINE # 97
0000 900000      E     MOV     DPTR,#sample_unit
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 B40127            CJNE    A,#01H,?C0005
0009 900000      E     MOV     DPTR,#sample_enable
000C E0                MOVX    A,@DPTR
000D FF                MOV     R7,A
000E EF                MOV     A,R7
000F 601F              JZ      ?C0005
                                           ; SOURCE LINE # 98
0011 900000      E     MOV     DPTR,#sample_int_count
0014 E0                MOVX    A,@DPTR
0015 04                INC     A
0016 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 100
0017 900000      E     MOV     DPTR,#sample_interval
001A E0                MOVX    A,@DPTR
001B FF                MOV     R7,A
001C 900000      E     MOV     DPTR,#sample_int_count
001F E0                MOVX    A,@DPTR
0020 FE                MOV     R6,A
0021 EE                MOV     A,R6
0022 B5070B            CJNE    A,AR7,?C0005
                                           ; SOURCE LINE # 101
                                           ; SOURCE LINE # 102
0025 900000      E     MOV     DPTR,#Sample_waiting
0028 7401              MOV     A,#01H
002A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 103
002B 900000      E     MOV     DPTR,#sample_int_count
002E E4                CLR     A
002F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 104
0030         ?C0006:
                                           ; SOURCE LINE # 105
0030         ?C0005:
                                           ; SOURCE LINE # 107
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 19  

0030 900000      E     MOV     DPTR,#battery_check_count
0033 E0                MOVX    A,@DPTR
0034 04                INC     A
0035 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 108
0036 900000      E     MOV     DPTR,#battery_check_count
0039 E0                MOVX    A,@DPTR
003A FF                MOV     R7,A
003B EF                MOV     A,R7
003C B4010B            CJNE    A,#01H,?C0008
                                           ; SOURCE LINE # 109
003F 900000      E     MOV     DPTR,#battery_check_count
0042 E4                CLR     A
0043 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 110
0044 900000      E     MOV     DPTR,#BatteryCheck_waiting
0047 7401              MOV     A,#01H
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 111
004A         ?C0007:
                                           ; SOURCE LINE # 114
004A         ?C0008:
004A 22                RET     
             ; FUNCTION RTC_EveryMinuteHandler (END)

             ; FUNCTION RTC_EveryHourHandler (BEGIN)
                                           ; SOURCE LINE # 131
                                           ; SOURCE LINE # 132
                                           ; SOURCE LINE # 135
0000 900000      E     MOV     DPTR,#sample_enable
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 601F              JZ      ?C0011
                                           ; SOURCE LINE # 136
0008 900000      E     MOV     DPTR,#sample_int_count
000B E0                MOVX    A,@DPTR
000C 04                INC     A
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 138
000E 900000      E     MOV     DPTR,#sample_interval
0011 E0                MOVX    A,@DPTR
0012 FF                MOV     R7,A
0013 900000      E     MOV     DPTR,#sample_int_count
0016 E0                MOVX    A,@DPTR
0017 FE                MOV     R6,A
0018 EE                MOV     A,R6
0019 B5070B            CJNE    A,AR7,?C0011
                                           ; SOURCE LINE # 139
                                           ; SOURCE LINE # 140
001C 900000      E     MOV     DPTR,#Sample_waiting
001F 7401              MOV     A,#01H
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 141
0022 900000      E     MOV     DPTR,#sample_int_count
0025 E4                CLR     A
0026 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 142
0027         ?C0010:
                                           ; SOURCE LINE # 143
0027         ?C0009:
                                           ; SOURCE LINE # 145
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 20  

0027         ?C0011:
0027 22                RET     
             ; FUNCTION RTC_EveryHourHandler (END)

             ; FUNCTION RTC_EveryDayHandler (BEGIN)
                                           ; SOURCE LINE # 162
                                           ; SOURCE LINE # 163
                                           ; SOURCE LINE # 166
0000 900000      E     MOV     DPTR,#sample_enable
0003 E0                MOVX    A,@DPTR
0004 FF                MOV     R7,A
0005 EF                MOV     A,R7
0006 601F              JZ      ?C0014
                                           ; SOURCE LINE # 167
0008 900000      E     MOV     DPTR,#sample_int_count
000B E0                MOVX    A,@DPTR
000C 04                INC     A
000D F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 169
000E 900000      E     MOV     DPTR,#sample_interval
0011 E0                MOVX    A,@DPTR
0012 FF                MOV     R7,A
0013 900000      E     MOV     DPTR,#sample_int_count
0016 E0                MOVX    A,@DPTR
0017 FE                MOV     R6,A
0018 EE                MOV     A,R6
0019 B5070B            CJNE    A,AR7,?C0014
                                           ; SOURCE LINE # 170
                                           ; SOURCE LINE # 171
001C 900000      E     MOV     DPTR,#Sample_waiting
001F 7401              MOV     A,#01H
0021 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 172
0022 900000      E     MOV     DPTR,#sample_int_count
0025 E4                CLR     A
0026 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 173
0027         ?C0013:
                                           ; SOURCE LINE # 174
0027         ?C0012:
                                           ; SOURCE LINE # 176
0027         ?C0014:
0027 22                RET     
             ; FUNCTION RTC_EveryDayHandler (END)

             ; FUNCTION RTC_EveryWeekHandler (BEGIN)
                                           ; SOURCE LINE # 193
                                           ; SOURCE LINE # 194
                                           ; SOURCE LINE # 198
0000         ?C0015:
0000 22                RET     
             ; FUNCTION RTC_EveryWeekHandler (END)

             ; FUNCTION RTC_EveryMonthHandler (BEGIN)
                                           ; SOURCE LINE # 215
                                           ; SOURCE LINE # 216
                                           ; SOURCE LINE # 220
0000         ?C0016:
0000 22                RET     
             ; FUNCTION RTC_EveryMonthHandler (END)

             ; FUNCTION RTC_EveryYearHandler (BEGIN)
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 21  

                                           ; SOURCE LINE # 237
                                           ; SOURCE LINE # 238
                                           ; SOURCE LINE # 242
0000         ?C0017:
0000 22                RET     
             ; FUNCTION RTC_EveryYearHandler (END)

             ; FUNCTION RTC_ISR (BEGIN)
0000 C0E0              PUSH    ACC
0002 C0F0              PUSH    B
0004 C083              PUSH    DPH
0006 C082              PUSH    DPL
0008 C085              PUSH    DPH1
000A C084              PUSH    DPL1
000C C086              PUSH    DPS
000E 758600            MOV     DPS,#00H
0011 C000        E     PUSH    ?C?XPAGE1SFR
0013 750000      E     MOV     ?C?XPAGE1SFR,#?C?XPAGE1RST
0016 C0D0              PUSH    PSW
0018 75D000            MOV     PSW,#00H
001B C000              PUSH    AR0
001D C001              PUSH    AR1
001F C002              PUSH    AR2
0021 C003              PUSH    AR3
0023 C004              PUSH    AR4
0025 C005              PUSH    AR5
0027 C006              PUSH    AR6
0029 C007              PUSH    AR7
                                           ; SOURCE LINE # 283
                                           ; SOURCE LINE # 288
002B 7F04              MOV     R7,#04H
002D 120000      E     LCALL   _CyPmReadStatus
                                           ; SOURCE LINE # 291
0030 900000      E     MOV     DPTR,#RTC_currentTimeDate
0033 E0                MOVX    A,@DPTR
0034 04                INC     A
0035 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 294
0036 900000      E     MOV     DPTR,#RTC_currentTimeDate
0039 E0                MOVX    A,@DPTR
003A FF                MOV     R7,A
003B EF                MOV     A,R7
003C D3                SETB    C
003D 943B              SUBB    A,#03BH
003F 5003              JNC     $ + 5H
0041 020000      R     LJMP    ?C0018
                                           ; SOURCE LINE # 295
                                           ; SOURCE LINE # 297
0044 900000      E     MOV     DPTR,#RTC_currentTimeDate+01H
0047 E0                MOVX    A,@DPTR
0048 04                INC     A
0049 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 300
004A 900000      E     MOV     DPTR,#RTC_currentTimeDate
004D E4                CLR     A
004E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 302
004F 900000      E     MOV     DPTR,#RTC_currentTimeDate+01H
0052 E0                MOVX    A,@DPTR
0053 FF                MOV     R7,A
0054 EF                MOV     A,R7
0055 D3                SETB    C
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 22  

0056 943B              SUBB    A,#03BH
0058 5003              JNC     $ + 5H
005A 020000      R     LJMP    ?C0019
                                           ; SOURCE LINE # 303
                                           ; SOURCE LINE # 305
005D 900000      E     MOV     DPTR,#RTC_currentTimeDate+02H
0060 E0                MOVX    A,@DPTR
0061 04                INC     A
0062 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 308
0063 900000      E     MOV     DPTR,#RTC_currentTimeDate+01H
0066 E4                CLR     A
0067 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 311
0068 900000      E     MOV     DPTR,#RTC_currentTimeDate+02H
006B E0                MOVX    A,@DPTR
006C FF                MOV     R7,A
006D EF                MOV     A,R7
006E D3                SETB    C
006F 9417              SUBB    A,#017H
0071 5003              JNC     $ + 5H
0073 020000      R     LJMP    ?C0020
                                           ; SOURCE LINE # 312
                                           ; SOURCE LINE # 314
0076 900000      E     MOV     DPTR,#RTC_currentTimeDate+04H
0079 E0                MOVX    A,@DPTR
007A 04                INC     A
007B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 317
007C 900000      E     MOV     DPTR,#RTC_currentTimeDate+02H
007F E4                CLR     A
0080 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 320
0081 900000      E     MOV     DPTR,#RTC_currentTimeDate+05H
0084 E4                CLR     A
0085 75F001            MOV     B,#01H
0088 120000      E     LCALL   ?C?IILDX
                                           ; SOURCE LINE # 323
008B 900000      E     MOV     DPTR,#RTC_currentTimeDate+03H
008E E0                MOVX    A,@DPTR
008F 04                INC     A
0090 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 326
0091 900000      E     MOV     DPTR,#RTC_currentTimeDate+03H
0094 E0                MOVX    A,@DPTR
0095 FF                MOV     R7,A
0096 EF                MOV     A,R7
0097 D3                SETB    C
0098 9407              SUBB    A,#07H
009A 4006              JC      ?C0021
                                           ; SOURCE LINE # 327
                                           ; SOURCE LINE # 329
009C 900000      E     MOV     DPTR,#RTC_currentTimeDate+03H
009F 7401              MOV     A,#01H
00A1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 330
00A2         ?C0021:
                                           ; SOURCE LINE # 337
00A2 900000      E     MOV     DPTR,#RTC_statusDateTime
00A5 E0                MOVX    A,@DPTR
00A6 FF                MOV     R7,A
00A7 EF                MOV     A,R7
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 23  

00A8 5402              ANL     A,#02H
00AA FF                MOV     R7,A
00AB 7E00              MOV     R6,#00H
00AD EF                MOV     A,R7
00AE 4E                ORL     A,R6
00AF 602C              JZ      ?C0024
00B1 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
00B4 E0                MOVX    A,@DPTR
00B5 FF                MOV     R7,A
00B6 EF                MOV     A,R7
00B7 B40223            CJNE    A,#02H,?C0024
00BA 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
00BD E0                MOVX    A,@DPTR
00BE FF                MOV     R7,A
00BF EF                MOV     A,R7
00C0 900000      E     MOV     DPTR,#RTC_daysInMonths-01H
00C3 93                MOVC    A,@A+DPTR
00C4 FF                MOV     R7,A
00C5 7E00              MOV     R6,#00H
00C7 EF                MOV     A,R7
00C8 2401              ADD     A,#01H
00CA FF                MOV     R7,A
00CB EE                MOV     A,R6
00CC 3400              ADDC    A,#00H
00CE FE                MOV     R6,A
00CF 900000      E     MOV     DPTR,#RTC_currentTimeDate+04H
00D2 E0                MOVX    A,@DPTR
00D3 FD                MOV     R5,A
00D4 7C00              MOV     R4,#00H
00D6 D3                SETB    C
00D7 ED                MOV     A,R5
00D8 9F                SUBB    A,R7
00D9 EC                MOV     A,R4
00DA 9E                SUBB    A,R6
00DB 5058              JNC     ?C0023
00DD         ?C0024:
00DD 900000      E     MOV     DPTR,#RTC_statusDateTime
00E0 E0                MOVX    A,@DPTR
00E1 FF                MOV     R7,A
00E2 EF                MOV     A,R7
00E3 5402              ANL     A,#02H
00E5 FF                MOV     R7,A
00E6 7E00              MOV     R6,#00H
00E8 EF                MOV     A,R7
00E9 4E                ORL     A,R6
00EA 601F              JZ      ?C0025
00EC 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
00EF E0                MOVX    A,@DPTR
00F0 FF                MOV     R7,A
00F1 EF                MOV     A,R7
00F2 6402              XRL     A,#02H
00F4 6015              JZ      ?C0025
00F6 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
00F9 E0                MOVX    A,@DPTR
00FA FF                MOV     R7,A
00FB EF                MOV     A,R7
00FC 900000      E     MOV     DPTR,#RTC_daysInMonths-01H
00FF 93                MOVC    A,@A+DPTR
0100 FF                MOV     R7,A
0101 900000      E     MOV     DPTR,#RTC_currentTimeDate+04H
0104 E0                MOVX    A,@DPTR
0105 FE                MOV     R6,A
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 24  

0106 EE                MOV     A,R6
0107 D3                SETB    C
0108 9F                SUBB    A,R7
0109 502A              JNC     ?C0023
010B         ?C0025:
010B 900000      E     MOV     DPTR,#RTC_statusDateTime
010E E0                MOVX    A,@DPTR
010F FF                MOV     R7,A
0110 EF                MOV     A,R7
0111 5402              ANL     A,#02H
0113 FF                MOV     R7,A
0114 7E00              MOV     R6,#00H
0116 EF                MOV     A,R7
0117 4E                ORL     A,R6
0118 6003              JZ      $ + 5H
011A 020000      R     LJMP    ?C0022
011D 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
0120 E0                MOVX    A,@DPTR
0121 FF                MOV     R7,A
0122 EF                MOV     A,R7
0123 900000      E     MOV     DPTR,#RTC_daysInMonths-01H
0126 93                MOVC    A,@A+DPTR
0127 FF                MOV     R7,A
0128 900000      E     MOV     DPTR,#RTC_currentTimeDate+04H
012B E0                MOVX    A,@DPTR
012C FE                MOV     R6,A
012D EE                MOV     A,R6
012E D3                SETB    C
012F 9F                SUBB    A,R7
0130 5003              JNC     $ + 5H
0132 020000      R     LJMP    ?C0022
0135         ?C0023:
                                           ; SOURCE LINE # 348
                                           ; SOURCE LINE # 350
0135 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
0138 E0                MOVX    A,@DPTR
0139 04                INC     A
013A F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 353
013B 900000      E     MOV     DPTR,#RTC_currentTimeDate+04H
013E 7401              MOV     A,#01H
0140 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 356
0141 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
0144 E0                MOVX    A,@DPTR
0145 FF                MOV     R7,A
0146 EF                MOV     A,R7
0147 D3                SETB    C
0148 940C              SUBB    A,#0CH
014A 5003              JNC     $ + 5H
014C 020000      R     LJMP    ?C0026
                                           ; SOURCE LINE # 357
                                           ; SOURCE LINE # 359
014F 900000      E     MOV     DPTR,#RTC_currentTimeDate+08H
0152 E4                CLR     A
0153 75F001            MOV     B,#01H
0156 120000      E     LCALL   ?C?IILDX
                                           ; SOURCE LINE # 362
0159 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
015C 7401              MOV     A,#01H
015E F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 365
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 25  

015F 900000      E     MOV     DPTR,#RTC_currentTimeDate+05H
0162 E4                CLR     A
0163 F0                MOVX    @DPTR,A
0164 A3                INC     DPTR
0165 7401              MOV     A,#01H
0167 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 368
0168 900000      E     MOV     DPTR,#RTC_currentTimeDate+08H
016B E0                MOVX    A,@DPTR
016C FE                MOV     R6,A
016D A3                INC     DPTR
016E E0                MOVX    A,@DPTR
016F FF                MOV     R7,A
0170 7C01              MOV     R4,#01H
0172 7D90              MOV     R5,#090H
0174 120000      E     LCALL   ?C?UIDIV
0177 ED                MOV     A,R5
0178 4C                ORL     A,R4
0179 6025              JZ      ?C0030
017B 900000      E     MOV     DPTR,#RTC_currentTimeDate+08H
017E E0                MOVX    A,@DPTR
017F FE                MOV     R6,A
0180 A3                INC     DPTR
0181 E0                MOVX    A,@DPTR
0182 FF                MOV     R7,A
0183 7E00              MOV     R6,#00H
0185 EF                MOV     A,R7
0186 5403              ANL     A,#03H
0188 FF                MOV     R7,A
0189 EF                MOV     A,R7
018A 4E                ORL     A,R6
018B 7017              JNZ     ?C0028
018D 900000      E     MOV     DPTR,#RTC_currentTimeDate+08H
0190 E0                MOVX    A,@DPTR
0191 FE                MOV     R6,A
0192 A3                INC     DPTR
0193 E0                MOVX    A,@DPTR
0194 FF                MOV     R7,A
0195 7C00              MOV     R4,#00H
0197 7D64              MOV     R5,#064H
0199 120000      E     LCALL   ?C?UIDIV
019C ED                MOV     A,R5
019D 4C                ORL     A,R4
019E 6004              JZ      ?C0028
01A0         ?C0030:
01A0 7F01              MOV     R7,#01H
01A2 8002              SJMP    ?C0029
01A4         ?C0028:
01A4 7F00              MOV     R7,#00H
01A6         ?C0029:
01A6 EF                MOV     A,R7
01A7 B40110            CJNE    A,#01H,?C0027
                                           ; SOURCE LINE # 369
                                           ; SOURCE LINE # 371
01AA 900000      E     MOV     DPTR,#RTC_statusDateTime
01AD E0                MOVX    A,@DPTR
01AE FF                MOV     R7,A
01AF EF                MOV     A,R7
01B0 4402              ORL     A,#02H
01B2 FF                MOV     R7,A
01B3 900000      E     MOV     DPTR,#RTC_statusDateTime
01B6 EF                MOV     A,R7
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 26  

01B7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 372
01B8 800E              SJMP    ?C0031
01BA         ?C0027:
                                           ; SOURCE LINE # 374
                                           ; SOURCE LINE # 376
01BA 900000      E     MOV     DPTR,#RTC_statusDateTime
01BD E0                MOVX    A,@DPTR
01BE FF                MOV     R7,A
01BF EF                MOV     A,R7
01C0 54FD              ANL     A,#0FDH
01C2 FF                MOV     R7,A
01C3 900000      E     MOV     DPTR,#RTC_statusDateTime
01C6 EF                MOV     A,R7
01C7 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 377
01C8         ?C0031:
                                           ; SOURCE LINE # 380
01C8 900000      E     MOV     DPTR,#RTC_alarmCfgMask
01CB E0                MOVX    A,@DPTR
01CC FF                MOV     R7,A
01CD EF                MOV     A,R7
01CE 5480              ANL     A,#080H
01D0 FF                MOV     R7,A
01D1 7E00              MOV     R6,#00H
01D3 EF                MOV     A,R7
01D4 6480              XRL     A,#080H
01D6 4E                ORL     A,R6
01D7 7004              JNZ     ?C0033
01D9 7F01              MOV     R7,#01H
01DB 8002              SJMP    ?C0034
01DD         ?C0033:
01DD 7F00              MOV     R7,#00H
01DF         ?C0034:
01DF EF                MOV     A,R7
01E0 6036              JZ      ?C0032
                                           ; SOURCE LINE # 382
                                           ; SOURCE LINE # 384
01E2 900000      E     MOV     DPTR,#RTC_currentTimeDate+08H
01E5 E0                MOVX    A,@DPTR
01E6 FE                MOV     R6,A
01E7 A3                INC     DPTR
01E8 E0                MOVX    A,@DPTR
01E9 FF                MOV     R7,A
01EA 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+08H
01ED E0                MOVX    A,@DPTR
01EE FC                MOV     R4,A
01EF A3                INC     DPTR
01F0 E0                MOVX    A,@DPTR
01F1 FD                MOV     R5,A
01F2 ED                MOV     A,R5
01F3 B50714            CJNE    A,AR7,?C0035
01F6 EC                MOV     A,R4
01F7 B50610            CJNE    A,AR6,?C0035
                                           ; SOURCE LINE # 385
                                           ; SOURCE LINE # 387
01FA 900000      E     MOV     DPTR,#RTC_alarmCurStatus
01FD E0                MOVX    A,@DPTR
01FE FF                MOV     R7,A
01FF EF                MOV     A,R7
0200 4480              ORL     A,#080H
0202 FF                MOV     R7,A
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 27  

0203 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0206 EF                MOV     A,R7
0207 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 388
0208 800E              SJMP    ?C0032
020A         ?C0035:
                                           ; SOURCE LINE # 390
                                           ; SOURCE LINE # 392
020A 900000      E     MOV     DPTR,#RTC_alarmCurStatus
020D E0                MOVX    A,@DPTR
020E FF                MOV     R7,A
020F EF                MOV     A,R7
0210 547F              ANL     A,#07FH
0212 FF                MOV     R7,A
0213 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0216 EF                MOV     A,R7
0217 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 393
0218         ?C0036:
                                           ; SOURCE LINE # 394
0218         ?C0032:
                                           ; SOURCE LINE # 397
0218 900000      E     MOV     DPTR,#RTC_alarmCfgMask
021B E0                MOVX    A,@DPTR
021C FF                MOV     R7,A
021D 900000      R     MOV     DPTR,#RTC_tmp
0220 EF                MOV     A,R7
0221 F0                MOVX    @DPTR,A
0222         ?C0039:
                                           ; SOURCE LINE # 400
0222 900000      R     MOV     DPTR,#RTC_tmp
0225 E0                MOVX    A,@DPTR
0226 FF                MOV     R7,A
0227 EF                MOV     A,R7
0228 6032              JZ      ?C0038
022A 900000      R     MOV     DPTR,#RTC_tmp
022D E0                MOVX    A,@DPTR
022E FF                MOV     R7,A
022F 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0232 E0                MOVX    A,@DPTR
0233 FE                MOV     R6,A
0234 EE                MOV     A,R6
0235 5F                ANL     A,R7
0236 FF                MOV     R7,A
0237 900000      R     MOV     DPTR,#RTC_tmp
023A E0                MOVX    A,@DPTR
023B FE                MOV     R6,A
023C EF                MOV     A,R7
023D B50604            CJNE    A,AR6,?C0041
0240 7F01              MOV     R7,#01H
0242 8002              SJMP    ?C0042
0244         ?C0041:
0244 7F00              MOV     R7,#00H
0246         ?C0042:
0246 EF                MOV     A,R7
0247 6013              JZ      ?C0038
0249 900000      E     MOV     DPTR,#RTC_statusDateTime
024C E0                MOVX    A,@DPTR
024D FF                MOV     R7,A
024E EF                MOV     A,R7
024F 4408              ORL     A,#08H
0251 FF                MOV     R7,A
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 28  

0252 900000      E     MOV     DPTR,#RTC_statusDateTime
0255 EF                MOV     A,R7
0256 F0                MOVX    @DPTR,A
0257 900000      E     MOV     DPTR,#RTC_alarmCurStatus
025A E4                CLR     A
025B F0                MOVX    @DPTR,A
025C         ?C0040:
025C         ?C0037:
025C         ?C0038:
                                           ; SOURCE LINE # 403
025C 900000      E     MOV     DPTR,#RTC_intervalCfgMask
025F E0                MOVX    A,@DPTR
0260 FF                MOV     R7,A
0261 EF                MOV     A,R7
0262 5440              ANL     A,#040H
0264 FF                MOV     R7,A
0265 7E00              MOV     R6,#00H
0267 EF                MOV     A,R7
0268 6440              XRL     A,#040H
026A 4E                ORL     A,R6
026B 7004              JNZ     ?C0044
026D 7F01              MOV     R7,#01H
026F 8002              SJMP    ?C0045
0271         ?C0044:
0271 7F00              MOV     R7,#00H
0273         ?C0045:
0273 EF                MOV     A,R7
0274 6003              JZ      ?C0026
                                           ; SOURCE LINE # 405
                                           ; SOURCE LINE # 406
0276 120000      R     LCALL   RTC_EveryYearHandler
                                           ; SOURCE LINE # 407
0279         ?C0043:
                                           ; SOURCE LINE # 409
0279         ?C0026:
                                           ; SOURCE LINE # 412
0279 900000      E     MOV     DPTR,#RTC_alarmCfgMask
027C E0                MOVX    A,@DPTR
027D FF                MOV     R7,A
027E EF                MOV     A,R7
027F 5440              ANL     A,#040H
0281 FF                MOV     R7,A
0282 7E00              MOV     R6,#00H
0284 EF                MOV     A,R7
0285 6440              XRL     A,#040H
0287 4E                ORL     A,R6
0288 7004              JNZ     ?C0047
028A 7F01              MOV     R7,#01H
028C 8002              SJMP    ?C0048
028E         ?C0047:
028E 7F00              MOV     R7,#00H
0290         ?C0048:
0290 EF                MOV     A,R7
0291 602C              JZ      ?C0046
                                           ; SOURCE LINE # 414
                                           ; SOURCE LINE # 415
0293 900000      E     MOV     DPTR,#RTC_currentTimeDate+07H
0296 E0                MOVX    A,@DPTR
0297 FF                MOV     R7,A
0298 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+07H
029B E0                MOVX    A,@DPTR
029C FE                MOV     R6,A
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 29  

029D EE                MOV     A,R6
029E B50710            CJNE    A,AR7,?C0049
                                           ; SOURCE LINE # 416
                                           ; SOURCE LINE # 418
02A1 900000      E     MOV     DPTR,#RTC_alarmCurStatus
02A4 E0                MOVX    A,@DPTR
02A5 FF                MOV     R7,A
02A6 EF                MOV     A,R7
02A7 4440              ORL     A,#040H
02A9 FF                MOV     R7,A
02AA 900000      E     MOV     DPTR,#RTC_alarmCurStatus
02AD EF                MOV     A,R7
02AE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 419
02AF 800E              SJMP    ?C0046
02B1         ?C0049:
                                           ; SOURCE LINE # 421
                                           ; SOURCE LINE # 423
02B1 900000      E     MOV     DPTR,#RTC_alarmCurStatus
02B4 E0                MOVX    A,@DPTR
02B5 FF                MOV     R7,A
02B6 EF                MOV     A,R7
02B7 54BF              ANL     A,#0BFH
02B9 FF                MOV     R7,A
02BA 900000      E     MOV     DPTR,#RTC_alarmCurStatus
02BD EF                MOV     A,R7
02BE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 424
02BF         ?C0050:
                                           ; SOURCE LINE # 425
02BF         ?C0046:
                                           ; SOURCE LINE # 448
02BF 900000      E     MOV     DPTR,#RTC_alarmCfgMask
02C2 E0                MOVX    A,@DPTR
02C3 FF                MOV     R7,A
02C4 900000      R     MOV     DPTR,#RTC_tmp
02C7 EF                MOV     A,R7
02C8 F0                MOVX    @DPTR,A
02C9         ?C0053:
                                           ; SOURCE LINE # 451
02C9 900000      R     MOV     DPTR,#RTC_tmp
02CC E0                MOVX    A,@DPTR
02CD FF                MOV     R7,A
02CE EF                MOV     A,R7
02CF 6032              JZ      ?C0052
02D1 900000      R     MOV     DPTR,#RTC_tmp
02D4 E0                MOVX    A,@DPTR
02D5 FF                MOV     R7,A
02D6 900000      E     MOV     DPTR,#RTC_alarmCurStatus
02D9 E0                MOVX    A,@DPTR
02DA FE                MOV     R6,A
02DB EE                MOV     A,R6
02DC 5F                ANL     A,R7
02DD FF                MOV     R7,A
02DE 900000      R     MOV     DPTR,#RTC_tmp
02E1 E0                MOVX    A,@DPTR
02E2 FE                MOV     R6,A
02E3 EF                MOV     A,R7
02E4 B50604            CJNE    A,AR6,?C0055
02E7 7F01              MOV     R7,#01H
02E9 8002              SJMP    ?C0056
02EB         ?C0055:
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 30  

02EB 7F00              MOV     R7,#00H
02ED         ?C0056:
02ED EF                MOV     A,R7
02EE 6013              JZ      ?C0052
02F0 900000      E     MOV     DPTR,#RTC_statusDateTime
02F3 E0                MOVX    A,@DPTR
02F4 FF                MOV     R7,A
02F5 EF                MOV     A,R7
02F6 4408              ORL     A,#08H
02F8 FF                MOV     R7,A
02F9 900000      E     MOV     DPTR,#RTC_statusDateTime
02FC EF                MOV     A,R7
02FD F0                MOVX    @DPTR,A
02FE 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0301 E4                CLR     A
0302 F0                MOVX    @DPTR,A
0303         ?C0054:
0303         ?C0051:
0303         ?C0052:
                                           ; SOURCE LINE # 454
0303 900000      E     MOV     DPTR,#RTC_intervalCfgMask
0306 E0                MOVX    A,@DPTR
0307 FF                MOV     R7,A
0308 EF                MOV     A,R7
0309 5420              ANL     A,#020H
030B FF                MOV     R7,A
030C 7E00              MOV     R6,#00H
030E EF                MOV     A,R7
030F 6420              XRL     A,#020H
0311 4E                ORL     A,R6
0312 7004              JNZ     ?C0058
0314 7F01              MOV     R7,#01H
0316 8002              SJMP    ?C0059
0318         ?C0058:
0318 7F00              MOV     R7,#00H
031A         ?C0059:
031A EF                MOV     A,R7
031B 6003              JZ      ?C0022
                                           ; SOURCE LINE # 456
                                           ; SOURCE LINE # 457
031D 120000      R     LCALL   RTC_EveryMonthHandler
                                           ; SOURCE LINE # 458
0320         ?C0057:
                                           ; SOURCE LINE # 459
0320         ?C0022:
                                           ; SOURCE LINE # 462
0320 900000      E     MOV     DPTR,#RTC_alarmCfgMask
0323 E0                MOVX    A,@DPTR
0324 FF                MOV     R7,A
0325 EF                MOV     A,R7
0326 5408              ANL     A,#08H
0328 FF                MOV     R7,A
0329 7E00              MOV     R6,#00H
032B EF                MOV     A,R7
032C 6408              XRL     A,#08H
032E 4E                ORL     A,R6
032F 7004              JNZ     ?C0061
0331 7F01              MOV     R7,#01H
0333 8002              SJMP    ?C0062
0335         ?C0061:
0335 7F00              MOV     R7,#00H
0337         ?C0062:
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 31  

0337 EF                MOV     A,R7
0338 602C              JZ      ?C0060
                                           ; SOURCE LINE # 464
                                           ; SOURCE LINE # 465
033A 900000      E     MOV     DPTR,#RTC_currentTimeDate+03H
033D E0                MOVX    A,@DPTR
033E FF                MOV     R7,A
033F 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+03H
0342 E0                MOVX    A,@DPTR
0343 FE                MOV     R6,A
0344 EE                MOV     A,R6
0345 B50710            CJNE    A,AR7,?C0063
                                           ; SOURCE LINE # 466
                                           ; SOURCE LINE # 468
0348 900000      E     MOV     DPTR,#RTC_alarmCurStatus
034B E0                MOVX    A,@DPTR
034C FF                MOV     R7,A
034D EF                MOV     A,R7
034E 4408              ORL     A,#08H
0350 FF                MOV     R7,A
0351 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0354 EF                MOV     A,R7
0355 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 469
0356 800E              SJMP    ?C0060
0358         ?C0063:
                                           ; SOURCE LINE # 471
                                           ; SOURCE LINE # 473
0358 900000      E     MOV     DPTR,#RTC_alarmCurStatus
035B E0                MOVX    A,@DPTR
035C FF                MOV     R7,A
035D EF                MOV     A,R7
035E 54F7              ANL     A,#0F7H
0360 FF                MOV     R7,A
0361 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0364 EF                MOV     A,R7
0365 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 474
0366         ?C0064:
                                           ; SOURCE LINE # 475
0366         ?C0060:
                                           ; SOURCE LINE # 478
0366 900000      E     MOV     DPTR,#RTC_alarmCfgMask
0369 E0                MOVX    A,@DPTR
036A FF                MOV     R7,A
036B EF                MOV     A,R7
036C 5420              ANL     A,#020H
036E FF                MOV     R7,A
036F 7E00              MOV     R6,#00H
0371 EF                MOV     A,R7
0372 6420              XRL     A,#020H
0374 4E                ORL     A,R6
0375 7004              JNZ     ?C0066
0377 7F01              MOV     R7,#01H
0379 8002              SJMP    ?C0067
037B         ?C0066:
037B 7F00              MOV     R7,#00H
037D         ?C0067:
037D EF                MOV     A,R7
037E 6036              JZ      ?C0065
                                           ; SOURCE LINE # 480
                                           ; SOURCE LINE # 481
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 32  

0380 900000      E     MOV     DPTR,#RTC_currentTimeDate+05H
0383 E0                MOVX    A,@DPTR
0384 FE                MOV     R6,A
0385 A3                INC     DPTR
0386 E0                MOVX    A,@DPTR
0387 FF                MOV     R7,A
0388 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+05H
038B E0                MOVX    A,@DPTR
038C FC                MOV     R4,A
038D A3                INC     DPTR
038E E0                MOVX    A,@DPTR
038F FD                MOV     R5,A
0390 ED                MOV     A,R5
0391 B50714            CJNE    A,AR7,?C0068
0394 EC                MOV     A,R4
0395 B50610            CJNE    A,AR6,?C0068
                                           ; SOURCE LINE # 482
                                           ; SOURCE LINE # 484
0398 900000      E     MOV     DPTR,#RTC_alarmCurStatus
039B E0                MOVX    A,@DPTR
039C FF                MOV     R7,A
039D EF                MOV     A,R7
039E 4420              ORL     A,#020H
03A0 FF                MOV     R7,A
03A1 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03A4 EF                MOV     A,R7
03A5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 485
03A6 800E              SJMP    ?C0065
03A8         ?C0068:
                                           ; SOURCE LINE # 487
                                           ; SOURCE LINE # 489
03A8 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03AB E0                MOVX    A,@DPTR
03AC FF                MOV     R7,A
03AD EF                MOV     A,R7
03AE 54DF              ANL     A,#0DFH
03B0 FF                MOV     R7,A
03B1 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03B4 EF                MOV     A,R7
03B5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 490
03B6         ?C0069:
                                           ; SOURCE LINE # 491
03B6         ?C0065:
                                           ; SOURCE LINE # 494
03B6 900000      E     MOV     DPTR,#RTC_alarmCfgMask
03B9 E0                MOVX    A,@DPTR
03BA FF                MOV     R7,A
03BB EF                MOV     A,R7
03BC 5410              ANL     A,#010H
03BE FF                MOV     R7,A
03BF 7E00              MOV     R6,#00H
03C1 EF                MOV     A,R7
03C2 6410              XRL     A,#010H
03C4 4E                ORL     A,R6
03C5 7004              JNZ     ?C0071
03C7 7F01              MOV     R7,#01H
03C9 8002              SJMP    ?C0072
03CB         ?C0071:
03CB 7F00              MOV     R7,#00H
03CD         ?C0072:
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 33  

03CD EF                MOV     A,R7
03CE 602C              JZ      ?C0070
                                           ; SOURCE LINE # 496
                                           ; SOURCE LINE # 497
03D0 900000      E     MOV     DPTR,#RTC_currentTimeDate+04H
03D3 E0                MOVX    A,@DPTR
03D4 FF                MOV     R7,A
03D5 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+04H
03D8 E0                MOVX    A,@DPTR
03D9 FE                MOV     R6,A
03DA EE                MOV     A,R6
03DB B50710            CJNE    A,AR7,?C0073
                                           ; SOURCE LINE # 498
                                           ; SOURCE LINE # 500
03DE 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03E1 E0                MOVX    A,@DPTR
03E2 FF                MOV     R7,A
03E3 EF                MOV     A,R7
03E4 4410              ORL     A,#010H
03E6 FF                MOV     R7,A
03E7 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03EA EF                MOV     A,R7
03EB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 501
03EC 800E              SJMP    ?C0070
03EE         ?C0073:
                                           ; SOURCE LINE # 503
                                           ; SOURCE LINE # 505
03EE 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03F1 E0                MOVX    A,@DPTR
03F2 FF                MOV     R7,A
03F3 EF                MOV     A,R7
03F4 54EF              ANL     A,#0EFH
03F6 FF                MOV     R7,A
03F7 900000      E     MOV     DPTR,#RTC_alarmCurStatus
03FA EF                MOV     A,R7
03FB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 506
03FC         ?C0074:
                                           ; SOURCE LINE # 507
03FC         ?C0070:
                                           ; SOURCE LINE # 530
03FC 900000      E     MOV     DPTR,#RTC_alarmCfgMask
03FF E0                MOVX    A,@DPTR
0400 FF                MOV     R7,A
0401 900000      R     MOV     DPTR,#RTC_tmp
0404 EF                MOV     A,R7
0405 F0                MOVX    @DPTR,A
0406         ?C0077:
                                           ; SOURCE LINE # 533
0406 900000      R     MOV     DPTR,#RTC_tmp
0409 E0                MOVX    A,@DPTR
040A FF                MOV     R7,A
040B EF                MOV     A,R7
040C 6032              JZ      ?C0076
040E 900000      R     MOV     DPTR,#RTC_tmp
0411 E0                MOVX    A,@DPTR
0412 FF                MOV     R7,A
0413 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0416 E0                MOVX    A,@DPTR
0417 FE                MOV     R6,A
0418 EE                MOV     A,R6
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 34  

0419 5F                ANL     A,R7
041A FF                MOV     R7,A
041B 900000      R     MOV     DPTR,#RTC_tmp
041E E0                MOVX    A,@DPTR
041F FE                MOV     R6,A
0420 EF                MOV     A,R7
0421 B50604            CJNE    A,AR6,?C0079
0424 7F01              MOV     R7,#01H
0426 8002              SJMP    ?C0080
0428         ?C0079:
0428 7F00              MOV     R7,#00H
042A         ?C0080:
042A EF                MOV     A,R7
042B 6013              JZ      ?C0076
042D 900000      E     MOV     DPTR,#RTC_statusDateTime
0430 E0                MOVX    A,@DPTR
0431 FF                MOV     R7,A
0432 EF                MOV     A,R7
0433 4408              ORL     A,#08H
0435 FF                MOV     R7,A
0436 900000      E     MOV     DPTR,#RTC_statusDateTime
0439 EF                MOV     A,R7
043A F0                MOVX    @DPTR,A
043B 900000      E     MOV     DPTR,#RTC_alarmCurStatus
043E E4                CLR     A
043F F0                MOVX    @DPTR,A
0440         ?C0078:
0440         ?C0075:
0440         ?C0076:
                                           ; SOURCE LINE # 536
0440 900000      E     MOV     DPTR,#RTC_intervalCfgMask
0443 E0                MOVX    A,@DPTR
0444 FF                MOV     R7,A
0445 EF                MOV     A,R7
0446 5408              ANL     A,#08H
0448 FF                MOV     R7,A
0449 7E00              MOV     R6,#00H
044B EF                MOV     A,R7
044C 6408              XRL     A,#08H
044E 4E                ORL     A,R6
044F 7004              JNZ     ?C0082
0451 7F01              MOV     R7,#01H
0453 8002              SJMP    ?C0083
0455         ?C0082:
0455 7F00              MOV     R7,#00H
0457         ?C0083:
0457 EF                MOV     A,R7
0458 6003              JZ      ?C0081
                                           ; SOURCE LINE # 538
                                           ; SOURCE LINE # 539
045A 120000      R     LCALL   RTC_EveryDayHandler
                                           ; SOURCE LINE # 540
045D         ?C0081:
                                           ; SOURCE LINE # 542
045D 900000      E     MOV     DPTR,#RTC_currentTimeDate+03H
0460 E0                MOVX    A,@DPTR
0461 FF                MOV     R7,A
0462 EF                MOV     A,R7
0463 B4011D            CJNE    A,#01H,?C0020
                                           ; SOURCE LINE # 543
                                           ; SOURCE LINE # 545
0466 900000      E     MOV     DPTR,#RTC_intervalCfgMask
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 35  

0469 E0                MOVX    A,@DPTR
046A FF                MOV     R7,A
046B EF                MOV     A,R7
046C 5410              ANL     A,#010H
046E FF                MOV     R7,A
046F 7E00              MOV     R6,#00H
0471 EF                MOV     A,R7
0472 6410              XRL     A,#010H
0474 4E                ORL     A,R6
0475 7004              JNZ     ?C0086
0477 7F01              MOV     R7,#01H
0479 8002              SJMP    ?C0087
047B         ?C0086:
047B 7F00              MOV     R7,#00H
047D         ?C0087:
047D EF                MOV     A,R7
047E 6003              JZ      ?C0020
                                           ; SOURCE LINE # 547
                                           ; SOURCE LINE # 548
0480 120000      R     LCALL   RTC_EveryWeekHandler
                                           ; SOURCE LINE # 549
0483         ?C0085:
                                           ; SOURCE LINE # 550
0483         ?C0084:
                                           ; SOURCE LINE # 552
0483         ?C0020:
                                           ; SOURCE LINE # 555
0483 900000      E     MOV     DPTR,#RTC_currentTimeDate+02H
0486 E0                MOVX    A,@DPTR
0487 FF                MOV     R7,A
0488 EF                MOV     A,R7
0489 C3                CLR     C
048A 940C              SUBB    A,#0CH
048C 5010              JNC     ?C0088
                                           ; SOURCE LINE # 556
                                           ; SOURCE LINE # 558
048E 900000      E     MOV     DPTR,#RTC_statusDateTime
0491 E0                MOVX    A,@DPTR
0492 FF                MOV     R7,A
0493 EF                MOV     A,R7
0494 54FB              ANL     A,#0FBH
0496 FF                MOV     R7,A
0497 900000      E     MOV     DPTR,#RTC_statusDateTime
049A EF                MOV     A,R7
049B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 559
049C 800E              SJMP    ?C0089
049E         ?C0088:
                                           ; SOURCE LINE # 561
                                           ; SOURCE LINE # 563
049E 900000      E     MOV     DPTR,#RTC_statusDateTime
04A1 E0                MOVX    A,@DPTR
04A2 FF                MOV     R7,A
04A3 EF                MOV     A,R7
04A4 4404              ORL     A,#04H
04A6 FF                MOV     R7,A
04A7 900000      E     MOV     DPTR,#RTC_statusDateTime
04AA EF                MOV     A,R7
04AB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 564
04AC         ?C0089:
                                           ; SOURCE LINE # 891
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 36  

04AC 900000      E     MOV     DPTR,#RTC_alarmCfgMask
04AF E0                MOVX    A,@DPTR
04B0 FF                MOV     R7,A
04B1 EF                MOV     A,R7
04B2 5404              ANL     A,#04H
04B4 FF                MOV     R7,A
04B5 7E00              MOV     R6,#00H
04B7 EF                MOV     A,R7
04B8 6404              XRL     A,#04H
04BA 4E                ORL     A,R6
04BB 7004              JNZ     ?C0091
04BD 7F01              MOV     R7,#01H
04BF 8002              SJMP    ?C0092
04C1         ?C0091:
04C1 7F00              MOV     R7,#00H
04C3         ?C0092:
04C3 EF                MOV     A,R7
04C4 602C              JZ      ?C0090
                                           ; SOURCE LINE # 892
                                           ; SOURCE LINE # 893
04C6 900000      E     MOV     DPTR,#RTC_currentTimeDate+02H
04C9 E0                MOVX    A,@DPTR
04CA FF                MOV     R7,A
04CB 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+02H
04CE E0                MOVX    A,@DPTR
04CF FE                MOV     R6,A
04D0 EE                MOV     A,R6
04D1 B50710            CJNE    A,AR7,?C0093
                                           ; SOURCE LINE # 894
                                           ; SOURCE LINE # 895
04D4 900000      E     MOV     DPTR,#RTC_alarmCurStatus
04D7 E0                MOVX    A,@DPTR
04D8 FF                MOV     R7,A
04D9 EF                MOV     A,R7
04DA 4404              ORL     A,#04H
04DC FF                MOV     R7,A
04DD 900000      E     MOV     DPTR,#RTC_alarmCurStatus
04E0 EF                MOV     A,R7
04E1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 896
04E2 800E              SJMP    ?C0090
04E4         ?C0093:
                                           ; SOURCE LINE # 898
                                           ; SOURCE LINE # 899
04E4 900000      E     MOV     DPTR,#RTC_alarmCurStatus
04E7 E0                MOVX    A,@DPTR
04E8 FF                MOV     R7,A
04E9 EF                MOV     A,R7
04EA 54FB              ANL     A,#0FBH
04EC FF                MOV     R7,A
04ED 900000      E     MOV     DPTR,#RTC_alarmCurStatus
04F0 EF                MOV     A,R7
04F1 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 900
04F2         ?C0094:
                                           ; SOURCE LINE # 901
04F2         ?C0090:
                                           ; SOURCE LINE # 904
04F2 900000      E     MOV     DPTR,#RTC_alarmCfgMask
04F5 E0                MOVX    A,@DPTR
04F6 FF                MOV     R7,A
04F7 900000      R     MOV     DPTR,#RTC_tmp
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 37  

04FA EF                MOV     A,R7
04FB F0                MOVX    @DPTR,A
04FC         ?C0097:
                                           ; SOURCE LINE # 907
04FC 900000      R     MOV     DPTR,#RTC_tmp
04FF E0                MOVX    A,@DPTR
0500 FF                MOV     R7,A
0501 EF                MOV     A,R7
0502 6032              JZ      ?C0096
0504 900000      R     MOV     DPTR,#RTC_tmp
0507 E0                MOVX    A,@DPTR
0508 FF                MOV     R7,A
0509 900000      E     MOV     DPTR,#RTC_alarmCurStatus
050C E0                MOVX    A,@DPTR
050D FE                MOV     R6,A
050E EE                MOV     A,R6
050F 5F                ANL     A,R7
0510 FF                MOV     R7,A
0511 900000      R     MOV     DPTR,#RTC_tmp
0514 E0                MOVX    A,@DPTR
0515 FE                MOV     R6,A
0516 EF                MOV     A,R7
0517 B50604            CJNE    A,AR6,?C0099
051A 7F01              MOV     R7,#01H
051C 8002              SJMP    ?C0100
051E         ?C0099:
051E 7F00              MOV     R7,#00H
0520         ?C0100:
0520 EF                MOV     A,R7
0521 6013              JZ      ?C0096
0523 900000      E     MOV     DPTR,#RTC_statusDateTime
0526 E0                MOVX    A,@DPTR
0527 FF                MOV     R7,A
0528 EF                MOV     A,R7
0529 4408              ORL     A,#08H
052B FF                MOV     R7,A
052C 900000      E     MOV     DPTR,#RTC_statusDateTime
052F EF                MOV     A,R7
0530 F0                MOVX    @DPTR,A
0531 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0534 E4                CLR     A
0535 F0                MOVX    @DPTR,A
0536         ?C0098:
0536         ?C0095:
0536         ?C0096:
                                           ; SOURCE LINE # 910
0536 900000      E     MOV     DPTR,#RTC_intervalCfgMask
0539 E0                MOVX    A,@DPTR
053A FF                MOV     R7,A
053B EF                MOV     A,R7
053C 5404              ANL     A,#04H
053E FF                MOV     R7,A
053F 7E00              MOV     R6,#00H
0541 EF                MOV     A,R7
0542 6404              XRL     A,#04H
0544 4E                ORL     A,R6
0545 7004              JNZ     ?C0102
0547 7F01              MOV     R7,#01H
0549 8002              SJMP    ?C0103
054B         ?C0102:
054B 7F00              MOV     R7,#00H
054D         ?C0103:
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 38  

054D EF                MOV     A,R7
054E 6003              JZ      ?C0019
                                           ; SOURCE LINE # 911
                                           ; SOURCE LINE # 912
0550 120000      R     LCALL   RTC_EveryHourHandler
                                           ; SOURCE LINE # 913
0553         ?C0101:
                                           ; SOURCE LINE # 914
0553         ?C0019:
                                           ; SOURCE LINE # 917
0553 900000      E     MOV     DPTR,#RTC_alarmCfgMask
0556 E0                MOVX    A,@DPTR
0557 FF                MOV     R7,A
0558 EF                MOV     A,R7
0559 5402              ANL     A,#02H
055B FF                MOV     R7,A
055C 7E00              MOV     R6,#00H
055E EF                MOV     A,R7
055F 6402              XRL     A,#02H
0561 4E                ORL     A,R6
0562 7004              JNZ     ?C0105
0564 7F01              MOV     R7,#01H
0566 8002              SJMP    ?C0106
0568         ?C0105:
0568 7F00              MOV     R7,#00H
056A         ?C0106:
056A EF                MOV     A,R7
056B 602C              JZ      ?C0104
                                           ; SOURCE LINE # 918
                                           ; SOURCE LINE # 919
056D 900000      E     MOV     DPTR,#RTC_currentTimeDate+01H
0570 E0                MOVX    A,@DPTR
0571 FF                MOV     R7,A
0572 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate+01H
0575 E0                MOVX    A,@DPTR
0576 FE                MOV     R6,A
0577 EE                MOV     A,R6
0578 B50710            CJNE    A,AR7,?C0107
                                           ; SOURCE LINE # 920
                                           ; SOURCE LINE # 921
057B 900000      E     MOV     DPTR,#RTC_alarmCurStatus
057E E0                MOVX    A,@DPTR
057F FF                MOV     R7,A
0580 EF                MOV     A,R7
0581 4402              ORL     A,#02H
0583 FF                MOV     R7,A
0584 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0587 EF                MOV     A,R7
0588 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 922
0589 800E              SJMP    ?C0104
058B         ?C0107:
                                           ; SOURCE LINE # 924
                                           ; SOURCE LINE # 925
058B 900000      E     MOV     DPTR,#RTC_alarmCurStatus
058E E0                MOVX    A,@DPTR
058F FF                MOV     R7,A
0590 EF                MOV     A,R7
0591 54FD              ANL     A,#0FDH
0593 FF                MOV     R7,A
0594 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0597 EF                MOV     A,R7
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 39  

0598 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 926
0599         ?C0108:
                                           ; SOURCE LINE # 927
0599         ?C0104:
                                           ; SOURCE LINE # 930
0599 900000      E     MOV     DPTR,#RTC_alarmCfgMask
059C E0                MOVX    A,@DPTR
059D FF                MOV     R7,A
059E 900000      R     MOV     DPTR,#RTC_tmp
05A1 EF                MOV     A,R7
05A2 F0                MOVX    @DPTR,A
05A3         ?C0111:
                                           ; SOURCE LINE # 933
05A3 900000      R     MOV     DPTR,#RTC_tmp
05A6 E0                MOVX    A,@DPTR
05A7 FF                MOV     R7,A
05A8 EF                MOV     A,R7
05A9 6032              JZ      ?C0110
05AB 900000      R     MOV     DPTR,#RTC_tmp
05AE E0                MOVX    A,@DPTR
05AF FF                MOV     R7,A
05B0 900000      E     MOV     DPTR,#RTC_alarmCurStatus
05B3 E0                MOVX    A,@DPTR
05B4 FE                MOV     R6,A
05B5 EE                MOV     A,R6
05B6 5F                ANL     A,R7
05B7 FF                MOV     R7,A
05B8 900000      R     MOV     DPTR,#RTC_tmp
05BB E0                MOVX    A,@DPTR
05BC FE                MOV     R6,A
05BD EF                MOV     A,R7
05BE B50604            CJNE    A,AR6,?C0113
05C1 7F01              MOV     R7,#01H
05C3 8002              SJMP    ?C0114
05C5         ?C0113:
05C5 7F00              MOV     R7,#00H
05C7         ?C0114:
05C7 EF                MOV     A,R7
05C8 6013              JZ      ?C0110
05CA 900000      E     MOV     DPTR,#RTC_statusDateTime
05CD E0                MOVX    A,@DPTR
05CE FF                MOV     R7,A
05CF EF                MOV     A,R7
05D0 4408              ORL     A,#08H
05D2 FF                MOV     R7,A
05D3 900000      E     MOV     DPTR,#RTC_statusDateTime
05D6 EF                MOV     A,R7
05D7 F0                MOVX    @DPTR,A
05D8 900000      E     MOV     DPTR,#RTC_alarmCurStatus
05DB E4                CLR     A
05DC F0                MOVX    @DPTR,A
05DD         ?C0112:
05DD         ?C0109:
05DD         ?C0110:
                                           ; SOURCE LINE # 936
05DD 900000      E     MOV     DPTR,#RTC_intervalCfgMask
05E0 E0                MOVX    A,@DPTR
05E1 FF                MOV     R7,A
05E2 EF                MOV     A,R7
05E3 5402              ANL     A,#02H
05E5 FF                MOV     R7,A
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 40  

05E6 7E00              MOV     R6,#00H
05E8 EF                MOV     A,R7
05E9 6402              XRL     A,#02H
05EB 4E                ORL     A,R6
05EC 7004              JNZ     ?C0116
05EE 7F01              MOV     R7,#01H
05F0 8002              SJMP    ?C0117
05F2         ?C0116:
05F2 7F00              MOV     R7,#00H
05F4         ?C0117:
05F4 EF                MOV     A,R7
05F5 6003              JZ      ?C0018
                                           ; SOURCE LINE # 937
                                           ; SOURCE LINE # 938
05F7 120000      R     LCALL   RTC_EveryMinuteHandler
                                           ; SOURCE LINE # 939
05FA         ?C0115:
                                           ; SOURCE LINE # 940
05FA         ?C0018:
                                           ; SOURCE LINE # 943
05FA 900000      E     MOV     DPTR,#RTC_alarmCfgMask
05FD E0                MOVX    A,@DPTR
05FE FF                MOV     R7,A
05FF EF                MOV     A,R7
0600 5401              ANL     A,#01H
0602 FF                MOV     R7,A
0603 7E00              MOV     R6,#00H
0605 EF                MOV     A,R7
0606 6401              XRL     A,#01H
0608 4E                ORL     A,R6
0609 7004              JNZ     ?C0119
060B 7F01              MOV     R7,#01H
060D 8002              SJMP    ?C0120
060F         ?C0119:
060F 7F00              MOV     R7,#00H
0611         ?C0120:
0611 EF                MOV     A,R7
0612 602C              JZ      ?C0118
                                           ; SOURCE LINE # 944
                                           ; SOURCE LINE # 945
0614 900000      E     MOV     DPTR,#RTC_currentTimeDate
0617 E0                MOVX    A,@DPTR
0618 FF                MOV     R7,A
0619 900000      E     MOV     DPTR,#RTC_alarmCfgTimeDate
061C E0                MOVX    A,@DPTR
061D FE                MOV     R6,A
061E EE                MOV     A,R6
061F B50710            CJNE    A,AR7,?C0121
                                           ; SOURCE LINE # 946
                                           ; SOURCE LINE # 947
0622 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0625 E0                MOVX    A,@DPTR
0626 FF                MOV     R7,A
0627 EF                MOV     A,R7
0628 4401              ORL     A,#01H
062A FF                MOV     R7,A
062B 900000      E     MOV     DPTR,#RTC_alarmCurStatus
062E EF                MOV     A,R7
062F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 948
0630 800E              SJMP    ?C0118
0632         ?C0121:
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 41  

                                           ; SOURCE LINE # 950
                                           ; SOURCE LINE # 951
0632 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0635 E0                MOVX    A,@DPTR
0636 FF                MOV     R7,A
0637 EF                MOV     A,R7
0638 54FE              ANL     A,#0FEH
063A FF                MOV     R7,A
063B 900000      E     MOV     DPTR,#RTC_alarmCurStatus
063E EF                MOV     A,R7
063F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 952
0640         ?C0122:
                                           ; SOURCE LINE # 953
0640         ?C0118:
                                           ; SOURCE LINE # 956
0640 900000      E     MOV     DPTR,#RTC_alarmCfgMask
0643 E0                MOVX    A,@DPTR
0644 FF                MOV     R7,A
0645 900000      R     MOV     DPTR,#RTC_tmp
0648 EF                MOV     A,R7
0649 F0                MOVX    @DPTR,A
064A         ?C0125:
                                           ; SOURCE LINE # 957
064A 900000      R     MOV     DPTR,#RTC_tmp
064D E0                MOVX    A,@DPTR
064E FF                MOV     R7,A
064F EF                MOV     A,R7
0650 6032              JZ      ?C0124
0652 900000      R     MOV     DPTR,#RTC_tmp
0655 E0                MOVX    A,@DPTR
0656 FF                MOV     R7,A
0657 900000      E     MOV     DPTR,#RTC_alarmCurStatus
065A E0                MOVX    A,@DPTR
065B FE                MOV     R6,A
065C EE                MOV     A,R6
065D 5F                ANL     A,R7
065E FF                MOV     R7,A
065F 900000      R     MOV     DPTR,#RTC_tmp
0662 E0                MOVX    A,@DPTR
0663 FE                MOV     R6,A
0664 EF                MOV     A,R7
0665 B50604            CJNE    A,AR6,?C0127
0668 7F01              MOV     R7,#01H
066A 8002              SJMP    ?C0128
066C         ?C0127:
066C 7F00              MOV     R7,#00H
066E         ?C0128:
066E EF                MOV     A,R7
066F 6013              JZ      ?C0124
0671 900000      E     MOV     DPTR,#RTC_statusDateTime
0674 E0                MOVX    A,@DPTR
0675 FF                MOV     R7,A
0676 EF                MOV     A,R7
0677 4408              ORL     A,#08H
0679 FF                MOV     R7,A
067A 900000      E     MOV     DPTR,#RTC_statusDateTime
067D EF                MOV     A,R7
067E F0                MOVX    @DPTR,A
067F 900000      E     MOV     DPTR,#RTC_alarmCurStatus
0682 E4                CLR     A
0683 F0                MOVX    @DPTR,A
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 42  

0684         ?C0126:
0684         ?C0123:
0684         ?C0124:
                                           ; SOURCE LINE # 960
0684 900000      E     MOV     DPTR,#RTC_intervalCfgMask
0687 E0                MOVX    A,@DPTR
0688 FF                MOV     R7,A
0689 EF                MOV     A,R7
068A 5401              ANL     A,#01H
068C FF                MOV     R7,A
068D 7E00              MOV     R6,#00H
068F EF                MOV     A,R7
0690 6401              XRL     A,#01H
0692 4E                ORL     A,R6
0693 7004              JNZ     ?C0130
0695 7F01              MOV     R7,#01H
0697 8002              SJMP    ?C0131
0699         ?C0130:
0699 7F00              MOV     R7,#00H
069B         ?C0131:
069B EF                MOV     A,R7
069C 6003              JZ      ?C0132
                                           ; SOURCE LINE # 961
                                           ; SOURCE LINE # 962
069E 120000      R     LCALL   RTC_EverySecondHandler
                                           ; SOURCE LINE # 963
06A1         ?C0129:
                                           ; SOURCE LINE # 965
06A1         ?C0132:
06A1 D007              POP     AR7
06A3 D006              POP     AR6
06A5 D005              POP     AR5
06A7 D004              POP     AR4
06A9 D003              POP     AR3
06AB D002              POP     AR2
06AD D001              POP     AR1
06AF D000              POP     AR0
06B1 D0D0              POP     PSW
06B3 D000        E     POP     ?C?XPAGE1SFR
06B5 D086              POP     DPS
06B7 D084              POP     DPL1
06B9 D085              POP     DPH1
06BB D082              POP     DPL
06BD D083              POP     DPH
06BF D0F0              POP     B
06C1 D0E0              POP     ACC
06C3 32                RETI    
             ; FUNCTION RTC_ISR (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1982    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      1    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
C51 COMPILER V9.51   RTC_INT                                                               05/18/2014 17:33:04 PAGE 43  

   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
